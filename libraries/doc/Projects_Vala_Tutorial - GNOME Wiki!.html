<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="index,nofollow">

<title>Projects/Vala/Tutorial - GNOME Wiki!</title>
<script type="text/javascript" src="Projects_Vala_Tutorial%20-%20GNOME%20Wiki%21_files/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="Projects_Vala_Tutorial%20-%20GNOME%20Wiki%21_files/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="Projects_Vala_Tutorial%20-%20GNOME%20Wiki%21_files/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="Projects_Vala_Tutorial%20-%20GNOME%20Wiki%21_files/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="Projects_Vala_Tutorial%20-%20GNOME%20Wiki%21_files/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/gnome/gnome/css/msie.css">
<![endif]-->


<link rel="alternate" title="GNOME Wiki!: Projects/Vala/Tutorial" href="https://wiki.gnome.org/action/rss_rc/Projects/Vala/Tutorial?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Projects%2FVala%2FTutorial&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="https://wiki.gnome.org/Home">
<link rel="Alternate" title="Wiki Markup" href="https://wiki.gnome.org/Projects/Vala/Tutorial?action=raw">
<link rel="Alternate" media="print" title="Print View" href="https://wiki.gnome.org/Projects/Vala/Tutorial?action=print">
<link rel="Up" href="https://wiki.gnome.org/Projects/Vala">
<link rel="Search" href="https://wiki.gnome.org/FindPage">
<link rel="Index" href="https://wiki.gnome.org/TitleIndex">
<link rel="Glossary" href="https://wiki.gnome.org/WordIndex">
<link rel="Help" href="https://wiki.gnome.org/HelpOnFormatting">
<!-- base href="https://wiki.gnome.org/Projects/Vala/Tutorial" --></head>

<body dir="ltr" lang="en">

  <div id="container">
  <div id="header">
    <!-- global gnome.org domain bar -->
    <div id="global_domain_bar">
      <div id="header_tabs">
        <div id="user_tab" class="tab">
<ul id="username"><li><span id="pagelocation"><span class="pagepath"><a href="https://wiki.gnome.org/Projects">Projects</a><span class="sep">/</span><a href="https://wiki.gnome.org/Projects/Vala">Vala</a></span><span class="sep">/</span><a href="https://wiki.gnome.org/Projects/Vala/Tutorial">Tutorial</a></span></li><li class="wikilink"><a href="https://wiki.gnome.org/Home"><span>Home</span></a></li><li class="wikilink"><a href="https://wiki.gnome.org/RecentChanges"><span>RecentChanges</span></a></li><li class="wikilink"><a href="https://wiki.gnome.org/Schedule"><span>Schedule</span></a></li><li><a href="https://wiki.gnome.org/action/login/Projects/Vala/Tutorial?action=login" id="login" rel="nofollow">Login</a></li></ul>

        </div>
        <div id="site_tab" class="tab">
          <a class="root" href="https://www.gnome.org/">GNOME.org</a>
        </div>
      </div>
    </div>
  </div>
<!-- end site header -->
  <div id="main_content">


<div class="body" dir="ltr" lang="en">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867">
</p><h1 id="Vala_Tutorial">Vala Tutorial</h1>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867"></p><div class="table-of-contents"><p class="table-of-contents-heading">Contents</p><ol><li>
<a href="#Vala_Tutorial">Vala Tutorial</a><ol><li>
<a href="#Introduction">Introduction</a><ol><li>
<a href="#What_is_Vala.3F">What is Vala?</a></li><li>
<a href="#Who_is_this_tutorial_for.3F">Who is this tutorial for?</a></li><li>
<a href="#Conventions">Conventions</a></li></ol></li><li>
<a href="#A_First_Program">A First Program</a><ol><li>
<a href="#Compile_and_Run">Compile and Run</a></li></ol></li><li>
<a href="#Basics">Basics</a><ol><li>
<a href="#Source_Files_and_Compilation">Source Files and Compilation</a></li><li>
<a href="#Syntax_Overview">Syntax Overview</a></li><li>
<a href="#Comments">Comments</a></li><li>
<a href="#Data_Types">Data Types</a><ol><li>
<a href="#Value_Types">Value Types</a></li><li>
<a href="#Strings">Strings</a></li><li>
<a href="#Arrays">Arrays</a></li><li>
<a href="#Reference_Types">Reference Types</a></li><li>
<a href="#Static_Type_Casting">Static Type Casting</a></li><li>
<a href="#Type_Inference">Type Inference</a></li><li>
<a href="#Defining_new_Type_from_other">Defining new Type from other</a></li></ol></li><li>
<a href="#Operators">Operators</a></li><li>
<a href="#Control_Structures">Control Structures</a></li><li>
<a href="#Language_Elements">Language Elements</a><ol><li>
<a href="#Methods">Methods</a></li><li>
<a href="#Delegates">Delegates</a></li><li>
<a href="#Anonymous_Methods_.2BAC8_Closures">Anonymous Methods / Closures</a></li><li>
<a href="#Namespaces">Namespaces</a></li><li>
<a href="#Structs">Structs</a></li><li>
<a href="#Classes">Classes</a></li><li>
<a href="#Interfaces">Interfaces</a></li></ol></li><li>
<a href="#Code_Attributes">Code Attributes</a></li></ol></li><li>
<a href="#Object_Oriented_Programming">Object Oriented Programming</a><ol><li>
<a href="#Basics-1">Basics</a></li><li>
<a href="#Construction">Construction</a></li><li>
<a href="#Destruction">Destruction</a></li><li>
<a href="#Signals">Signals</a></li><li>
<a href="#Properties">Properties</a></li><li>
<a href="#Inheritance">Inheritance</a></li><li>
<a href="#Abstract_Classes">Abstract Classes</a><ol><li>
<a href="#Virtual_Methods">Virtual Methods</a></li></ol></li><li>
<a href="#Interfaces-1">Interfaces</a><ol><li>
<a href="#Defining_Prerequisites">Defining Prerequisites</a></li><li>
<a href="#Defining_default_implementation_in_methods">Defining default implementation in methods</a></li><li>
<a href="#Properties-1">Properties</a></li><li>
<a href="#Mixins_and_Multiple_Inheritance">Mixins and Multiple Inheritance</a></li></ol></li><li>
<a href="#Polymorphism">Polymorphism</a></li><li>
<a href="#Method_Hiding">Method Hiding</a></li><li>
<a href="#Run-Time_Type_Information">Run-Time Type Information</a></li><li>
<a href="#Dynamic_Type_Casting">Dynamic Type Casting</a></li><li>
<a href="#Generics">Generics</a></li><li>
<a href="#GObject-Style_Construction">GObject-Style Construction</a></li></ol></li><li>
<a href="#Advanced_Features">Advanced Features</a><ol><li>
<a href="#Assertions_and_Contract_Programming">Assertions and Contract Programming</a></li><li>
<a href="#Error_Handling">Error Handling</a></li><li>
<a href="#Parameter_Directions">Parameter Directions</a></li><li>
<a href="#Collections">Collections</a><ol><li>
<a href="#ArrayList.3CG.3E">ArrayList&lt;G&gt;</a></li><li>
<a href="#HashMap.3CK.2CV.3E">HashMap&lt;K,V&gt;</a></li><li>
<a href="#HashSet.3CG.3E">HashSet&lt;G&gt;</a></li><li>
<a href="#Read-Only_Views">Read-Only Views</a></li></ol></li><li>
<a href="#Methods_With_Syntax_Support">Methods With Syntax Support</a></li><li>
<a href="#Multi-Threading">Multi-Threading</a><ol><li>
<a href="#Threads_in_Vala">Threads in Vala</a></li><li>
<a href="#Resource_Control">Resource Control</a></li></ol></li><li>
<a href="#The_Main_Loop">The Main Loop</a></li><li>
<a href="#Asynchronous_Methods">Asynchronous Methods</a><ol><li>
<a href="#Examples">Examples</a></li></ol></li><li>
<a href="#Weak_References">Weak References</a></li><li>
<a href="#Ownership">Ownership</a><ol><li>
<a href="#Unowned_References">Unowned References</a></li><li>
<a href="#Ownership_Transfer">Ownership Transfer</a></li></ol></li><li>
<a href="#Variable-Length_Argument_Lists">Variable-Length Argument Lists</a></li><li>
<a href="#Pointers">Pointers</a></li><li>
<a href="#Non-Object_classes">Non-Object classes</a></li><li>
<a href="#D-Bus_Integration">D-Bus Integration</a></li><li>
<a href="#Profiles">Profiles</a></li></ol></li><li>
<a href="#Experimental_Features">Experimental Features</a><ol><li>
<a href="#Chained_Relational_Expressions">Chained Relational Expressions</a></li><li>
<a href="#Regular_Expression_Literals">Regular Expression Literals</a></li><li>
<a href="#Strict_Non-Null_Mode">Strict Non-Null Mode</a></li></ol></li><li>
<a href="#Libraries">Libraries</a><ol><li>
<a href="#Using_Libraries">Using Libraries</a></li><li>
<a href="#Creating_a_Library">Creating a Library</a><ol><li>
<a href="#Using_Autotools">Using Autotools</a></li><li>
<a href="#Compilation_and_linking_using_Command_Line">Compilation and linking using Command Line</a></li></ol></li><li>
<a href="#Binding_Libraries_with_VAPI_Files">Binding Libraries with VAPI Files</a></li></ol></li><li>
<a href="#Tools">Tools</a><ol><li>
<a href="#valac">valac</a></li><li>
<a href="#vapigen">vapigen</a></li><li>
<a href="#vala-gen-introspect">vala-gen-introspect</a></li></ol></li><li>
<a href="#Techniques">Techniques</a><ol><li>
<a href="#Debugging">Debugging</a></li><li>
<a href="#Using_GLib">Using GLib</a><ol><li>
<a href="#File_Handling">File Handling</a></li></ol></li></ol></li></ol></li></ol></div> <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line867">
</p><h2 id="Introduction">Introduction</h2>
<span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line874">Disclaimer:
 Vala is an ongoing project, and its features may change.  I will try to
 keep this tutorial as up to date as I can, but I'm not perfect.  Also, I
 can't promise that the techniques which I suggest are necessarily the 
best in practice, but again I will try to keep up with that sort of 
thing. <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span></p><p class="line867">
</p><h3 id="What_is_Vala.3F">What is Vala?</h3>
<span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><p class="line874">Vala
 is a new programming language that allows modern programming techniques
 to be used to write applications that run on the GNOME runtime 
libraries, particularly GLib and GObject.  This platform has long 
provided a very complete programming environment, with such features as a
 dynamic type system and assisted memory management.  Before Vala, the 
only ways to program for the platform were with the machine native C 
API, which exposes a lot of often unwanted detail, with a high level 
language that has an attendant virtual machine, such as Python or the 
Mono C# language, or alternatively, with C++ through a wrapper library. <span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span></p><p class="line874">Vala
 is different from all these other techniques, as it outputs C code 
which can be compiled to run with no extra library support beyond the 
GNOME platform.  This has several consequences, but most importantly: <span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span></p><ul><li>Programs
 written in Vala should have broadly similar performance to those 
written directly in C, whilst being easier and faster to write and 
maintain. <span class="anchor" id="line-20"></span></li><li>A Vala 
application can do nothing that a C equivalent cannot.  Whilst Vala 
introduces a lot of language features that are not available in C, these
 are all mapped to C constructs, although they are often ones that are 
difficult or too time consuming to write directly. <span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span></li></ul><p class="line874">As
 such, whilst Vala is a modern language with all of the features you 
would expect, it gains its power from an existing platform, and must in 
some ways comply with the rules set down by it. <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span></p><p class="line867">
</p><h3 id="Who_is_this_tutorial_for.3F">Who is this tutorial for?</h3>
<span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><p class="line874">This
 tutorial will not go into depth about basic programming practices.  It 
will only briefly explain the principles of object-oriented programming,
 instead focusing on how Vala applies the concepts.  As such it will be 
helpful if you have experience of a variety of programming languages 
already, although in-depth knowledge of any particular one is not 
required. <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span></p><p class="line874">Vala
 shares a lot of syntax with C#, but I will try to avoid describing 
features in terms of their similarity or differences with either C# or 
Java, with the aim of making the tutorial more accessible. <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span></p><p class="line874">What
 will be useful is a reasonable understanding of C.  Whilst this isn't 
needed for understanding Vala per se, it is important to realise that 
Vala programs are executed as C, and will often interact with C 
libraries.  Knowledge of C will certainly make a deeper understanding of
 Vala far easier to come by. <span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span></p><p class="line867">
</p><h3 id="Conventions">Conventions</h3>
<span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><p class="line862">Code will be in <tt class="backtick">monospaced&nbsp;text</tt>,
 commands will all be prefaced with a $ prompt.  Other than that, 
everything should be obvious.  I tend to code very explicitly, including
 some information that is actually implied.  I will try to explain where
 some things can be omitted, but that doesn't mean that I encourage you 
do to this. <span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span></p><p class="line874">At some point I will add in references to the Vala documentation, but that isn't really possible yet. <span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span></p><p class="line867">
</p><h2 id="A_First_Program">A First Program</h2>
<span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><p class="line874">Sadly predictable, but still: <span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span></p><p class="line867"><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-1-1"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c7509e1faeab0292244b89e9b89416f7500229d2" lang="en"><span class="line"><span class="anchor" id="line-1-2"></span><span class="ResWord">class</span> <span class="ID">Demo</span>.<span class="ID">HelloWorld</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-1"></span></span>
<span class="line"><span class="anchor" id="line-3-1"></span>    <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">int</span> <span class="ID">main</span>(<span class="ID">string</span>[] <span class="ID">args</span>) {</span>
<span class="line"><span class="anchor" id="line-4-1"></span></span>
<span class="line"><span class="anchor" id="line-5-1"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hello, World</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-6-1"></span></span>
<span class="line"><span class="anchor" id="line-7-1"></span>        <span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-8-1"></span>    }</span>
<span class="line"><span class="anchor" id="line-9-1"></span>}</span>
</pre></div></div><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><p class="line862">Of course, that is a Vala <em>Hello World</em> program.  I expect you can recognise some parts of it well enough, but just to be thorough I shall go through it step by step. <span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span></p><p class="line867"><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-1-3"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-0b518d970b99c2d64557a0b9b1883789e44fb6c8" lang="en"><span class="line"><span class="anchor" id="line-1-4"></span><span class="ResWord">class</span> <span class="ID">Demo</span>.<span class="ID">HelloWorld</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
</pre></div></div><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><p class="line862">This
 line identifies the beginning of a class definition.  Classes in Vala 
are very similar in concept to other languages.  A class is basically a 
type of object, of which instances can be created, all having the same 
properties.  The implementation of classed types is taken care of by the
 <em>gobject</em> library, but details of this are not important for general usage. <span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span></p><p class="line862">What is important to note is that this class is specifically described as being a subclass of <em>GLib.Object</em>.
  This is because Vala allows other types of class, but in most cases, 
this is the sort that you want.  In fact, some language features of Vala
 are only allowed if your class is descended from GLib's <em>Object</em>. <span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span></p><p class="line874">Other parts of this line show namespacing and fully qualified names, although these will be explained later. <span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span></p><p class="line867"><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-1-5"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-aee5c77a499f3ec39bc630ff1a23f1a5c171b2ed" lang="en"><span class="line"><span class="anchor" id="line-1-6"></span><span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">int</span> <span class="ID">main</span>(<span class="ID">string</span>[] <span class="ID">args</span>) {</span>
</pre></div></div><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line862">This
 is the start of a method definition.  A method is a function related to
 a type of object that can be executed on an object of that type.  The 
static method means that the method can be called without possessing a 
particular instance of the type.  The fact that this method is called <em>main</em> and has the signature it does means that Vala will recognise it as the entry point for the program. <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span></p><p class="line862">The <em>main</em> method doesn't have to be defined inside a class.  However, if it is defined inside a class it must be <tt class="backtick">static</tt>.  It doesn't matter if it's <tt class="backtick">public</tt> or <tt class="backtick">private</tt>.  The return type may be either <tt class="backtick">int</tt> or <tt class="backtick">void</tt>.  With a <tt class="backtick">void</tt>
 return type the program will implicitly terminate with exit code 0.  
The string array parameter holding the command line arguments is 
optional. <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span></p><p class="line867"><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-1-7"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ec4ea68dcf8aa686172ad9673da97f878c850d5f" lang="en"><span class="line"><span class="anchor" id="line-1-8"></span><span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hello, World</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
</pre></div></div><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><p class="line867"><em>stdout</em> is an object in the <em>GLib</em> namespace that Vala ensures you have access to whenever required.  This line instructs Vala to execute the method called <em>printf</em> of the <em>stdout</em>
 object, with the hello string as an argument.  In Vala, this is always 
the syntax you use to call a method on an object, or to access an 
object's data. <tt class="backtick">\n</tt> is the escape sequence for a new line. <span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span></p><p class="line867"><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-1-9"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-7a7b9fc07b6b22b5586802fd32f4360a557b72f0" lang="en"><span class="line"><span class="anchor" id="line-1-10"></span><span class="ResWord">return</span> <span class="Number">0</span>;</span>
</pre></div></div><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><p class="line867"><tt class="backtick">return</tt> is to return a value to the caller and terminate the execution of the <em>main</em> method which also terminates the execution of the program. The returned value of the <em>main</em> method is then taken as the exit code of the program. <span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span></p><p class="line874">The last lines simply end the definitions of the method and class. <span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span></p><p class="line867">
</p><h3 id="Compile_and_Run">Compile and Run</h3>
<span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><p class="line874">Assuming you have Vala installed, then all it takes to compile and execute this program is: <span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span></p><p class="line867"><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span></p><pre><span class="anchor" id="line-1"></span>$ valac hello.vala
<span class="anchor" id="line-2"></span>$ ./hello</pre><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><p class="line867"><em>valac</em>
 is the Vala compiler, which will compile your Vala code into a binary. 
 The resulting binary will have the same name as the source file and can
 then be directly executed on the machine.  You can probably guess the 
output. <span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span></p><p class="line867">
</p><h2 id="Basics">Basics</h2>
<span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><p class="line867">
</p><h3 id="Source_Files_and_Compilation">Source Files and Compilation</h3>
<span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><p class="line862">Vala code is written in files with <em>.vala</em>
 extensions.  Vala does not enforce as much structure as a language like
 Java - there are no concepts of packages or class files in the same 
way.  Instead structure is defined by text inside each file, describing 
the logical location of the code with constructs such as namespaces.  
When you want to compile Vala code, you give the compiler a list of the 
files required, and Vala will work out how they fit together. <span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span></p><p class="line874">The
 upshot of all this is that you can put as many classes or functions 
into a file as you want, even combining parts of different namespaces in
 together.  This is not necessarily a good idea.  There are certain 
conventions you probably want to follow.  A good example of how to 
structure a project in Vala is the Vala project itself. <span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span></p><p class="line862">All source files for the same package are supplied as command line parameters to the Vala compiler <tt class="backtick">valac</tt>, along with compiler flags.  This works similarly to how Java source code is compiled.  For example: <span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span></p><p class="line867"><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span></p><pre><span class="anchor" id="line-1-1"></span>$ valac compiler.vala --pkg libvala</pre><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><p class="line862">will produce a binary with the name <em>compiler</em> that links with the package <em>libvala</em>. In fact, this is how the <em>valac</em> compiler is produced! <span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span></p><p class="line862">If
 you want the binary to have a different name or if you have passed 
multiple source files to the compiler you can specify the binary name 
explicitly with the <tt class="backtick">-o</tt> switch: <span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span></p><p class="line867"><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span></p><pre><span class="anchor" id="line-1-2"></span>$ valac source1.vala source2.vala -o myprogram
<span class="anchor" id="line-2-1"></span>$ ./myprogram</pre><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><p class="line862">If you give <em>valac</em> the <tt class="backtick">-C</tt>
 switch, it won't compile your program into a binary file.  Instead it 
will output the intermediate C code for each of your Vala source files 
into a corresponding C source file, in this case <em>source1.c</em> and <em>source2.c</em>.
  If you look at the content of these files you can see that programming
 a class in Vala is equivalent to the same task in C, but a whole lot 
more succinct.  You will also notice that this class is registered 
dynamically in the running system.  This is a good example of the power 
of the GNOME platform, but as I've said before, you do not need to know 
much about this to use Vala. <span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span></p><p class="line862">If you want to have a C header file for your project you can use the <tt class="backtick">-H</tt> switch: <span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span></p><p class="line867"><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span></p><pre><span class="anchor" id="line-1-3"></span>$ valac hello.vala -C -H hello.h</pre><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><p class="line867">
</p><h3 id="Syntax_Overview">Syntax Overview</h3>
<span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><p class="line874">Vala's
 syntax is an amalgam heavily based on C#'s.  As a result, most of this 
will be familiar to programmers who know any C-like language, and in 
light of this I have kept things brief. <span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span></p><p class="line862">Scope is defined using braces.  An object or reference is only valid between <tt class="backtick">{</tt> and <tt class="backtick">}</tt>.
  These are also the delimiters used to define classes, methods, code 
blocks etc, so they automatically have their own scope.  Vala is not 
strict about where variables are declared. <span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span></p><p class="line862">An identifier is defined by its type and a name, e.g. <tt class="backtick">int&nbsp;c</tt> meaning an integer called <em>c</em>.
  In the case of value types this also creates an object of the given 
type.  For reference types these just define a new reference that 
doesn't initially point to anything. <span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span></p><p class="line862">Identifier
 names may be any combination of letters ([a-z], [A-Z]), underscores and
 digits. However, to define or refer to an identifier with a name that 
either starts with a digit or is a keyword, you must prefix it with the 
'@' character.  This character is not considered a part of the name.  
For example, you can name a method <em>foreach</em> by writing <tt class="backtick">@foreach</tt>,
 even though this is a reserved Vala keyword.   You can omit the '@' 
character when it can be unambiguously interpreted as an identifier 
name, such as in "foo.foreach()". <span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span></p><p class="line862">Reference types are instantiated using the <tt class="backtick">new</tt> operator and the name of a construction method, which is usually just the name of the type, e.g. <tt class="backtick">Object&nbsp;o&nbsp;=&nbsp;new&nbsp;Object()</tt> creates a new Object and makes <em>o</em> a reference to it. <span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span></p><p class="line867">
</p><h3 id="Comments">Comments</h3>
<span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><p class="line874">Vala allows comments in code in different ways. <span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span></p><p class="line867"><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><span class="anchor" id="line-1-11"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-f4fe8db73e1267216aedc60e5e24e7cf1bd4b6e0" lang="en"><span class="line"><span class="anchor" id="line-1-12"></span><span class="Comment">// Comment continues until end of line</span></span>
<span class="line"><span class="anchor" id="line-2-2"></span><span class="Comment"></span></span>
<span class="line"><span class="anchor" id="line-3-2"></span><span class="Comment">/* Comment lasts between delimiters */</span></span>
<span class="line"><span class="anchor" id="line-4-2"></span></span>
<span class="line"><span class="anchor" id="line-5-2"></span><span class="Comment">/**</span></span>
<span class="line"><span class="anchor" id="line-6-2"></span><span class="Comment"> * Documentation comment</span></span>
<span class="line"><span class="anchor" id="line-7-2"></span><span class="Comment"> */</span></span>
</pre></div></div><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><p class="line862">These
 are handled in the same way as in most other languages and so need 
little explanation.  Documentation comments are actually not special to 
Vala, but a documentation generation tool like <a href="https://wiki.gnome.org/Projects/Valadoc">Valadoc</a> will recognise them. <span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span></p><p class="line867">
</p><h3 id="Data_Types">Data Types</h3>
<span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><p class="line862">Broadly speaking there are two types of data in Vala: <em>reference types</em> and <em>value types</em>.
  These names describe how instances of the types are passed around the 
system - a value type is copied whenever it is assigned to a new 
identifier, a reference type is not copied, instead the new identifier 
is simply a new reference to the same object. <span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span></p><p class="line862">A constant is defined by putting <tt class="backtick">const</tt> before the type.  The naming convention for constants is <tt class="backtick">ALL_UPPER_CASE</tt>. <span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span></p><p class="line867">
</p><h4 id="Value_Types">Value Types</h4>
<span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><p class="line874">Vala supports a set of the simple types as most other languages do. <span class="anchor" id="line-167"></span><span class="anchor" id="line-168"></span></p><ul><li><p class="line862">Byte, <tt class="backtick">char</tt>, <tt class="backtick">uchar</tt>; their names are <em>char</em> for historical reasons. <span class="anchor" id="line-169"></span></p></li><li><p class="line862">Character, <tt class="backtick">unichar</tt>; a 32-bit Unicode character <span class="anchor" id="line-170"></span></p></li><li><p class="line862">Integer, <tt class="backtick">int</tt>, <tt class="backtick">uint</tt> <span class="anchor" id="line-171"></span></p></li><li><p class="line862">Long Integer, <tt class="backtick">long</tt>, <tt class="backtick">ulong</tt> <span class="anchor" id="line-172"></span></p></li><li><p class="line862">Short Integer, <tt class="backtick">short</tt>, <tt class="backtick">ushort</tt> <span class="anchor" id="line-173"></span></p></li><li><p class="line862">Guaranteed-size Integer, <tt class="backtick">int8</tt>, <tt class="backtick">int16</tt>, <tt class="backtick">int32</tt>, <tt class="backtick">int64</tt> as well as their unsigned siblings <tt class="backtick">uint8</tt>, <tt class="backtick">uint16</tt>, <tt class="backtick">uint32</tt>, <tt class="backtick">uint64</tt>. The numbers indicate the lengths in bits. <span class="anchor" id="line-174"></span></p></li><li><p class="line862">Float number, <tt class="backtick">float</tt>, <tt class="backtick">double</tt> <span class="anchor" id="line-175"></span></p></li><li><p class="line862">Boolean, <tt class="backtick">bool</tt>; possible values are <tt class="backtick">true</tt> and <tt class="backtick">false</tt> <span class="anchor" id="line-176"></span></p></li><li><p class="line862">Compound, <tt class="backtick">struct</tt> <span class="anchor" id="line-177"></span></p></li><li><p class="line862">Enumeration, <tt class="backtick">enum</tt>; represented by integer values, not as classes like Java's enums <span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span></p></li></ul><p class="line874">Here are some examples. <span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><span class="anchor" id="line-196"></span><span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span><span class="anchor" id="line-1-13"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a9cbedf5cf18e971e1aed220d790e5f129dbe7d5" lang="en"><span class="line"><span class="anchor" id="line-1-14"></span><span class="Comment">/* atomic types */</span></span>
<span class="line"><span class="anchor" id="line-2-3"></span><span class="ID">unichar</span> <span class="ID">c</span> = <span class="Char">'u'</span>;</span>
<span class="line"><span class="anchor" id="line-3-3"></span><span class="ResWord">float</span> <span class="ID">percentile</span> = <span class="Number">0.75f</span>;</span>
<span class="line"><span class="anchor" id="line-4-3"></span><span class="ResWord">const</span> <span class="ResWord">double</span> <span class="ID">MU_BOHR</span> = <span class="Number">927.400915E-26</span>;</span>
<span class="line"><span class="anchor" id="line-5-3"></span><span class="ResWord">bool</span> <span class="ID">the_box_has_crashed</span> = <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-6-3"></span></span>
<span class="line"><span class="anchor" id="line-7-3"></span><span class="Comment">/* defining a struct */</span></span>
<span class="line"><span class="anchor" id="line-8-2"></span><span class="ResWord">struct</span> <span class="ID">Vector</span> {</span>
<span class="line"><span class="anchor" id="line-9-2"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">x</span>;</span>
<span class="line"><span class="anchor" id="line-10-1"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">y</span>;</span>
<span class="line"><span class="anchor" id="line-11-1"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">z</span>;</span>
<span class="line"><span class="anchor" id="line-12-1"></span>}</span>
<span class="line"><span class="anchor" id="line-13-1"></span></span>
<span class="line"><span class="anchor" id="line-14-1"></span><span class="Comment">/* defining an enum */</span></span>
<span class="line"><span class="anchor" id="line-15-1"></span><span class="ResWord">enum</span> <span class="ID">WindowType</span> {</span>
<span class="line"><span class="anchor" id="line-16-1"></span>    <span class="ID">TOPLEVEL</span>,</span>
<span class="line"><span class="anchor" id="line-17-1"></span>    <span class="ID">POPUP</span></span>
<span class="line"><span class="anchor" id="line-18-1"></span>}</span>
</pre></div></div><span class="anchor" id="line-200"></span><span class="anchor" id="line-201"></span><p class="line862">Most of these types may have different sizes on different platforms, except for the guaranteed-size integer types.  The <tt class="backtick">sizeof</tt> operator returns the size that a variable of a given type occupies in bytes: <span class="anchor" id="line-202"></span><span class="anchor" id="line-203"></span></p><p class="line867"><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><span class="anchor" id="line-1-15"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c3e0237508643f8d03a5525abd062a5f51cc0d6f" lang="en"><span class="line"><span class="anchor" id="line-1-16"></span><span class="ID">ulong</span> <span class="ID">nbytes</span> = <span class="ResWord">sizeof</span>(<span class="ID">int32</span>);    <span class="Comment">// nbytes will be 4 (= 32 bits)</span></span>
<span class="line"><span class="anchor" id="line-2-4"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span><p class="line862">You can determine the minimum and maximum values of a numerical type with <em>.MIN</em> and <em>.MAX</em>, e.g. <tt class="backtick">int.MIN</tt> and <tt class="backtick">int.MAX</tt>. <span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span></p><p class="line867">
</p><h4 id="Strings">Strings</h4>
<span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><p class="line862">The data type for strings is <tt class="backtick">string</tt>. Vala strings are UTF-8 encoded and immutable. <span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span></p><p class="line867"><span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><span class="anchor" id="line-1-17"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-aa77db6c66709c51408b8c8964fd920930fef353" lang="en"><span class="line"><span class="anchor" id="line-1-18"></span><span class="ID">string</span> <span class="ID">text</span> = <span class="String">"</span><span class="String">A string literal</span><span class="String">"</span>;</span>
</pre></div></div><span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><p class="line862">Vala offers a feature called <em>verbatim strings</em>.  These are strings in which escape sequences (such as <tt class="backtick">\n</tt>)
 won't be interpreted, line breaks will be preserved and quotation marks
 don't have to be masked.  They are enclosed with triple double 
quotation marks.  Possible indentations after a line break are part of 
the string as well. <span class="anchor" id="line-218"></span><span class="anchor" id="line-219"></span></p><p class="line867"><span class="anchor" id="line-220"></span><span class="anchor" id="line-221"></span><span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span></p><pre><span class="anchor" id="line-1-4"></span>string verbatim = """This is a so-called "verbatim string".
<span class="anchor" id="line-2-2"></span>Verbatim strings don't process escape sequences, such as \n, \t, \\, etc.
<span class="anchor" id="line-3"></span>They may contain quotes and may span multiple lines.""";</pre><span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span><p class="line874">Strings prefixed with '@' are string templates. They can evaluate embedded variables and expressions prefixed with '$': <span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span></p><p class="line867"><span class="anchor" id="line-228"></span><span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span><span class="anchor" id="line-1-19"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-546c9d22f3c3f188f446ddd4c48d45736b7c30ad" lang="en"><span class="line"><span class="anchor" id="line-1-20"></span><span class="ResWord">int</span> <span class="ID">a</span> = <span class="Number">6</span>, <span class="ID">b</span> = <span class="Number">7</span>;</span>
<span class="line"><span class="anchor" id="line-2-5"></span><span class="ID">string</span> <span class="ID">s</span> = @<span class="String">"</span><span class="String">$a * $b = $(a * b)</span><span class="String">"</span>;  <span class="Comment">// =&gt; "6 * 7 = 42"</span></span>
<span class="line"><span class="anchor" id="line-3-4"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><p class="line862">The equality operators <tt class="backtick">==</tt> and <tt class="backtick">!=</tt> compare the content of two strings, contrary to Java's behaviour which in this case would check for referential equality. <span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span></p><p class="line862">You can slice a string with <tt class="backtick">[start:end]</tt>.  Negative values represent positions relative to the end of the string: <span class="anchor" id="line-235"></span><span class="anchor" id="line-236"></span></p><p class="line867"><span class="anchor" id="line-237"></span><span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><span class="anchor" id="line-240"></span><span class="anchor" id="line-1-21"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-e3870c11157ef52b8fb379a3799b6c12c1df33b4" lang="en"><span class="line"><span class="anchor" id="line-1-22"></span><span class="ID">string</span> <span class="ID">greeting</span> = <span class="String">"</span><span class="String">hello, world</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-2-6"></span><span class="ID">string</span> <span class="ID">s1</span> = <span class="ID">greeting</span>[<span class="Number">7</span>:<span class="Number">12</span>];        <span class="Comment">// =&gt; "world"</span></span>
<span class="line"><span class="anchor" id="line-3-5"></span><span class="Comment"></span><span class="ID">string</span> <span class="ID">s2</span> = <span class="ID">greeting</span>[-<span class="Number">4</span>:-<span class="Number">2</span>];       <span class="Comment">// =&gt; "or"</span></span>
<span class="line"><span class="anchor" id="line-4-4"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-241"></span><span class="anchor" id="line-242"></span><p class="line862">Note
 that indices in Vala start with 0 as in most other programming 
languages.  Starting with Vala 0.11 you can access a single byte of a 
string with <tt class="backtick">[index]</tt>: <span class="anchor" id="line-243"></span><span class="anchor" id="line-244"></span></p><p class="line867"><span class="anchor" id="line-245"></span><span class="anchor" id="line-246"></span><span class="anchor" id="line-1-23"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-2a66a4c18b464c1bf14c0af1a442410dfa476924" lang="en"><span class="line"><span class="anchor" id="line-1-24"></span><span class="ID">uint8</span> <span class="ID">b</span> = <span class="ID">greeting</span>[<span class="Number">7</span>];             <span class="Comment">// =&gt; 0x77</span></span>
<span class="line"><span class="anchor" id="line-2-7"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-247"></span><span class="anchor" id="line-248"></span><p class="line874">However, you cannot assign a new byte value to this position, since Vala strings are immutable. <span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span></p><p class="line874">Many of the basic types have reasonable methods for parsing from and converting to strings, for example: <span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span></p><p class="line867"><span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span><span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span><span class="anchor" id="line-1-25"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a09ce80754b03d4d32c91fd230c0e9de7778c153" lang="en"><span class="line"><span class="anchor" id="line-1-26"></span><span class="ResWord">bool</span> <span class="ID">b</span> = <span class="ResWord">bool</span>.<span class="ID">parse</span>(<span class="String">"</span><span class="String">false</span><span class="String">"</span>);           <span class="Comment">// =&gt; false</span></span>
<span class="line"><span class="anchor" id="line-2-8"></span><span class="Comment"></span><span class="ResWord">int</span> <span class="ID">i</span> = <span class="ResWord">int</span>.<span class="ID">parse</span>(<span class="String">"</span><span class="String">-52</span><span class="String">"</span>);               <span class="Comment">// =&gt; -52</span></span>
<span class="line"><span class="anchor" id="line-3-6"></span><span class="Comment"></span><span class="ResWord">double</span> <span class="ID">d</span> = <span class="ResWord">double</span>.<span class="ID">parse</span>(<span class="String">"</span><span class="String">6.67428E-11</span><span class="String">"</span>); <span class="Comment">// =&gt; 6.67428E-11</span></span>
<span class="line"><span class="anchor" id="line-4-5"></span><span class="Comment"></span><span class="ID">string</span> <span class="ID">s1</span> = <span class="ConsWord">true</span>.<span class="ID">to_string</span>();           <span class="Comment">// =&gt; "true"</span></span>
<span class="line"><span class="anchor" id="line-5-4"></span><span class="Comment"></span><span class="ID">string</span> <span class="ID">s2</span> = <span class="Number">21.</span><span class="ID">to_string</span>();             <span class="Comment">// =&gt; "21"</span></span>
<span class="line"><span class="anchor" id="line-6-4"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span><p class="line862">Two useful methods for writing and reading strings to/from the console (and for your first explorations with Vala) are <em>stdout.printf()</em> and <em>stdin.read_line()</em>: <span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span></p><p class="line867"><span class="anchor" id="line-263"></span><span class="anchor" id="line-264"></span><span class="anchor" id="line-265"></span><span class="anchor" id="line-266"></span><span class="anchor" id="line-267"></span><span class="anchor" id="line-1-27"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-2a09df0cd839fc54449fc63bd5668f31ba27ec72" lang="en"><span class="line"><span class="anchor" id="line-1-28"></span><span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hello, world</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-2-9"></span><span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d %g %s</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="Number">42</span>, <span class="Number">3.1415</span>, <span class="String">"</span><span class="String">Vala</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-7"></span><span class="ID">string</span> <span class="ID">input</span> = <span class="ID">stdin</span>.<span class="ID">read_line</span>();</span>
<span class="line"><span class="anchor" id="line-4-6"></span><span class="ResWord">int</span> <span class="ID">number</span> = <span class="ResWord">int</span>.<span class="ID">parse</span>(<span class="ID">stdin</span>.<span class="ID">read_line</span>());</span>
</pre></div></div><span class="anchor" id="line-268"></span><span class="anchor" id="line-269"></span><p class="line862">You already know <em>stdout.printf()</em> from the <em>Hello World</em> example.  Actually, it can take an arbitrary number of arguments of different types, whereas the first argument is a <em>format string</em>, following the same rules as <a class="http" href="http://en.wikipedia.org/wiki/Printf">C format strings</a>.  If you must output an error message you can use <em>stderr.printf()</em> instead of <em>stdout.printf()</em>. <span class="anchor" id="line-270"></span><span class="anchor" id="line-271"></span></p><p class="line862">In addition the <em>in</em> operation can be used to determine whether one string contains another, e.g. <span class="anchor" id="line-272"></span><span class="anchor" id="line-273"></span></p><p class="line867"><span class="anchor" id="line-274"></span><span class="anchor" id="line-275"></span><span class="anchor" id="line-1-29"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-e90b0b37565fed1f32fcb0fae7768c6f0586d4ce" lang="en"><span class="line"><span class="anchor" id="line-1-30"></span><span class="ResWord">if</span> (<span class="String">"</span><span class="String">ere</span><span class="String">"</span> <span class="ID">in</span> <span class="String">"</span><span class="String">Able was I ere I saw Elba.</span><span class="String">"</span>) ...</span>
</pre></div></div><span class="anchor" id="line-276"></span><span class="anchor" id="line-277"></span><p class="line862">For more information, please report to <a class="http" href="http://www.valadoc.org/glib-2.0/string.html">the complete overview of the string class</a>. <span class="anchor" id="line-278"></span><span class="anchor" id="line-279"></span></p><p class="line862">A <a href="https://wiki.gnome.org/Projects/Vala/StringSample">sample program</a> demonstrating string usage is also available. <span class="anchor" id="line-280"></span>
</p><h4 id="Arrays">Arrays</h4>
<span class="anchor" id="line-281"></span><span class="anchor" id="line-282"></span><p class="line862">An array is declared by giving a type name followed by <tt class="backtick">[]</tt> and created by using the <tt class="backtick">new</tt> operator e.g. <tt class="backtick">int[]&nbsp;a&nbsp;=&nbsp;new&nbsp;int[10]</tt> to create an array of integers.  The length of such an array can be obtained by the <em>length</em> member variable e.g. <tt class="backtick">int&nbsp;count&nbsp;=&nbsp;a.length</tt>.  Note that if you write <tt class="backtick">Object[]&nbsp;a&nbsp;=&nbsp;new&nbsp;Object[10]</tt> no objects will be created, just the array to store them in. <span class="anchor" id="line-283"></span><span class="anchor" id="line-284"></span></p><p class="line867"><span class="anchor" id="line-285"></span><span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><span class="anchor" id="line-1-31"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-30df7336fd20fdddd85330b6680c8593f6dfc189" lang="en"><span class="line"><span class="anchor" id="line-1-32"></span><span class="ResWord">int</span>[] <span class="ID">a</span> = <span class="ResWord">new</span> <span class="ResWord">int</span>[<span class="Number">10</span>];</span>
<span class="line"><span class="anchor" id="line-2-10"></span><span class="ResWord">int</span>[] <span class="ID">b</span> = { <span class="Number">2</span>, <span class="Number">4</span>, <span class="Number">6</span>, <span class="Number">8</span> };</span>
</pre></div></div><span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span><p class="line862">You can slice an array with <tt class="backtick">[start:end]</tt>: <span class="anchor" id="line-290"></span><span class="anchor" id="line-291"></span></p><p class="line867"><span class="anchor" id="line-292"></span><span class="anchor" id="line-293"></span><span class="anchor" id="line-1-33"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ad07de1ee7dd4d8753fedc8574ec21fe8d91402f" lang="en"><span class="line"><span class="anchor" id="line-1-34"></span><span class="ResWord">int</span>[] <span class="ID">c</span> = <span class="ID">b</span>[<span class="Number">1</span>:<span class="Number">3</span>];     <span class="Comment">// =&gt; { 4, 6 }</span></span>
<span class="line"><span class="anchor" id="line-2-11"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-294"></span><span class="anchor" id="line-295"></span><p class="line874">Slicing
 an array will result in a reference to the requested data, not a copy. 
 However, assigning the slice to an owned variable (as is done above) 
will result in a copy.  If you would like to avoid a copy, you must 
either assign the slice to an unowned array or pass it directly to an 
argument (arguments are, by default, unowned): <span class="anchor" id="line-296"></span><span class="anchor" id="line-297"></span></p><p class="line867"><span class="anchor" id="line-298"></span><span class="anchor" id="line-299"></span><span class="anchor" id="line-1-35"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-06486f0bc1831ab00e75a870b00eb27edcc38d1f" lang="en"><span class="line"><span class="anchor" id="line-1-36"></span><span class="ID">unowned</span> <span class="ResWord">int</span>[] <span class="ID">c</span> = <span class="ID">b</span>[<span class="Number">1</span>:<span class="Number">3</span>];     <span class="Comment">// =&gt; { 4, 6 }</span></span>
<span class="line"><span class="anchor" id="line-2-12"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-300"></span><span class="anchor" id="line-301"></span><p class="line862">Multi-dimensional arrays are defined with <tt class="backtick">[,]</tt> or <tt class="backtick">[,,]</tt> etc. <span class="anchor" id="line-302"></span><span class="anchor" id="line-303"></span></p><p class="line867"><span class="anchor" id="line-304"></span><span class="anchor" id="line-305"></span><span class="anchor" id="line-306"></span><span class="anchor" id="line-307"></span><span class="anchor" id="line-308"></span><span class="anchor" id="line-309"></span><span class="anchor" id="line-1-37"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-85c0d03d6c1a2cf6e671312e7696cd8ca28af771" lang="en"><span class="line"><span class="anchor" id="line-1-38"></span><span class="ResWord">int</span>[,] <span class="ID">c</span> = <span class="ResWord">new</span> <span class="ResWord">int</span>[<span class="Number">3</span>,<span class="Number">4</span>];</span>
<span class="line"><span class="anchor" id="line-2-13"></span><span class="ResWord">int</span>[,] <span class="ID">d</span> = {{<span class="Number">2</span>, <span class="Number">4</span>, <span class="Number">6</span>, <span class="Number">8</span>},</span>
<span class="line"><span class="anchor" id="line-3-8"></span>            {<span class="Number">3</span>, <span class="Number">5</span>, <span class="Number">7</span>, <span class="Number">9</span>},</span>
<span class="line"><span class="anchor" id="line-4-7"></span>            {<span class="Number">1</span>, <span class="Number">3</span>, <span class="Number">5</span>, <span class="Number">7</span>}};</span>
<span class="line"><span class="anchor" id="line-5-5"></span><span class="ID">d</span>[<span class="Number">2</span>,<span class="Number">3</span>] = <span class="Number">42</span>;</span>
</pre></div></div><span class="anchor" id="line-310"></span><span class="anchor" id="line-311"></span><p class="line862">This sort of array is represented by a single contiguous memory block.  Jagged multi-dimensional arrays (<tt class="backtick">[][]</tt>, also known as "stacked arrays" or "arrays of arrays"), where each row may have a different length, are not yet supported. <span class="anchor" id="line-312"></span><span class="anchor" id="line-313"></span></p><p class="line862">To find the length of each dimension in a multi-dimensional array, the <em>length</em> member becomes an array, storing the length of each respective dimension.  <span class="anchor" id="line-314"></span><span class="anchor" id="line-315"></span></p><p class="line867"><span class="anchor" id="line-316"></span><span class="anchor" id="line-317"></span><span class="anchor" id="line-318"></span><span class="anchor" id="line-319"></span><span class="anchor" id="line-1-39"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-13096d17a123f86d1d383b4e10a260ac5e19535c" lang="en"><span class="line"><span class="anchor" id="line-1-40"></span><span class="ResWord">int</span>[,] <span class="ID">arr</span> = <span class="ResWord">new</span> <span class="ResWord">int</span>[<span class="Number">4</span>,<span class="Number">5</span>];</span>
<span class="line"><span class="anchor" id="line-2-14"></span><span class="ResWord">int</span> <span class="ID">r</span> = <span class="ID">arr</span>.<span class="ID">length</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="anchor" id="line-3-9"></span><span class="ResWord">int</span> <span class="ID">c</span> = <span class="ID">arr</span>.<span class="ID">length</span>[<span class="Number">1</span>];</span>
</pre></div></div><span class="anchor" id="line-320"></span><span class="anchor" id="line-321"></span><p class="line874">Please note that you can't get a mono-dimensional array from a multidimensional array, or even slice a multidimensional array: <span class="anchor" id="line-322"></span><span class="anchor" id="line-323"></span></p><p class="line867"><span class="anchor" id="line-324"></span><span class="anchor" id="line-325"></span><span class="anchor" id="line-326"></span><span class="anchor" id="line-327"></span><span class="anchor" id="line-328"></span><span class="anchor" id="line-329"></span><span class="anchor" id="line-330"></span><span class="anchor" id="line-331"></span><span class="anchor" id="line-1-41"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-7c4a71bec52a0c4250f344927ab9db191a9fa0b2" lang="en"><span class="line"><span class="anchor" id="line-1-42"></span><span class="ResWord">int</span>[,] <span class="ID">arr</span> = {{<span class="Number">1</span>,<span class="Number">2</span>},</span>
<span class="line"><span class="anchor" id="line-2-15"></span>                {<span class="Number">3</span>,<span class="Number">4</span>}};</span>
<span class="line"><span class="anchor" id="line-3-10"></span><span class="ResWord">int</span>[] <span class="ID">b</span> = <span class="ID">arr</span>[<span class="Number">0</span>];  <span class="Comment">// won't work</span></span>
<span class="line"><span class="anchor" id="line-4-8"></span><span class="Comment"></span><span class="ResWord">int</span>[] <span class="ID">c</span> = <span class="ID">arr</span>[<span class="Number">0</span>,];  <span class="Comment">// won't work</span></span>
<span class="line"><span class="anchor" id="line-5-6"></span><span class="Comment"></span><span class="ResWord">int</span>[] <span class="ID">d</span> = <span class="ID">arr</span>[:,<span class="Number">0</span>];  <span class="Comment">// won't work</span></span>
<span class="line"><span class="anchor" id="line-6-5"></span><span class="Comment"></span><span class="ResWord">int</span>[] <span class="ID">e</span> = <span class="ID">arr</span>[<span class="Number">0</span>:<span class="Number">1</span>,<span class="Number">0</span>];  <span class="Comment">// won't work</span></span>
<span class="line"><span class="anchor" id="line-7-4"></span><span class="Comment"></span><span class="ResWord">int</span>[,] <span class="ID">f</span> = <span class="ID">arr</span>[<span class="Number">0</span>:<span class="Number">1</span>,<span class="Number">0</span>:<span class="Number">1</span>];  <span class="Comment">// won't work</span></span>
<span class="line"><span class="anchor" id="line-8-3"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-332"></span><span class="anchor" id="line-333"></span><p class="line862">You can append array elements dynamically with the <tt class="backtick">+=</tt>
 operator.  However, this works only for locally defined or private 
arrays.  The array is automatically reallocated if needed.  Internally 
this reallocation happens with sizes growing in powers of 2 for run-time
 efficiency reasons.  However, <tt class="backtick">.length</tt> holds the actual number of elements, not the internal size. <span class="anchor" id="line-334"></span><span class="anchor" id="line-335"></span></p><p class="line867"><span class="anchor" id="line-336"></span><span class="anchor" id="line-337"></span><span class="anchor" id="line-338"></span><span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span><span class="anchor" id="line-1-43"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ec996efc569873e25dbd73b2d314d291662ec0ea" lang="en"><span class="line"><span class="anchor" id="line-1-44"></span><span class="ResWord">int</span>[] <span class="ID">e</span> = {};</span>
<span class="line"><span class="anchor" id="line-2-16"></span><span class="ID">e</span> += <span class="Number">12</span>;</span>
<span class="line"><span class="anchor" id="line-3-11"></span><span class="ID">e</span> += <span class="Number">5</span>;</span>
<span class="line"><span class="anchor" id="line-4-9"></span><span class="ID">e</span> += <span class="Number">37</span>;</span>
</pre></div></div><span class="anchor" id="line-341"></span><span class="anchor" id="line-342"></span><p class="line862">You can resize an array by calling <em>resize()</em> on it. It will keep the original content (as much as fits). <span class="anchor" id="line-343"></span><span class="anchor" id="line-344"></span></p><p class="line867"><span class="anchor" id="line-345"></span><span class="anchor" id="line-346"></span><span class="anchor" id="line-347"></span><span class="anchor" id="line-1-45"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-02a8bdf9b48bf4300d0f3bbefd51833f267d14b8" lang="en"><span class="line"><span class="anchor" id="line-1-46"></span><span class="ResWord">int</span>[] <span class="ID">a</span> = <span class="ResWord">new</span> <span class="ResWord">int</span>[<span class="Number">5</span>];</span>
<span class="line"><span class="anchor" id="line-2-17"></span><span class="ID">a</span>.<span class="ID">resize</span>(<span class="Number">12</span>);</span>
</pre></div></div><span class="anchor" id="line-348"></span><span class="anchor" id="line-349"></span><p class="line862">If you put the square brackets <em>after</em>
 the identifier together with an indication of size you will get a 
fixed-size array.  Fixed-size arrays are allocated on the stack (if used
 as local variables) or in-line allocated (if used as fields) and you 
can't reallocate them later. <span class="anchor" id="line-350"></span><span class="anchor" id="line-351"></span></p><p class="line867"><span class="anchor" id="line-352"></span><span class="anchor" id="line-353"></span><span class="anchor" id="line-1-47"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-96b33a31812d42208fc0198a809d91cb9c57401c" lang="en"><span class="line"><span class="anchor" id="line-1-48"></span><span class="ResWord">int</span> <span class="ID">f</span>[<span class="Number">10</span>];     <span class="Comment">// no 'new ...'</span></span>
<span class="line"><span class="anchor" id="line-2-18"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-354"></span><span class="anchor" id="line-355"></span><p class="line862">Vala
 does not do any bounds checking for array access at runtime.  If you 
need more safety you should use a more sophisticated data structure like
 an <em>ArrayList</em>.  You will learn more about that later in the section about <em>collections</em>. <span class="anchor" id="line-356"></span><span class="anchor" id="line-357"></span></p><p class="line867">
</p><h4 id="Reference_Types">Reference Types</h4>
<span class="anchor" id="line-358"></span><span class="anchor" id="line-359"></span><p class="line862">The reference types are all types declared as a class, regardless of whether they are descended from GLib's <em>Object</em>
 or not.  Vala will ensure that when you pass an object by reference the
 system will keep track of the number of references currently alive in 
order to manage the memory for you.  The value of a reference that does 
not point anywhere is <tt class="backtick">null</tt>.  More on classes and their features in the section about object oriented programming. <span class="anchor" id="line-360"></span><span class="anchor" id="line-361"></span></p><p class="line867"><span class="anchor" id="line-362"></span><span class="anchor" id="line-363"></span><span class="anchor" id="line-364"></span><span class="anchor" id="line-365"></span><span class="anchor" id="line-366"></span><span class="anchor" id="line-367"></span><span class="anchor" id="line-368"></span><span class="anchor" id="line-369"></span><span class="anchor" id="line-370"></span><span class="anchor" id="line-371"></span><span class="anchor" id="line-1-49"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ae121ad5ea4a845c52b65371266bae28dedcbc7b" lang="en"><span class="line"><span class="anchor" id="line-1-50"></span><span class="Comment">/* defining a class */</span></span>
<span class="line"><span class="anchor" id="line-2-19"></span><span class="ResWord">class</span> <span class="ID">Track</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {             <span class="Comment">/* subclassing 'GLib.Object' */</span></span>
<span class="line"><span class="anchor" id="line-3-12"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">mass</span>;                 <span class="Comment">/* a public field */</span></span>
<span class="line"><span class="anchor" id="line-4-10"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">name</span> { <span class="ID">get</span>; <span class="ID">set</span>; }    <span class="Comment">/* a public property */</span></span>
<span class="line"><span class="anchor" id="line-5-7"></span>    <span class="ResWord">private</span> <span class="ResWord">bool</span> <span class="ID">terminated</span> = <span class="ConsWord">false</span>;    <span class="Comment">/* a private field */</span></span>
<span class="line"><span class="anchor" id="line-6-6"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">terminate</span>() {           <span class="Comment">/* a public method */</span></span>
<span class="line"><span class="anchor" id="line-7-5"></span>        <span class="ID">terminated</span> = <span class="ConsWord">true</span>;</span>
<span class="line"><span class="anchor" id="line-8-4"></span>    }</span>
<span class="line"><span class="anchor" id="line-9-3"></span>}</span>
</pre></div></div><span class="anchor" id="line-372"></span><span class="anchor" id="line-373"></span><p class="line867">
</p><h4 id="Static_Type_Casting">Static Type Casting</h4>
<span class="anchor" id="line-374"></span><span class="anchor" id="line-375"></span><p class="line874">In
 Vala, you can cast a variable from one type to another.  For a static 
type cast, a variable is casted by the desired type name with 
parenthesis.  A static cast doesn't impose any runtime type safety 
checking.  It works for all Vala types.  For example, <span class="anchor" id="line-376"></span><span class="anchor" id="line-377"></span></p><p class="line867"><span class="anchor" id="line-378"></span><span class="anchor" id="line-379"></span><span class="anchor" id="line-380"></span><span class="anchor" id="line-1-51"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-6ad3de34d8b0093e3c18e0804ea823628ecc1049" lang="en"><span class="line"><span class="anchor" id="line-1-52"></span><span class="ResWord">int</span> <span class="ID">i</span> = <span class="Number">10</span>;</span>
<span class="line"><span class="anchor" id="line-2-20"></span><span class="ResWord">float</span> <span class="ID">j</span> = (<span class="ResWord">float</span>) <span class="ID">i</span>;</span>
</pre></div></div><span class="anchor" id="line-381"></span><span class="anchor" id="line-382"></span><p class="line862">Vala supports another casting mechanism called <em>dynamic cast</em> which performs runtime type checking and is described in the section about object oriented programming. <span class="anchor" id="line-383"></span><span class="anchor" id="line-384"></span></p><p class="line867">
</p><h4 id="Type_Inference">Type Inference</h4>
<span class="anchor" id="line-385"></span><span class="anchor" id="line-386"></span><p class="line862">Vala has a mechanism called <em>type inference</em>, whereby a local variable may be defined using <tt class="backtick">var</tt>
 instead of giving a type, so long as it is unambiguous what type is 
meant.  The type is inferred from the right hand side of the assignment.
  It helps reduce unnecessary redundancy in your code without 
sacrificing static typing: <span class="anchor" id="line-387"></span><span class="anchor" id="line-388"></span></p><p class="line867"><span class="anchor" id="line-389"></span><span class="anchor" id="line-390"></span><span class="anchor" id="line-391"></span><span class="anchor" id="line-392"></span><span class="anchor" id="line-393"></span><span class="anchor" id="line-1-53"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-f9ed811902b9c04539323f1d948edf4085b3b239" lang="en"><span class="line"><span class="anchor" id="line-1-54"></span><span class="ID">var</span> <span class="ID">p</span> = <span class="ResWord">new</span> <span class="ID">Person</span>();     <span class="Comment">// same as: Person p = new Person();</span></span>
<span class="line"><span class="anchor" id="line-2-21"></span><span class="Comment"></span><span class="ID">var</span> <span class="ID">s</span> = <span class="String">"</span><span class="String">hello</span><span class="String">"</span>;          <span class="Comment">// same as: string s = "hello";</span></span>
<span class="line"><span class="anchor" id="line-3-13"></span><span class="Comment"></span><span class="ID">var</span> <span class="ID">l</span> = <span class="ResWord">new</span> <span class="ID">List</span>&lt;<span class="ResWord">int</span>&gt;();  <span class="Comment">// same as: List&lt;int&gt; l = new List&lt;int&gt;();</span></span>
<span class="line"><span class="anchor" id="line-4-11"></span><span class="Comment"></span><span class="ID">var</span> <span class="ID">i</span> = <span class="Number">10</span>;               <span class="Comment">// same as: int i = 10;</span></span>
<span class="line"><span class="anchor" id="line-5-8"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-394"></span><span class="anchor" id="line-395"></span><p class="line874">This
 only works for local variables.  Type inference is especially useful 
for types with generic type arguments (more on these later).  Compare <span class="anchor" id="line-396"></span><span class="anchor" id="line-397"></span></p><p class="line867"><span class="anchor" id="line-398"></span><span class="anchor" id="line-399"></span><span class="anchor" id="line-1-55"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-6ae748adaaba0bec0bc44c4c042dda7d39b40a3d" lang="en"><span class="line"><span class="anchor" id="line-1-56"></span><span class="ID">MyFoo</span>&lt;<span class="ID">string</span>, <span class="ID">MyBar</span>&lt;<span class="ID">string</span>, <span class="ResWord">int</span>&gt;&gt; <span class="ID">foo</span> = <span class="ResWord">new</span> <span class="ID">MyFoo</span>&lt;<span class="ID">string</span>, <span class="ID">MyBar</span>&lt;<span class="ID">string</span>, <span class="ResWord">int</span>&gt;&gt;();</span>
</pre></div></div><span class="anchor" id="line-400"></span><span class="anchor" id="line-401"></span><p class="line874">vs. <span class="anchor" id="line-402"></span><span class="anchor" id="line-403"></span></p><p class="line867"><span class="anchor" id="line-404"></span><span class="anchor" id="line-405"></span><span class="anchor" id="line-1-57"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-891afa3978527e7dc693833c2915ec877b8a628b" lang="en"><span class="line"><span class="anchor" id="line-1-58"></span><span class="ID">var</span> <span class="ID">foo</span> = <span class="ResWord">new</span> <span class="ID">MyFoo</span>&lt;<span class="ID">string</span>, <span class="ID">MyBar</span>&lt;<span class="ID">string</span>, <span class="ResWord">int</span>&gt;&gt;();</span>
</pre></div></div><span class="anchor" id="line-406"></span><span class="anchor" id="line-407"></span><p class="line867">
</p><h4 id="Defining_new_Type_from_other">Defining new Type from other</h4>
<span class="anchor" id="line-408"></span><span class="anchor" id="line-409"></span><p class="line874">Defining a new type is a matter of derive it from the one you need. Here is an example: <span class="anchor" id="line-410"></span><span class="anchor" id="line-411"></span><span class="anchor" id="line-412"></span><span class="anchor" id="line-413"></span><span class="anchor" id="line-414"></span><span class="anchor" id="line-415"></span></p><div class="comment dotted" style="display:none"><span class="anchor" id="line-1-59"></span><p class="line867"><span class="comment" style="display:none">defining an alias for a basic type (equivalent to typedef int Integer in C)*/ <span class="anchor" id="line-2-22"></span>[<a class="nonexistent" href="https://wiki.gnome.org/SimpleType">SimpleType</a>] <span class="anchor" id="line-3-14"></span>public struct Integer : uint { <span class="anchor" id="line-4-12"></span>} </span></p></div><span class="anchor" id="line-416"></span><span class="anchor" id="line-417"></span><p class="line867"><span class="anchor" id="line-418"></span><span class="anchor" id="line-419"></span><span class="anchor" id="line-420"></span><span class="anchor" id="line-421"></span><span class="anchor" id="line-422"></span><span class="anchor" id="line-423"></span><span class="anchor" id="line-424"></span><span class="anchor" id="line-1-60"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-e36158fa9cebf0b098ed4c1ccb503f1bc51f19cd" lang="en"><span class="line"><span class="anchor" id="line-1-61"></span><span class="Comment">/* Define a new type from a container like GLib.List with elements type GLib.Value */</span></span>
<span class="line"><span class="anchor" id="line-2-23"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">ValueList</span> : <span class="ID">GLib</span>.<span class="ID">List</span>&lt;<span class="ID">GLib</span>.<span class="ID">Value</span>&gt; {</span>
<span class="line"><span class="anchor" id="line-3-15"></span>        [<span class="ID">CCode</span> (<span class="ID">has_construct_function</span> = <span class="ConsWord">false</span>)]</span>
<span class="line"><span class="anchor" id="line-4-13"></span>        <span class="ResWord">protected</span> <span class="ID">ValueList</span> ();</span>
<span class="line"><span class="anchor" id="line-5-9"></span>        <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ID">GLib</span>.<span class="ID">Type</span> <span class="ID">get_type</span> ();</span>
<span class="line"><span class="anchor" id="line-6-7"></span>}</span>
</pre></div></div><span class="anchor" id="line-425"></span><span class="anchor" id="line-426"></span><p class="line867">
</p><h3 id="Operators">Operators</h3>
<span class="anchor" id="line-427"></span><span class="anchor" id="line-428"></span><p class="line867"><span class="anchor" id="line-429"></span><span class="anchor" id="line-430"></span></p><pre><span class="anchor" id="line-1-5"></span>=</pre><span class="anchor" id="line-431"></span><span class="anchor" id="line-432"></span><p class="line874">assignment.  The left operand must be an identifier, and the right must result in a value or reference as appropriate. <span class="anchor" id="line-433"></span><span class="anchor" id="line-434"></span></p><p class="line867"><span class="anchor" id="line-435"></span><span class="anchor" id="line-436"></span></p><pre><span class="anchor" id="line-1-6"></span>+, -, /, *, %</pre><span class="anchor" id="line-437"></span><span class="anchor" id="line-438"></span><p class="line862">basic arithmetic, applied to left and right operands. The <tt class="backtick">+</tt> operator can also concatenate strings. <span class="anchor" id="line-439"></span><span class="anchor" id="line-440"></span></p><p class="line867"><span class="anchor" id="line-441"></span><span class="anchor" id="line-442"></span></p><pre><span class="anchor" id="line-1-7"></span>+=, -=, /=, *=, %=</pre><span class="anchor" id="line-443"></span><span class="anchor" id="line-444"></span><p class="line874">arithmetic operation between left and right operands, where the left must be an identifier, to which the result is assigned. <span class="anchor" id="line-445"></span><span class="anchor" id="line-446"></span></p><p class="line867"><span class="anchor" id="line-447"></span><span class="anchor" id="line-448"></span></p><pre><span class="anchor" id="line-1-8"></span>++, --</pre><span class="anchor" id="line-449"></span><span class="anchor" id="line-450"></span><p class="line874">increment
 and decrement operations with implicit assignment.  These take just one
 argument, which must be an identifier of a simple data type.  The value
 will be changed and assigned back to the identifier.  These operators 
may be placed in either prefix or postfix positions - with the former 
the evaluated value of the statement will be the newly calculated value,
 with the latter the original value is returned. <span class="anchor" id="line-451"></span><span class="anchor" id="line-452"></span></p><p class="line867"><span class="anchor" id="line-453"></span><span class="anchor" id="line-454"></span></p><pre><span class="anchor" id="line-1-9"></span>|, ^, &amp;, ~, |=, &amp;=, ^=</pre><span class="anchor" id="line-455"></span><span class="anchor" id="line-456"></span><p class="line862">bitwise
 operations: or, exclusive or, and, not.  The second set include 
assignment and are analogous to the arithmetic versions.  These can be 
applied to any of the simple value types.  (There is of no assignment 
operator associated with <tt class="backtick">~</tt> because this is a unary operator.  The equivalent operation is just <tt class="backtick">a&nbsp;=&nbsp;~a</tt>). <span class="anchor" id="line-457"></span><span class="anchor" id="line-458"></span></p><p class="line867"><span class="anchor" id="line-459"></span><span class="anchor" id="line-460"></span></p><pre><span class="anchor" id="line-1-10"></span>&lt;&lt;, &gt;&gt;</pre><span class="anchor" id="line-461"></span><span class="anchor" id="line-462"></span><p class="line874">bit shift operations, shifting the left operand a number of bits according the right operand. <span class="anchor" id="line-463"></span><span class="anchor" id="line-464"></span></p><p class="line867"><span class="anchor" id="line-465"></span><span class="anchor" id="line-466"></span></p><pre><span class="anchor" id="line-1-11"></span>&lt;&lt;=, &gt;&gt;=</pre><span class="anchor" id="line-467"></span><span class="anchor" id="line-468"></span><p class="line874">bit
 shift operations, shifting the left operand a number of bits according 
the right operand.  The left operand must be an identifier, to which the
 result is assigned. <span class="anchor" id="line-469"></span><span class="anchor" id="line-470"></span></p><p class="line867"><span class="anchor" id="line-471"></span><span class="anchor" id="line-472"></span></p><pre><span class="anchor" id="line-1-12"></span>==</pre><span class="anchor" id="line-473"></span><span class="anchor" id="line-474"></span><p class="line862">equality test.  Evaluates to a <tt class="backtick">bool</tt>
 value dependent on whether the left and right operands are equal.  In 
the case of value types this means their values are equal, in the case 
of reference types that the objects are the same instance.  An exception
 to this rule is the <tt class="backtick">string</tt> type, which is tested for equality by value. <span class="anchor" id="line-475"></span><span class="anchor" id="line-476"></span></p><p class="line867"><span class="anchor" id="line-477"></span><span class="anchor" id="line-478"></span></p><pre><span class="anchor" id="line-1-13"></span>&lt;, &gt;, &gt;=, &lt;=, !=</pre><span class="anchor" id="line-479"></span><span class="anchor" id="line-480"></span><p class="line862">inequality tests.  Evaluate to a <tt class="backtick">bool</tt>
 value dependent on whether the left and right operands are different in
 the manner described.  These are valid for simple value data types, and
 the <tt class="backtick">string</tt> type.  For strings these operators compare the lexicographical order. <span class="anchor" id="line-481"></span><span class="anchor" id="line-482"></span></p><p class="line867"><span class="anchor" id="line-483"></span><span class="anchor" id="line-484"></span></p><pre><span class="anchor" id="line-1-14"></span>!, &amp;&amp;, ||</pre><span class="anchor" id="line-485"></span><span class="anchor" id="line-486"></span><p class="line874">logic
 operations: not, and, or.  These operations can be applied to Boolean 
values - the first taking just one value the others two. <span class="anchor" id="line-487"></span><span class="anchor" id="line-488"></span></p><p class="line867"><span class="anchor" id="line-489"></span><span class="anchor" id="line-490"></span></p><pre><span class="anchor" id="line-1-15"></span>? :</pre><span class="anchor" id="line-491"></span><span class="anchor" id="line-492"></span><p class="line862">ternary
 conditional operator.  Evaluates a condition and returns either the 
value of the left or the right sub-expression based on whether the 
condition is true or false: <em>condition</em> <tt class="backtick">?</tt> <em>value if true</em> <tt class="backtick">:</tt> <em>value if false</em> <span class="anchor" id="line-493"></span><span class="anchor" id="line-494"></span></p><p class="line867"><span class="anchor" id="line-495"></span><span class="anchor" id="line-496"></span></p><pre><span class="anchor" id="line-1-16"></span>??</pre><span class="anchor" id="line-497"></span><span class="anchor" id="line-498"></span><p class="line862">null coalescing operator: <tt class="backtick">a&nbsp;??&nbsp;b</tt> is equivalent to <tt class="backtick">a&nbsp;!=&nbsp;null&nbsp;?&nbsp;a&nbsp;:&nbsp;b</tt>.  This operator is useful for example to provide a default value in case a reference is <em>null</em>: <span class="anchor" id="line-499"></span><span class="anchor" id="line-500"></span></p><p class="line867"><span class="anchor" id="line-501"></span><span class="anchor" id="line-502"></span><span class="anchor" id="line-1-62"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-f1ab333a45c6c402f22358ec0579a25ce40e5a94" lang="en"><span class="line"><span class="anchor" id="line-1-63"></span><span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hello, %s!</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">name</span> ?? <span class="String">"</span><span class="String">unknown person</span><span class="String">"</span>);</span>
</pre></div></div><span class="anchor" id="line-503"></span><span class="anchor" id="line-504"></span><p class="line867"><span class="anchor" id="line-505"></span><span class="anchor" id="line-506"></span></p><pre><span class="anchor" id="line-1-17"></span>in</pre><span class="anchor" id="line-507"></span><span class="anchor" id="line-508"></span><p class="line862">checks
 if the right operand contains the left operand.  This operator works on
 arrays, strings, collections or any other type that has an appropriate <em>contains()</em> method.  For strings it performs a substring search. <span class="anchor" id="line-509"></span><span class="anchor" id="line-510"></span></p><p class="line874">Operators
 cannot be overloaded in Vala.  There are extra operators that are valid
 in the context of lambda declarations and other specific tasks - these 
are explained in the context they are applicable. <span class="anchor" id="line-511"></span><span class="anchor" id="line-512"></span></p><p class="line867">
</p><h3 id="Control_Structures">Control Structures</h3>
<span class="anchor" id="line-513"></span><span class="anchor" id="line-514"></span><p class="line867"><span class="anchor" id="line-515"></span><span class="anchor" id="line-516"></span><span class="anchor" id="line-1-64"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-eb6285669cd9544e2886f6222b881478459457d5" lang="en"><span class="line"><span class="anchor" id="line-1-65"></span><span class="ResWord">while</span> (<span class="ID">a</span> &gt; <span class="ID">b</span>) { <span class="ID">a</span>--; }</span>
</pre></div></div><span class="anchor" id="line-517"></span><span class="anchor" id="line-518"></span><p class="line862">will decrement <em>a</em> repeatedly, checking before each iteration that <em>a</em> is greater than <em>b</em>. <span class="anchor" id="line-519"></span><span class="anchor" id="line-520"></span></p><p class="line867"><span class="anchor" id="line-521"></span><span class="anchor" id="line-522"></span><span class="anchor" id="line-1-66"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a5a855d93f9240432a858b809d9f2fcb0d6b20cb" lang="en"><span class="line"><span class="anchor" id="line-1-67"></span><span class="ResWord">do</span> { <span class="ID">a</span>--; } <span class="ResWord">while</span> (<span class="ID">a</span> &gt; <span class="ID">b</span>);</span>
</pre></div></div><span class="anchor" id="line-523"></span><span class="anchor" id="line-524"></span><p class="line862">will decrement <em>a</em> repeatedly, checking after each iteration that <em>a</em> is greater than <em>b</em>. <span class="anchor" id="line-525"></span><span class="anchor" id="line-526"></span></p><p class="line867"><span class="anchor" id="line-527"></span><span class="anchor" id="line-528"></span><span class="anchor" id="line-1-68"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b0b45780860d0c06ee6a50c740fdb3f76f292156" lang="en"><span class="line"><span class="anchor" id="line-1-69"></span><span class="ResWord">for</span> (<span class="ResWord">int</span> <span class="ID">a</span> = <span class="Number">0</span>; <span class="ID">a</span> &lt; <span class="Number">10</span>; <span class="ID">a</span>++) { <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>); }</span>
</pre></div></div><span class="anchor" id="line-529"></span><span class="anchor" id="line-530"></span><p class="line862">will initialize <em>a</em> to 0, then print <em>a</em> repeatedly until <em>a</em> is no longer less than 10, incrementing <em>a</em> after each iteration. <span class="anchor" id="line-531"></span><span class="anchor" id="line-532"></span></p><p class="line867"><span class="anchor" id="line-533"></span><span class="anchor" id="line-534"></span><span class="anchor" id="line-1-70"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-60e1d874c5fd5fb4ce966fe57dfef27f5a24fb42" lang="en"><span class="line"><span class="anchor" id="line-1-71"></span><span class="ID">foreach</span> (<span class="ResWord">int</span> <span class="ID">a</span> <span class="ID">in</span> <span class="ID">int_array</span>) { <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>); }</span>
</pre></div></div><span class="anchor" id="line-535"></span><span class="anchor" id="line-536"></span><p class="line874">will print out each integer in an array, or another iterable collection.  The meaning of "iterable" will be described later. <span class="anchor" id="line-537"></span><span class="anchor" id="line-538"></span></p><p class="line862">All of the four preceding types of loop may be controlled with the keywords <tt class="backtick">break</tt> and <tt class="backtick">continue</tt>.  A <tt class="backtick">break</tt> instruction will cause the loop to immediately terminate, while <tt class="backtick">continue</tt> will jump straight to the test part of the iteration. <span class="anchor" id="line-539"></span><span class="anchor" id="line-540"></span></p><p class="line867"><span class="anchor" id="line-541"></span><span class="anchor" id="line-542"></span><span class="anchor" id="line-543"></span><span class="anchor" id="line-544"></span><span class="anchor" id="line-1-72"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-951e7f09e4cce3bc6a9a6b3b8c42bcbf1aae7fa0" lang="en"><span class="line"><span class="anchor" id="line-1-73"></span><span class="ResWord">if</span> (<span class="ID">a</span> &gt; <span class="Number">0</span>) { <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">a is greater than 0</span><span class="SPChar">\n</span><span class="String">"</span>); }</span>
<span class="line"><span class="anchor" id="line-2-24"></span><span class="ResWord">else</span> <span class="ResWord">if</span> (<span class="ID">a</span> &lt; <span class="Number">0</span>) { <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">a is less than 0</span><span class="SPChar">\n</span><span class="String">"</span>); }</span>
<span class="line"><span class="anchor" id="line-3-16"></span><span class="ResWord">else</span> { <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">a is equal to 0</span><span class="SPChar">\n</span><span class="String">"</span>); }</span>
</pre></div></div><span class="anchor" id="line-545"></span><span class="anchor" id="line-546"></span><p class="line862">executes
 a particular piece of code based on a set of conditions.  The first 
condition to match decides which code will execute, if <em>a</em> is 
greater than 0 it will not be tested whether it is less than 0.  Any 
number of else if blocks is allowed, and zero or one else blocks. <span class="anchor" id="line-547"></span><span class="anchor" id="line-548"></span></p><p class="line867"><span class="anchor" id="line-549"></span><span class="anchor" id="line-550"></span><span class="anchor" id="line-551"></span><span class="anchor" id="line-552"></span><span class="anchor" id="line-553"></span><span class="anchor" id="line-554"></span><span class="anchor" id="line-555"></span><span class="anchor" id="line-556"></span><span class="anchor" id="line-557"></span><span class="anchor" id="line-558"></span><span class="anchor" id="line-559"></span><span class="anchor" id="line-560"></span><span class="anchor" id="line-561"></span><span class="anchor" id="line-1-74"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-dc71ae0574fd899545e954d893f0068530c3cce0" lang="en"><span class="line"><span class="anchor" id="line-1-75"></span><span class="ResWord">switch</span> (<span class="ID">a</span>) {</span>
<span class="line"><span class="anchor" id="line-2-25"></span><span class="ResWord">case</span> <span class="Number">1</span>:</span>
<span class="line"><span class="anchor" id="line-3-17"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">one</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-4-14"></span>    <span class="ResWord">break</span>;</span>
<span class="line"><span class="anchor" id="line-5-10"></span><span class="ResWord">case</span> <span class="Number">2</span>:</span>
<span class="line"><span class="anchor" id="line-6-8"></span><span class="ResWord">case</span> <span class="Number">3</span>:</span>
<span class="line"><span class="anchor" id="line-7-6"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">two or three</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-8-5"></span>    <span class="ResWord">break</span>;</span>
<span class="line"><span class="anchor" id="line-9-4"></span><span class="ResWord">default</span>:</span>
<span class="line"><span class="anchor" id="line-10-2"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">unknown</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-11-2"></span>    <span class="ResWord">break</span>;</span>
<span class="line"><span class="anchor" id="line-12-2"></span>}</span>
</pre></div></div><span class="anchor" id="line-562"></span><span class="anchor" id="line-563"></span><p class="line862">A <tt class="backtick">switch</tt>
 statement runs exactly one or zero sections of code based on the value 
passed to it.  In Vala there is no fall through between cases, except 
for empty cases.  In order to ensure this, each non-empty case must end 
with a <tt class="backtick">break</tt>, <tt class="backtick">return</tt> or <tt class="backtick">throw</tt> statement.  It is possible to use switch statements with strings. <span class="anchor" id="line-564"></span><span class="anchor" id="line-565"></span></p><p class="line862">A
 note for C programmers: conditions must always evaluate to a Boolean 
value.  This means that if you want to check a variable for <tt class="backtick">null</tt> or 0 you must do this explicitly: <tt class="backtick">if&nbsp;(object&nbsp;!=&nbsp;null)&nbsp;{&nbsp;}</tt> or <tt class="backtick">if&nbsp;(number&nbsp;!=&nbsp;0)&nbsp;{&nbsp;}</tt>. <span class="anchor" id="line-566"></span><span class="anchor" id="line-567"></span></p><p class="line867">
</p><h3 id="Language_Elements">Language Elements</h3>
<span class="anchor" id="line-568"></span><span class="anchor" id="line-569"></span><p class="line867">
</p><h4 id="Methods">Methods</h4>
<span class="anchor" id="line-570"></span><span class="anchor" id="line-571"></span><p class="line862">Functions are called <em>methods</em> in Vala, regardless of whether they are defined inside a class or not.  From now on we will stick to the term <em>method</em>. <span class="anchor" id="line-572"></span><span class="anchor" id="line-573"></span></p><p class="line867"><span class="anchor" id="line-574"></span><span class="anchor" id="line-575"></span><span class="anchor" id="line-576"></span><span class="anchor" id="line-577"></span><span class="anchor" id="line-1-76"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-7901f8e2b45492ba1f76d9b5903cd90d0982a646" lang="en"><span class="line"><span class="anchor" id="line-1-77"></span><span class="ResWord">int</span> <span class="ID">method_name</span>(<span class="ResWord">int</span> <span class="ID">arg1</span>, <span class="ID">Object</span> <span class="ID">arg2</span>) {</span>
<span class="line"><span class="anchor" id="line-2-26"></span>    <span class="ResWord">return</span> <span class="Number">1</span>;</span>
<span class="line"><span class="anchor" id="line-3-18"></span>}</span>
</pre></div></div><span class="anchor" id="line-578"></span><span class="anchor" id="line-579"></span><p class="line862">This code defines a method, having the name <em>method_name</em>, taking two arguments, one an integer and the other an <em>Object</em>
 (the first passed by value, the second as a reference as described).  
The method will return an integer, which in this case is 1. <span class="anchor" id="line-580"></span><span class="anchor" id="line-581"></span></p><p class="line862">All
 Vala methods are C functions, and therefore take an arbitrary number of
 arguments and return one value (or none if the method is declared <em>void</em>).
  They may approximate more return values by placing data in locations 
known to the calling code.  Details of how to do this are in the 
"Parameter Directions" section in the advanced part of this tutorial. <span class="anchor" id="line-582"></span><span class="anchor" id="line-583"></span></p><p class="line862">The naming convention for methods in Vala is <em>all_lower_case</em> with underscores as word separators.  This may be a little bit unfamiliar to C# or Java programmers who are accustomed to <em>CamelCase</em> or <em>mixedCamelCase</em> method names.  But with this style you will be consistent with other Vala and C/GObject libraries. <span class="anchor" id="line-584"></span><span class="anchor" id="line-585"></span></p><p class="line874">It
 is not possible to have multiple methods with the same name but 
different signature within the same scope ("method overloading"): <span class="anchor" id="line-586"></span><span class="anchor" id="line-587"></span></p><p class="line867"><span class="anchor" id="line-588"></span><span class="anchor" id="line-589"></span><span class="anchor" id="line-590"></span><span class="anchor" id="line-1-78"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d874c79517bda901973c7a2dc8ee9d1ab281e660" lang="en"><span class="line"><span class="anchor" id="line-1-79"></span><span class="ResWord">void</span> <span class="ID">draw</span>(<span class="ID">string</span> <span class="ID">text</span>) { }</span>
<span class="line"><span class="anchor" id="line-2-27"></span><span class="ResWord">void</span> <span class="ID">draw</span>(<span class="ID">Shape</span> <span class="ID">shape</span>) { }  <span class="Comment">// not possible</span></span>
<span class="line"><span class="anchor" id="line-3-19"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-591"></span><span class="anchor" id="line-592"></span><p class="line874">This
 is due to the fact that libraries produced with Vala are intended to be
 usable for C programmers as well.  In Vala you would do something like 
this instead: <span class="anchor" id="line-593"></span><span class="anchor" id="line-594"></span></p><p class="line867"><span class="anchor" id="line-595"></span><span class="anchor" id="line-596"></span><span class="anchor" id="line-597"></span><span class="anchor" id="line-1-80"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-17332bbdda4940cade506edc2422d89999de3114" lang="en"><span class="line"><span class="anchor" id="line-1-81"></span><span class="ResWord">void</span> <span class="ID">draw_text</span>(<span class="ID">string</span> <span class="ID">text</span>) { }</span>
<span class="line"><span class="anchor" id="line-2-28"></span><span class="ResWord">void</span> <span class="ID">draw_shape</span>(<span class="ID">Shape</span> <span class="ID">shape</span>) { }</span>
</pre></div></div><span class="anchor" id="line-598"></span><span class="anchor" id="line-599"></span><p class="line874">By
 choosing slightly different names you can avoid a name clash.  In 
languages that support method overloading it is often used for providing
 convenience methods with less parameters that chain up to the most 
general method: <span class="anchor" id="line-600"></span><span class="anchor" id="line-601"></span></p><p class="line867"><span class="anchor" id="line-602"></span><span class="anchor" id="line-603"></span><span class="anchor" id="line-604"></span><span class="anchor" id="line-605"></span><span class="anchor" id="line-1-82"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-cec12732d022c66610c0f5913c8c9773e899a0e8" lang="en"><span class="line"><span class="anchor" id="line-1-83"></span><span class="ResWord">void</span> <span class="ID">f</span>(<span class="ResWord">int</span> <span class="ID">x</span>, <span class="ID">string</span> <span class="ID">s</span>, <span class="ResWord">double</span> <span class="ID">z</span>) { }</span>
<span class="line"><span class="anchor" id="line-2-29"></span><span class="ResWord">void</span> <span class="ID">f</span>(<span class="ResWord">int</span> <span class="ID">x</span>, <span class="ID">string</span> <span class="ID">s</span>) { <span class="ID">f</span>(<span class="ID">x</span>, <span class="ID">s</span>, <span class="Number">0.5</span>); }  <span class="Comment">// not possible</span></span>
<span class="line"><span class="anchor" id="line-3-20"></span><span class="Comment"></span><span class="ResWord">void</span> <span class="ID">f</span>(<span class="ResWord">int</span> <span class="ID">x</span>) { <span class="ID">f</span>(<span class="ID">x</span>, <span class="String">"</span><span class="String">hello</span><span class="String">"</span>); }           <span class="Comment">// not possible</span></span>
<span class="line"><span class="anchor" id="line-4-15"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-606"></span><span class="anchor" id="line-607"></span><p class="line874">In
 this case you can use Vala's default argument feature for method 
parameters in order to achieve a similar behaviour with just one method.
  You can define default values for the last parameters of a method, so 
that you don't have to pass them explicitly to a method call: <span class="anchor" id="line-608"></span><span class="anchor" id="line-609"></span></p><p class="line867"><span class="anchor" id="line-610"></span><span class="anchor" id="line-611"></span><span class="anchor" id="line-1-84"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-0026315d66df490e338d4c678a518921388a5a0d" lang="en"><span class="line"><span class="anchor" id="line-1-85"></span><span class="ResWord">void</span> <span class="ID">f</span>(<span class="ResWord">int</span> <span class="ID">x</span>, <span class="ID">string</span> <span class="ID">s</span> = <span class="String">"</span><span class="String">hello</span><span class="String">"</span>, <span class="ResWord">double</span> <span class="ID">z</span> = <span class="Number">0.5</span>) { }</span>
</pre></div></div><span class="anchor" id="line-612"></span><span class="anchor" id="line-613"></span><p class="line874">Some possible calls of this method might be: <span class="anchor" id="line-614"></span><span class="anchor" id="line-615"></span></p><p class="line867"><span class="anchor" id="line-616"></span><span class="anchor" id="line-617"></span><span class="anchor" id="line-618"></span><span class="anchor" id="line-619"></span><span class="anchor" id="line-1-86"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-f593c04449ac2bbdf7559364c1f1975bb0ba73ef" lang="en"><span class="line"><span class="anchor" id="line-1-87"></span><span class="ID">f</span>(<span class="Number">2</span>);</span>
<span class="line"><span class="anchor" id="line-2-30"></span><span class="ID">f</span>(<span class="Number">2</span>, <span class="String">"</span><span class="String">hi</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-21"></span><span class="ID">f</span>(<span class="Number">2</span>, <span class="String">"</span><span class="String">hi</span><span class="String">"</span>, <span class="Number">0.75</span>);</span>
</pre></div></div><span class="anchor" id="line-620"></span><span class="anchor" id="line-621"></span><p class="line862">It's even possible to define methods with real variable-length argument lists (<em>varargs</em>) like <em>stdout.printf()</em>, although not necessarily recommended.  You will learn how to do that later. <span class="anchor" id="line-622"></span><span class="anchor" id="line-623"></span></p><p class="line862">Vala
 performs a basic nullability check on the method parameters and return 
values.  If it is allowable for a method parameter or a return value to 
be <tt class="backtick">null</tt>, the type symbol should be postfixed with a <tt class="backtick">?</tt>
 modifier.  This extra information helps the Vala compiler to perform 
static checks and to add runtime assertions on the preconditions of the 
methods, which may help in avoiding related errors such as dereferencing
 a <tt class="backtick">null</tt> reference. <span class="anchor" id="line-624"></span><span class="anchor" id="line-625"></span></p><p class="line867"><span class="anchor" id="line-626"></span><span class="anchor" id="line-627"></span><span class="anchor" id="line-628"></span><span class="anchor" id="line-629"></span><span class="anchor" id="line-1-88"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-30907d96d5d04021693c60ead5964bf5b4f6333d" lang="en"><span class="line"><span class="anchor" id="line-1-89"></span><span class="ID">string</span>? <span class="ID">method_name</span>(<span class="ID">string</span>? <span class="ID">text</span>, <span class="ID">Foo</span>? <span class="ID">foo</span>, <span class="ID">Bar</span> <span class="ID">bar</span>) {</span>
<span class="line"><span class="anchor" id="line-2-31"></span>    <span class="Comment">// ...</span></span>
<span class="line"><span class="anchor" id="line-3-22"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-630"></span><span class="anchor" id="line-631"></span><p class="line862">In this example <tt class="backtick">text</tt>, <tt class="backtick">foo</tt> and the return value may be <tt class="backtick">null</tt>, however, <tt class="backtick">bar</tt> must not be <tt class="backtick">null</tt>. <span class="anchor" id="line-632"></span><span class="anchor" id="line-633"></span></p><p class="line867">
</p><h4 id="Delegates">Delegates</h4>
<span class="anchor" id="line-634"></span><span class="anchor" id="line-635"></span><p class="line867"><span class="anchor" id="line-636"></span><span class="anchor" id="line-637"></span><span class="anchor" id="line-1-90"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-17c768b11183b0f6bdce92f29103d5e7e6b80650" lang="en"><span class="line"><span class="anchor" id="line-1-91"></span><span class="ID">delegate</span> <span class="ResWord">void</span> <span class="ID">DelegateType</span>(<span class="ResWord">int</span> <span class="ID">a</span>);</span>
</pre></div></div><span class="anchor" id="line-638"></span><span class="anchor" id="line-639"></span><p class="line862">Delegates
 represent methods, allowing chunks of code to be passed around like 
objects.  The example above defines a new type named <em>DelegateType</em> which represents methods taking an <em>int</em>
 and not returning a value.  Any method that matches this signature may 
be assigned to a variable of this type or passed as a method argument of
 this type. <span class="anchor" id="line-640"></span><span class="anchor" id="line-641"></span></p><p class="line867"><span class="anchor" id="line-642"></span><span class="anchor" id="line-643"></span><span class="anchor" id="line-644"></span><span class="anchor" id="line-645"></span><span class="anchor" id="line-646"></span><span class="anchor" id="line-647"></span><span class="anchor" id="line-648"></span><span class="anchor" id="line-649"></span><span class="anchor" id="line-650"></span><span class="anchor" id="line-651"></span><span class="anchor" id="line-652"></span><span class="anchor" id="line-653"></span><span class="anchor" id="line-654"></span><span class="anchor" id="line-655"></span><span class="anchor" id="line-1-92"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-49da322f9616ba5d0c7ce607f4eaf5eb5b979dbe" lang="en"><span class="line"><span class="anchor" id="line-1-93"></span><span class="ID">delegate</span> <span class="ResWord">void</span> <span class="ID">DelegateType</span>(<span class="ResWord">int</span> <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-2-32"></span></span>
<span class="line"><span class="anchor" id="line-3-23"></span><span class="ResWord">void</span> <span class="ID">f1</span>(<span class="ResWord">int</span> <span class="ID">a</span>) {</span>
<span class="line"><span class="anchor" id="line-4-16"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-5-11"></span>}</span>
<span class="line"><span class="anchor" id="line-6-9"></span></span>
<span class="line"><span class="anchor" id="line-7-7"></span><span class="ResWord">void</span> <span class="ID">f2</span>(<span class="ID">DelegateType</span> <span class="ID">d</span>, <span class="ResWord">int</span> <span class="ID">a</span>) {</span>
<span class="line"><span class="anchor" id="line-8-6"></span>    <span class="ID">d</span>(<span class="ID">a</span>);       <span class="Comment">// Calling a delegate</span></span>
<span class="line"><span class="anchor" id="line-9-5"></span><span class="Comment"></span>}</span>
<span class="line"><span class="anchor" id="line-10-3"></span></span>
<span class="line"><span class="anchor" id="line-11-3"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-12-3"></span>    <span class="ID">f2</span>(<span class="ID">f1</span>, <span class="Number">5</span>);  <span class="Comment">// Passing a method as delegate argument to another method</span></span>
<span class="line"><span class="anchor" id="line-13-2"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-656"></span><span class="anchor" id="line-657"></span><p class="line862">This code will execute the method <em>f2</em>, passing in a reference to method <em>f1</em> and the number 5.  <em>f2</em> will then execute the method <em>f1</em>, passing it the number. <span class="anchor" id="line-658"></span><span class="anchor" id="line-659"></span></p><p class="line874">Delegates may also be created locally. A member method can also be assigned to a delegate, e.g, <span class="anchor" id="line-660"></span><span class="anchor" id="line-661"></span></p><p class="line867"><span class="anchor" id="line-662"></span><span class="anchor" id="line-663"></span><span class="anchor" id="line-664"></span><span class="anchor" id="line-665"></span><span class="anchor" id="line-666"></span><span class="anchor" id="line-667"></span><span class="anchor" id="line-668"></span><span class="anchor" id="line-669"></span><span class="anchor" id="line-670"></span><span class="anchor" id="line-671"></span><span class="anchor" id="line-672"></span><span class="anchor" id="line-673"></span><span class="anchor" id="line-674"></span><span class="anchor" id="line-675"></span><span class="anchor" id="line-676"></span><span class="anchor" id="line-677"></span><span class="anchor" id="line-1-94"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-cc6b041da0216df430216c568978b2acdd749b0d" lang="en"><span class="line"><span class="anchor" id="line-1-95"></span><span class="ResWord">class</span> <span class="ID">Foo</span> {</span>
<span class="line"><span class="anchor" id="line-2-33"></span></span>
<span class="line"><span class="anchor" id="line-3-24"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">f1</span>(<span class="ResWord">int</span> <span class="ID">a</span>) {</span>
<span class="line"><span class="anchor" id="line-4-17"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">a = %d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-5-12"></span>    }</span>
<span class="line"><span class="anchor" id="line-6-10"></span></span>
<span class="line"><span class="anchor" id="line-7-8"></span>    <span class="ID">delegate</span> <span class="ResWord">void</span> <span class="ID">DelegateType</span>(<span class="ResWord">int</span> <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-8-7"></span></span>
<span class="line"><span class="anchor" id="line-9-6"></span>    <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">int</span> <span class="ID">main</span>(<span class="ID">string</span>[] <span class="ID">args</span>) {</span>
<span class="line"><span class="anchor" id="line-10-4"></span>        <span class="ID">Foo</span> <span class="ID">foo</span> = <span class="ResWord">new</span> <span class="ID">Foo</span>();</span>
<span class="line"><span class="anchor" id="line-11-4"></span>        <span class="ID">DelegateType</span> <span class="ID">d1</span> = <span class="ID">foo</span>.<span class="ID">f1</span>;</span>
<span class="line"><span class="anchor" id="line-12-4"></span>        <span class="ID">d1</span>(<span class="Number">10</span>);</span>
<span class="line"><span class="anchor" id="line-13-3"></span>        <span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-14-2"></span>    }</span>
<span class="line"><span class="anchor" id="line-15-2"></span>}</span>
</pre></div></div><span class="anchor" id="line-678"></span><span class="anchor" id="line-679"></span><p class="line867">
</p><h4 id="Anonymous_Methods_.2BAC8_Closures">Anonymous Methods / Closures</h4>
<span class="anchor" id="line-680"></span><span class="anchor" id="line-681"></span><p class="line867"><span class="anchor" id="line-682"></span><span class="anchor" id="line-683"></span><span class="anchor" id="line-1-96"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-cb12525a78e946382e451c7ee31f57a8f841b995" lang="en"><span class="line"><span class="anchor" id="line-1-97"></span>(<span class="ID">a</span>) =&gt; { <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>); }</span>
</pre></div></div><span class="anchor" id="line-684"></span><span class="anchor" id="line-685"></span><p class="line862">An <em>anonymous method</em>, also known as <em>lambda expression</em>, <em>function literal</em> or <em>closure</em>, can be defined in Vala with the <tt class="backtick">=&gt;</tt> operator.  The parameter list is on the left hand side of the operator, the method body on the right hand side. <span class="anchor" id="line-686"></span><span class="anchor" id="line-687"></span></p><p class="line874">An
 anonymous method standing by itself like the one above does not make 
much sense.  It is only useful if you assign it directly to a variable 
of a delegate type or pass it as a method argument to another method. <span class="anchor" id="line-688"></span><span class="anchor" id="line-689"></span></p><p class="line874">Notice
 that neither parameter nor return types are explicitly given.  Instead 
the types are inferred from the signature of the delegate it is used 
with. <span class="anchor" id="line-690"></span><span class="anchor" id="line-691"></span></p><p class="line874">Assigning an anonymous method to a delegate variable: <span class="anchor" id="line-692"></span><span class="anchor" id="line-693"></span></p><p class="line867"><span class="anchor" id="line-694"></span><span class="anchor" id="line-695"></span><span class="anchor" id="line-696"></span><span class="anchor" id="line-697"></span><span class="anchor" id="line-698"></span><span class="anchor" id="line-699"></span><span class="anchor" id="line-700"></span><span class="anchor" id="line-701"></span><span class="anchor" id="line-702"></span><span class="anchor" id="line-703"></span><span class="anchor" id="line-704"></span><span class="anchor" id="line-1-98"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-3558a9c3a2dfd1ffb0c6abc0ba5a455c42d309fa" lang="en"><span class="line"><span class="anchor" id="line-1-99"></span><span class="ID">delegate</span> <span class="ResWord">void</span> <span class="ID">PrintIntFunc</span>(<span class="ResWord">int</span> <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-2-34"></span></span>
<span class="line"><span class="anchor" id="line-3-25"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-4-18"></span>    <span class="ID">PrintIntFunc</span> <span class="ID">p1</span> = (<span class="ID">a</span>) =&gt; { <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>); };</span>
<span class="line"><span class="anchor" id="line-5-13"></span>    <span class="ID">p1</span>(<span class="Number">10</span>);</span>
<span class="line"><span class="anchor" id="line-6-11"></span></span>
<span class="line"><span class="anchor" id="line-7-9"></span>    <span class="Comment">// Curly braces are optional if the body contains only one statement:</span></span>
<span class="line"><span class="anchor" id="line-8-8"></span><span class="Comment"></span>    <span class="ID">PrintIntFunc</span> <span class="ID">p2</span> = (<span class="ID">a</span>) =&gt; <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-9-7"></span>    <span class="ID">p2</span>(<span class="Number">20</span>);</span>
<span class="line"><span class="anchor" id="line-10-5"></span>}</span>
</pre></div></div><span class="anchor" id="line-705"></span><span class="anchor" id="line-706"></span><p class="line874">Passing an anonymous method to another method: <span class="anchor" id="line-707"></span><span class="anchor" id="line-708"></span></p><p class="line867"><span class="anchor" id="line-709"></span><span class="anchor" id="line-710"></span><span class="anchor" id="line-711"></span><span class="anchor" id="line-712"></span><span class="anchor" id="line-713"></span><span class="anchor" id="line-714"></span><span class="anchor" id="line-715"></span><span class="anchor" id="line-716"></span><span class="anchor" id="line-717"></span><span class="anchor" id="line-718"></span><span class="anchor" id="line-719"></span><span class="anchor" id="line-720"></span><span class="anchor" id="line-721"></span><span class="anchor" id="line-722"></span><span class="anchor" id="line-723"></span><span class="anchor" id="line-724"></span><span class="anchor" id="line-1-100"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d0ff691ee351663d53cee2d04c14dd70ac8e9211" lang="en"><span class="line"><span class="anchor" id="line-1-101"></span><span class="ID">delegate</span> <span class="ResWord">int</span> <span class="ID">Comparator</span>(<span class="ResWord">int</span> <span class="ID">a</span>, <span class="ResWord">int</span> <span class="ID">b</span>);</span>
<span class="line"><span class="anchor" id="line-2-35"></span></span>
<span class="line"><span class="anchor" id="line-3-26"></span><span class="ResWord">void</span> <span class="ID">my_sorting_algorithm</span>(<span class="ResWord">int</span>[] <span class="ID">data</span>, <span class="ID">Comparator</span> <span class="ID">compare</span>) {</span>
<span class="line"><span class="anchor" id="line-4-19"></span>    <span class="Comment">// ... 'compare' is called somewhere in here ...</span></span>
<span class="line"><span class="anchor" id="line-5-14"></span><span class="Comment"></span>}</span>
<span class="line"><span class="anchor" id="line-6-12"></span></span>
<span class="line"><span class="anchor" id="line-7-10"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-8-9"></span>    <span class="ResWord">int</span>[] <span class="ID">data</span> = { <span class="Number">3</span>, <span class="Number">9</span>, <span class="Number">2</span>, <span class="Number">7</span>, <span class="Number">5</span> };</span>
<span class="line"><span class="anchor" id="line-9-8"></span>    <span class="Comment">// An anonymous method is passed as the second argument:</span></span>
<span class="line"><span class="anchor" id="line-10-6"></span><span class="Comment"></span>    <span class="ID">my_sorting_algorithm</span>(<span class="ID">data</span>, (<span class="ID">a</span>, <span class="ID">b</span>) =&gt; {</span>
<span class="line"><span class="anchor" id="line-11-5"></span>        <span class="ResWord">if</span> (<span class="ID">a</span> &lt; <span class="ID">b</span>) <span class="ResWord">return</span> -<span class="Number">1</span>;</span>
<span class="line"><span class="anchor" id="line-12-5"></span>        <span class="ResWord">if</span> (<span class="ID">a</span> &gt; <span class="ID">b</span>) <span class="ResWord">return</span> <span class="Number">1</span>;</span>
<span class="line"><span class="anchor" id="line-13-4"></span>        <span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-14-3"></span>    });</span>
<span class="line"><span class="anchor" id="line-15-3"></span>}</span>
</pre></div></div><span class="anchor" id="line-725"></span><span class="anchor" id="line-726"></span><p class="line862">Anonymous methods are real <a class="http" href="http://en.wikipedia.org/wiki/Closure_%28computer_science%29">closures</a>.  This means you can access the local variables of the outer method within the lambda expression: <span class="anchor" id="line-727"></span><span class="anchor" id="line-728"></span></p><p class="line867"><span class="anchor" id="line-729"></span><span class="anchor" id="line-730"></span><span class="anchor" id="line-731"></span><span class="anchor" id="line-732"></span><span class="anchor" id="line-733"></span><span class="anchor" id="line-734"></span><span class="anchor" id="line-735"></span><span class="anchor" id="line-736"></span><span class="anchor" id="line-737"></span><span class="anchor" id="line-738"></span><span class="anchor" id="line-1-102"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-524231956484ff84cd8a3a20f377b279f8d7e956" lang="en"><span class="line"><span class="anchor" id="line-1-103"></span><span class="ID">delegate</span> <span class="ResWord">int</span> <span class="ID">IntOperation</span>(<span class="ResWord">int</span> <span class="ID">i</span>);</span>
<span class="line"><span class="anchor" id="line-2-36"></span></span>
<span class="line"><span class="anchor" id="line-3-27"></span><span class="ID">IntOperation</span> <span class="ID">curried_add</span>(<span class="ResWord">int</span> <span class="ID">a</span>) {</span>
<span class="line"><span class="anchor" id="line-4-20"></span>    <span class="ResWord">return</span> (<span class="ID">b</span>) =&gt; <span class="ID">a</span> + <span class="ID">b</span>;  <span class="Comment">// 'a' is an outer variable</span></span>
<span class="line"><span class="anchor" id="line-5-15"></span><span class="Comment"></span>}</span>
<span class="line"><span class="anchor" id="line-6-13"></span></span>
<span class="line"><span class="anchor" id="line-7-11"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-8-10"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">2 + 4 = %d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">curried_add</span>(<span class="Number">2</span>)(<span class="Number">4</span>));</span>
<span class="line"><span class="anchor" id="line-9-9"></span>}</span>
</pre></div></div><span class="anchor" id="line-739"></span><span class="anchor" id="line-740"></span><p class="line862">In this example <em>curried_add</em> (see <a class="http" href="http://en.wikipedia.org/wiki/Currying">Currying</a>) returns a newly created method that preserves the value of <em>a</em>.  This returned method is directly called afterwards with 4 as argument resulting in the sum of the two numbers. <span class="anchor" id="line-741"></span><span class="anchor" id="line-742"></span></p><p class="line867">
</p><h4 id="Namespaces">Namespaces</h4>
<span class="anchor" id="line-743"></span><span class="anchor" id="line-744"></span><p class="line867"><span class="anchor" id="line-745"></span><span class="anchor" id="line-746"></span><span class="anchor" id="line-747"></span><span class="anchor" id="line-748"></span><span class="anchor" id="line-1-104"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-f79797efca0bf7f49888369595533b1341110bb3" lang="en"><span class="line"><span class="anchor" id="line-1-105"></span><span class="ResWord">namespace</span> <span class="ID">NameSpaceName</span> {</span>
<span class="line"><span class="anchor" id="line-2-37"></span>    <span class="Comment">// ...</span></span>
<span class="line"><span class="anchor" id="line-3-28"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-749"></span><span class="anchor" id="line-750"></span><p class="line862">Everything between the braces in this statement is in the namespace <em>NameSpaceName</em>
 and must be referenced as such.  Any code outside this namespace must 
either use qualified names for anything within the name of the 
namespace, or be in a file with an appropriate <tt class="backtick">using</tt> declaration in order to import this namespace: <span class="anchor" id="line-751"></span><span class="anchor" id="line-752"></span></p><p class="line867"><span class="anchor" id="line-753"></span><span class="anchor" id="line-754"></span><span class="anchor" id="line-755"></span><span class="anchor" id="line-756"></span><span class="anchor" id="line-1-106"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ab016b36381af1b9ab821fc10f06431bc11b2148" lang="en"><span class="line"><span class="anchor" id="line-1-107"></span><span class="ResWord">using</span> <span class="ID">NameSpaceName</span>;</span>
<span class="line"><span class="anchor" id="line-2-38"></span></span>
<span class="line"><span class="anchor" id="line-3-29"></span><span class="Comment">// ...</span></span>
<span class="line"><span class="anchor" id="line-4-21"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-757"></span><span class="anchor" id="line-758"></span><p class="line862">For example, if the namespace <em>Gtk</em> is imported with <tt class="backtick">using&nbsp;Gtk;</tt> you can simply write <em>Window</em> instead of <em>Gtk.Window</em>.  A fully qualified name would only be necessary in case of ambiguity, for example between <em>GLib.Object</em> and <em>Gtk.Object</em>. <span class="anchor" id="line-759"></span><span class="anchor" id="line-760"></span></p><p class="line862">The namespace <em>GLib</em> is imported by default.  Imagine an invisible <tt class="backtick">using&nbsp;GLib;</tt> line at the beginning of every Vala file. <span class="anchor" id="line-761"></span><span class="anchor" id="line-762"></span></p><p class="line862">Everything
 that you don't put into a separate namespace will land in the anonymous
 global namespace.  If you have to reference the global namespace 
explicitly due to ambiguity you can do that with the <tt class="backtick">global::</tt> prefix. <span class="anchor" id="line-763"></span><span class="anchor" id="line-764"></span></p><p class="line862">Namespaces can be nested, either by nesting one declaration inside another, or by giving a name of the form <em>NameSpace1.NameSpace2</em>. <span class="anchor" id="line-765"></span><span class="anchor" id="line-766"></span></p><p class="line862">Several other types of definition can declare themselves to be inside a namespace by following the same naming convention, e.g. <tt class="backtick">class&nbsp;NameSpace1.Test&nbsp;{&nbsp;...&nbsp;}</tt>.
  Note that when doing this, the final namespace of the definition will 
be the one the declaration is nested in plus the namespaces declared in 
the definition. <span class="anchor" id="line-767"></span><span class="anchor" id="line-768"></span></p><p class="line867">
</p><h4 id="Structs">Structs</h4>
<span class="anchor" id="line-769"></span><span class="anchor" id="line-770"></span><p class="line867"><span class="anchor" id="line-771"></span><span class="anchor" id="line-772"></span><span class="anchor" id="line-773"></span><span class="anchor" id="line-774"></span><span class="anchor" id="line-1-108"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b22bd5200864b2cdcbca6b23a07123b76aa2600c" lang="en"><span class="line"><span class="anchor" id="line-1-109"></span><span class="ResWord">struct</span> <span class="ID">StructName</span> {</span>
<span class="line"><span class="anchor" id="line-2-39"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">a</span>;</span>
<span class="line"><span class="anchor" id="line-3-30"></span>}</span>
</pre></div></div><span class="anchor" id="line-775"></span><span class="anchor" id="line-776"></span><p class="line862">defines a <tt class="backtick">struct</tt>
 type, i.e. a compound value type.  A Vala struct may have methods in a 
limited way and also may have private members, meaning the explicit <tt class="backtick">public</tt> access modifier is required. <span class="anchor" id="line-777"></span><span class="anchor" id="line-778"></span></p><p class="line867"><span class="anchor" id="line-779"></span><span class="anchor" id="line-780"></span><span class="anchor" id="line-781"></span><span class="anchor" id="line-782"></span><span class="anchor" id="line-783"></span><span class="anchor" id="line-784"></span><span class="anchor" id="line-1-110"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a3ba1ea684c16049962c1e20766dcf39bae751d5" lang="en"><span class="line"><span class="anchor" id="line-1-111"></span><span class="ResWord">struct</span> <span class="ID">Color</span> {</span>
<span class="line"><span class="anchor" id="line-2-40"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">red</span>;</span>
<span class="line"><span class="anchor" id="line-3-31"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">green</span>;</span>
<span class="line"><span class="anchor" id="line-4-22"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">blue</span>;</span>
<span class="line"><span class="anchor" id="line-5-16"></span>}</span>
</pre></div></div><span class="anchor" id="line-785"></span><span class="anchor" id="line-786"></span><p class="line874">This is how you can initialise a struct: <span class="anchor" id="line-787"></span><span class="anchor" id="line-788"></span></p><p class="line867"><span class="anchor" id="line-789"></span><span class="anchor" id="line-790"></span><span class="anchor" id="line-791"></span><span class="anchor" id="line-792"></span><span class="anchor" id="line-793"></span><span class="anchor" id="line-794"></span><span class="anchor" id="line-795"></span><span class="anchor" id="line-796"></span><span class="anchor" id="line-797"></span><span class="anchor" id="line-798"></span><span class="anchor" id="line-799"></span><span class="anchor" id="line-800"></span><span class="anchor" id="line-801"></span><span class="anchor" id="line-802"></span><span class="anchor" id="line-803"></span><span class="anchor" id="line-804"></span><span class="anchor" id="line-805"></span><span class="anchor" id="line-1-112"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-5c8504e15f47e8f9a82668903622a01c908a3a8a" lang="en"><span class="line"><span class="anchor" id="line-1-113"></span><span class="Comment">// without type inference</span></span>
<span class="line"><span class="anchor" id="line-2-41"></span><span class="Comment"></span><span class="ID">Color</span> <span class="ID">c1</span> = <span class="ID">Color</span>();</span>
<span class="line"><span class="anchor" id="line-3-32"></span><span class="ID">Color</span> <span class="ID">c2</span> = { <span class="Number">0.5</span>, <span class="Number">0.5</span>, <span class="Number">1.0</span> };</span>
<span class="line"><span class="anchor" id="line-4-23"></span><span class="ID">Color</span> <span class="ID">c3</span> = <span class="ID">Color</span>() {</span>
<span class="line"><span class="anchor" id="line-5-17"></span>    <span class="ID">red</span> = <span class="Number">0.5</span>,</span>
<span class="line"><span class="anchor" id="line-6-14"></span>    <span class="ID">green</span> = <span class="Number">0.5</span>,</span>
<span class="line"><span class="anchor" id="line-7-12"></span>    <span class="ID">blue</span> = <span class="Number">1.0</span></span>
<span class="line"><span class="anchor" id="line-8-11"></span>};</span>
<span class="line"><span class="anchor" id="line-9-10"></span></span>
<span class="line"><span class="anchor" id="line-10-7"></span><span class="Comment">// with type inference</span></span>
<span class="line"><span class="anchor" id="line-11-6"></span><span class="Comment"></span><span class="ID">var</span> <span class="ID">c4</span> = <span class="ID">Color</span>();</span>
<span class="line"><span class="anchor" id="line-12-6"></span><span class="ID">var</span> <span class="ID">c5</span> = <span class="ID">Color</span>() {</span>
<span class="line"><span class="anchor" id="line-13-5"></span>    <span class="ID">red</span> = <span class="Number">0.5</span>,</span>
<span class="line"><span class="anchor" id="line-14-4"></span>    <span class="ID">green</span> = <span class="Number">0.5</span>,</span>
<span class="line"><span class="anchor" id="line-15-4"></span>    <span class="ID">blue</span> = <span class="Number">1.0</span></span>
<span class="line"><span class="anchor" id="line-16-2"></span>};</span>
</pre></div></div><span class="anchor" id="line-806"></span><span class="anchor" id="line-807"></span><p class="line874">Structs are stack/inline allocated and copied on assignment. <span class="anchor" id="line-808"></span><span class="anchor" id="line-809"></span></p><p class="line862">To define an array of structs, please see the <a href="https://wiki.gnome.org/Projects/Vala/FAQ#How_do_I_create_an_array_of_structs.3F">FAQ</a>. <span class="anchor" id="line-810"></span><span class="anchor" id="line-811"></span></p><p class="line867">
</p><h4 id="Classes">Classes</h4>
<span class="anchor" id="line-812"></span><span class="anchor" id="line-813"></span><p class="line867"><span class="anchor" id="line-814"></span><span class="anchor" id="line-815"></span><span class="anchor" id="line-816"></span><span class="anchor" id="line-1-114"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-cf25d4f2c4ace8b8803d778dda994b97022e8406" lang="en"><span class="line"><span class="anchor" id="line-1-115"></span><span class="ResWord">class</span> <span class="ID">ClassName</span> : <span class="ID">SuperClassName</span>, <span class="ID">InterfaceName</span> {</span>
<span class="line"><span class="anchor" id="line-2-42"></span>}</span>
</pre></div></div><span class="anchor" id="line-817"></span><span class="anchor" id="line-818"></span><p class="line874">defines
 a class, i.e. a reference type.  In contrast to structs, instances of 
classes are heap allocated.  There is much more syntax related to 
classes, which is discussed more fully in the section about object 
oriented programming. <span class="anchor" id="line-819"></span><span class="anchor" id="line-820"></span></p><p class="line867">
</p><h4 id="Interfaces">Interfaces</h4>
<span class="anchor" id="line-821"></span><span class="anchor" id="line-822"></span><p class="line867"><span class="anchor" id="line-823"></span><span class="anchor" id="line-824"></span><span class="anchor" id="line-825"></span><span class="anchor" id="line-1-116"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-93c28dbb4a2de6f8456db44f986b9f47c02efe49" lang="en"><span class="line"><span class="anchor" id="line-1-117"></span><span class="ID">interface</span> <span class="ID">InterfaceName</span> : <span class="ID">SuperInterfaceName</span> {</span>
<span class="line"><span class="anchor" id="line-2-43"></span>}</span>
</pre></div></div><span class="anchor" id="line-826"></span><span class="anchor" id="line-827"></span><p class="line862">defines
 an interface, i.e. a non instantiable type.  In order to create an 
instance of an interface you must first implement its abstract methods 
in a non-abstract class.  Vala interfaces are more powerful than Java or
 C# interfaces.  In fact, they can be used as <a class="http" href="http://en.wikipedia.org/wiki/Mixin">mixins</a>.  The details of interfaces are described in the section about object oriented programming. <span class="anchor" id="line-828"></span><span class="anchor" id="line-829"></span></p><p class="line867">
</p><h3 id="Code_Attributes">Code Attributes</h3>
<span class="anchor" id="line-830"></span><span class="anchor" id="line-831"></span><p class="line862">Code
 attributes instruct the Vala compiler details about how the code is 
supposed to work on the target platform.  Their syntax is <tt class="backtick">[AttributeName]</tt> or <tt class="backtick">[AttributeName(param1&nbsp;=&nbsp;value1,&nbsp;param2&nbsp;=&nbsp;value2,&nbsp;...)]</tt>. <span class="anchor" id="line-832"></span><span class="anchor" id="line-833"></span></p><p class="line862">They are mostly used for bindings in <em>vapi</em> files, <tt class="backtick">[CCode(...)]</tt> being the most prominent attribute here.  Another example is the <tt class="backtick">[DBus(...)]</tt> attribute for exporting remote interfaces via <a class="http" href="http://www.freedesktop.org/wiki/Software/dbus">D-Bus</a>. <span class="anchor" id="line-834"></span><span class="anchor" id="line-835"></span></p><p class="line867">
</p><h2 id="Object_Oriented_Programming">Object Oriented Programming</h2>
<span class="anchor" id="line-836"></span><span class="anchor" id="line-837"></span><p class="line874">Although
 Vala doesn't force you to work with objects, some features are not 
available any other way.  As such, you will certainly want to program in
 an object-oriented style most of the time.  As with most current 
languages, in order to define your own object types, you write a class 
definition. <span class="anchor" id="line-838"></span><span class="anchor" id="line-839"></span></p><p class="line874">A
 class definition states what data each object of its type has, what 
other object types it can hold references to, and what methods can be 
executed on it.  The definition can include a name of another class 
which the new one should be a subclass of.  An instance of a class is 
also an instance of all it's class's super classes, as it inherits from 
them all their methods and data, although it may not be able to access 
all of this itself.  A class may also implement any number of 
interfaces, which are sets of method definitions that must be 
implemented by the class - an instance of a class is also an instance of
 each interface implemented by its class or super classes. <span class="anchor" id="line-840"></span><span class="anchor" id="line-841"></span></p><p class="line874">Classes
 in Vala may also have "static" members.  This modifier allows either 
data or methods to be defined as belonging to the class as a whole, 
rather than to a specific instance of it.  Such members can be accessed 
without possessing an instance of the class. <span class="anchor" id="line-842"></span><span class="anchor" id="line-843"></span></p><p class="line867">
</p><h3 id="Basics-1">Basics</h3>
<span class="anchor" id="line-844"></span><span class="anchor" id="line-845"></span><p class="line874">A simple class may be defined as follows: <span class="anchor" id="line-846"></span><span class="anchor" id="line-847"></span></p><p class="line867"><span class="anchor" id="line-848"></span><span class="anchor" id="line-849"></span><span class="anchor" id="line-850"></span><span class="anchor" id="line-851"></span><span class="anchor" id="line-852"></span><span class="anchor" id="line-853"></span><span class="anchor" id="line-854"></span><span class="anchor" id="line-855"></span><span class="anchor" id="line-856"></span><span class="anchor" id="line-857"></span><span class="anchor" id="line-858"></span><span class="anchor" id="line-859"></span><span class="anchor" id="line-860"></span><span class="anchor" id="line-861"></span><span class="anchor" id="line-862"></span><span class="anchor" id="line-863"></span><span class="anchor" id="line-864"></span><span class="anchor" id="line-865"></span><span class="anchor" id="line-1-118"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-6fc93cf368105008d42dd36cdd8275d138a37845" lang="en"><span class="line"><span class="anchor" id="line-1-119"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">TestClass</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-44"></span></span>
<span class="line"><span class="anchor" id="line-3-33"></span>    <span class="Comment">/* Fields */</span></span>
<span class="line"><span class="anchor" id="line-4-24"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">first_data</span> = <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-5-18"></span>    <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">second_data</span>;</span>
<span class="line"><span class="anchor" id="line-6-15"></span></span>
<span class="line"><span class="anchor" id="line-7-13"></span>    <span class="Comment">/* Constructor */</span></span>
<span class="line"><span class="anchor" id="line-8-12"></span>    <span class="ResWord">public</span> <span class="ID">TestClass</span>() {</span>
<span class="line"><span class="anchor" id="line-9-11"></span>        <span class="ResWord">this</span>.<span class="ID">second_data</span> = <span class="Number">5</span>;</span>
<span class="line"><span class="anchor" id="line-10-8"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-7"></span></span>
<span class="line"><span class="anchor" id="line-12-7"></span>    <span class="Comment">/* Method */</span></span>
<span class="line"><span class="anchor" id="line-13-6"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">method_1</span>() {</span>
<span class="line"><span class="anchor" id="line-14-5"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">private data: %d</span><span class="String">"</span>, <span class="ResWord">this</span>.<span class="ID">second_data</span>);</span>
<span class="line"><span class="anchor" id="line-15-5"></span>        <span class="ResWord">return</span> <span class="ResWord">this</span>.<span class="ID">second_data</span>;</span>
<span class="line"><span class="anchor" id="line-16-3"></span>    }</span>
<span class="line"><span class="anchor" id="line-17-2"></span>}</span>
</pre></div></div><span class="anchor" id="line-866"></span><span class="anchor" id="line-867"></span><p class="line862">This code will define a new type (which is registered automatically with the <em>gobject</em>
 library's type system) that contains three members.  There are two data
 members, the integers defined at the top, and one method called <em>method_1</em>, which returns an integer.  The class declaration states that this class is a subclass of <em>GLib.Object</em>, and therefore instances of it are also <em>Objects</em>, and contain all the members of that type also.  The fact that this class is descended from <em>Object</em> also means that there are special features of Vala that can be used to easily access some of <em>Object's</em> features. <span class="anchor" id="line-868"></span><span class="anchor" id="line-869"></span></p><p class="line862">This class is described as <tt class="backtick">public</tt> (by default, classes are <tt class="backtick">internal</tt>).
  The implication of this is that it can referenced directly by code 
outside of this file - if you are a C programmer of glib/gobject, you 
will recognise this as being equivalent to defining the class interfaces
 in a header file that other code can include. <span class="anchor" id="line-870"></span><span class="anchor" id="line-871"></span></p><p class="line862">The members are also all described as either <tt class="backtick">public</tt> or <tt class="backtick">private</tt>.  The member <em>first_data</em> is <tt class="backtick">public</tt>,
 so it is visible directly to any user of the class, and can be modified
 without the containing instance being aware of it.  The second data 
member is <tt class="backtick">private</tt>, and so can only be referenced by code belonging to this class.  Vala supports four different access modifiers: <span class="anchor" id="line-872"></span><span class="anchor" id="line-873"></span></p><div><table><tbody><tr>  <td><p class="line891"><tt class="backtick">public</tt></p></td>
  <td><p class="line862">No restrictions to access</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-874"></span><p class="line891"><tt class="backtick">private</tt></p></td>
  <td><p class="line862">Access is limited to within the class/struct definition. This is the default if no access modifier is specified</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-875"></span><p class="line891"><tt class="backtick">protected</tt></p></td>
  <td><p class="line862">Access is limited to within the class definition and any class that inherits from the class</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-876"></span><p class="line891"><tt class="backtick">internal</tt></p></td>
  <td><p class="line862">Access is limited exclusively to classes defined within the same package</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-877"></span><span class="anchor" id="line-878"></span><p class="line874">The
 constructor initialises new instances of a class.  It has the same name
 as the class, may take zero or more arguments and is defined without 
return type. <span class="anchor" id="line-879"></span><span class="anchor" id="line-880"></span></p><p class="line862">The final part of this class is a method definition.  This method is to be called <em>method_1</em>,
 and it will return an integer.  As this method is not static, it can 
only be executed on an instance of this class, and may therefore access 
members of that instance.  It can do this through the <tt class="backtick">this</tt> reference, which always points to the instance the method is being called on.  Unless there is an ambiguity, the <tt class="backtick">this</tt> identifier can be omitted if wished. <span class="anchor" id="line-881"></span><span class="anchor" id="line-882"></span></p><p class="line874">You can use this new class as follows: <span class="anchor" id="line-883"></span><span class="anchor" id="line-884"></span></p><p class="line867"><span class="anchor" id="line-885"></span><span class="anchor" id="line-886"></span><span class="anchor" id="line-887"></span><span class="anchor" id="line-888"></span><span class="anchor" id="line-1-120"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1fdca6347a1556c0b9115f5ae0ae502de33ee06d" lang="en"><span class="line"><span class="anchor" id="line-1-121"></span><span class="ID">TestClass</span> <span class="ID">t</span> = <span class="ResWord">new</span> <span class="ID">TestClass</span>();</span>
<span class="line"><span class="anchor" id="line-2-45"></span><span class="ID">t</span>.<span class="ID">first_data</span> = <span class="Number">5</span>;</span>
<span class="line"><span class="anchor" id="line-3-34"></span><span class="ID">t</span>.<span class="ID">method_1</span>();</span>
</pre></div></div><span class="anchor" id="line-889"></span><span class="anchor" id="line-890"></span><p class="line867">
</p><h3 id="Construction">Construction</h3>
<span class="anchor" id="line-891"></span><span class="anchor" id="line-892"></span><p class="line874">Vala
 supports two slightly different construction schemes: the Java/C#-style
 construction scheme which we will focus on for now, and the 
GObject-style construction scheme which will be described in a section 
at the end of the chapter. <span class="anchor" id="line-893"></span><span class="anchor" id="line-894"></span></p><p class="line862">Vala
 does not support constructor overloading for the same reasons that 
method overloading is not allowed, which means a class may not have 
multiple constructors with the same name.  However, this is no problem 
because Vala supports <em>named constructors</em>.  If you want to offer multiple constructors you may give them different name additions: <span class="anchor" id="line-895"></span><span class="anchor" id="line-896"></span></p><p class="line867"><span class="anchor" id="line-897"></span><span class="anchor" id="line-898"></span><span class="anchor" id="line-899"></span><span class="anchor" id="line-900"></span><span class="anchor" id="line-901"></span><span class="anchor" id="line-902"></span><span class="anchor" id="line-903"></span><span class="anchor" id="line-904"></span><span class="anchor" id="line-905"></span><span class="anchor" id="line-906"></span><span class="anchor" id="line-907"></span><span class="anchor" id="line-908"></span><span class="anchor" id="line-1-122"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-55a5315cd0503c937b6e040b7b81899ab680d98a" lang="en"><span class="line"><span class="anchor" id="line-1-123"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Button</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-46"></span></span>
<span class="line"><span class="anchor" id="line-3-35"></span>    <span class="ResWord">public</span> <span class="ID">Button</span>() {</span>
<span class="line"><span class="anchor" id="line-4-25"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-19"></span></span>
<span class="line"><span class="anchor" id="line-6-16"></span>    <span class="ResWord">public</span> <span class="ID">Button</span>.<span class="ID">with_label</span>(<span class="ID">string</span> <span class="ID">label</span>) {</span>
<span class="line"><span class="anchor" id="line-7-14"></span>    }</span>
<span class="line"><span class="anchor" id="line-8-13"></span></span>
<span class="line"><span class="anchor" id="line-9-12"></span>    <span class="ResWord">public</span> <span class="ID">Button</span>.<span class="ID">from_stock</span>(<span class="ID">string</span> <span class="ID">stock_id</span>) {</span>
<span class="line"><span class="anchor" id="line-10-9"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-8"></span>}</span>
</pre></div></div><span class="anchor" id="line-909"></span><span class="anchor" id="line-910"></span><p class="line874">Instantiation is analogous: <span class="anchor" id="line-911"></span><span class="anchor" id="line-912"></span></p><p class="line867"><span class="anchor" id="line-913"></span><span class="anchor" id="line-914"></span><span class="anchor" id="line-915"></span><span class="anchor" id="line-916"></span><span class="anchor" id="line-1-124"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-e19f785a166f6e8ddbd225d866e3b2fef29bab8e" lang="en"><span class="line"><span class="anchor" id="line-1-125"></span><span class="ResWord">new</span> <span class="ID">Button</span>();</span>
<span class="line"><span class="anchor" id="line-2-47"></span><span class="ResWord">new</span> <span class="ID">Button</span>.<span class="ID">with_label</span>(<span class="String">"</span><span class="String">Click me</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-36"></span><span class="ResWord">new</span> <span class="ID">Button</span>.<span class="ID">from_stock</span>(<span class="ID">Gtk</span>.<span class="ID">STOCK_OK</span>);</span>
</pre></div></div><span class="anchor" id="line-917"></span><span class="anchor" id="line-918"></span><p class="line862">You may chain constructors via <tt class="backtick">this()</tt> or <tt class="backtick">this.</tt><em>name_extension</em><tt class="backtick">()</tt>: <span class="anchor" id="line-919"></span><span class="anchor" id="line-920"></span></p><p class="line867"><span class="anchor" id="line-921"></span><span class="anchor" id="line-922"></span><span class="anchor" id="line-923"></span><span class="anchor" id="line-924"></span><span class="anchor" id="line-925"></span><span class="anchor" id="line-926"></span><span class="anchor" id="line-927"></span><span class="anchor" id="line-928"></span><span class="anchor" id="line-929"></span><span class="anchor" id="line-930"></span><span class="anchor" id="line-931"></span><span class="anchor" id="line-932"></span><span class="anchor" id="line-933"></span><span class="anchor" id="line-934"></span><span class="anchor" id="line-935"></span><span class="anchor" id="line-936"></span><span class="anchor" id="line-937"></span><span class="anchor" id="line-938"></span><span class="anchor" id="line-939"></span><span class="anchor" id="line-940"></span><span class="anchor" id="line-941"></span><span class="anchor" id="line-942"></span><span class="anchor" id="line-943"></span><span class="anchor" id="line-1-126"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c1950ea9a5ce8e9b8b8a09316bfdc5e4deddc8fb" lang="en"><span class="line"><span class="anchor" id="line-1-127"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Point</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-48"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">x</span>;</span>
<span class="line"><span class="anchor" id="line-3-37"></span>    <span class="ResWord">public</span> <span class="ResWord">double</span> <span class="ID">y</span>;</span>
<span class="line"><span class="anchor" id="line-4-26"></span></span>
<span class="line"><span class="anchor" id="line-5-20"></span>    <span class="ResWord">public</span> <span class="ID">Point</span>(<span class="ResWord">double</span> <span class="ID">x</span>, <span class="ResWord">double</span> <span class="ID">y</span>) {</span>
<span class="line"><span class="anchor" id="line-6-17"></span>        <span class="ResWord">this</span>.<span class="ID">x</span> = <span class="ID">x</span>;</span>
<span class="line"><span class="anchor" id="line-7-15"></span>        <span class="ResWord">this</span>.<span class="ID">y</span> = <span class="ID">y</span>;</span>
<span class="line"><span class="anchor" id="line-8-14"></span>    }</span>
<span class="line"><span class="anchor" id="line-9-13"></span></span>
<span class="line"><span class="anchor" id="line-10-10"></span>    <span class="ResWord">public</span> <span class="ID">Point</span>.<span class="ID">rectangular</span>(<span class="ResWord">double</span> <span class="ID">x</span>, <span class="ResWord">double</span> <span class="ID">y</span>) {</span>
<span class="line"><span class="anchor" id="line-11-9"></span>        <span class="ResWord">this</span>(<span class="ID">x</span>, <span class="ID">y</span>);</span>
<span class="line"><span class="anchor" id="line-12-8"></span>    }</span>
<span class="line"><span class="anchor" id="line-13-7"></span></span>
<span class="line"><span class="anchor" id="line-14-6"></span>    <span class="ResWord">public</span> <span class="ID">Point</span>.<span class="ID">polar</span>(<span class="ResWord">double</span> <span class="ID">radius</span>, <span class="ResWord">double</span> <span class="ID">angle</span>) {</span>
<span class="line"><span class="anchor" id="line-15-6"></span>        <span class="ResWord">this</span>.<span class="ID">rectangular</span>(<span class="ID">radius</span> * <span class="ID">Math</span>.<span class="ID">cos</span>(<span class="ID">angle</span>), <span class="ID">radius</span> * <span class="ID">Math</span>.<span class="ID">sin</span>(<span class="ID">angle</span>));</span>
<span class="line"><span class="anchor" id="line-16-4"></span>    }</span>
<span class="line"><span class="anchor" id="line-17-3"></span>}</span>
<span class="line"><span class="anchor" id="line-18-2"></span></span>
<span class="line"><span class="anchor" id="line-19-1"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-20-1"></span>    <span class="ID">var</span> <span class="ID">p1</span> = <span class="ResWord">new</span> <span class="ID">Point</span>.<span class="ID">rectangular</span>(<span class="Number">5.7</span>, <span class="Number">1.2</span>);</span>
<span class="line"><span class="anchor" id="line-21-1"></span>    <span class="ID">var</span> <span class="ID">p2</span> = <span class="ResWord">new</span> <span class="ID">Point</span>.<span class="ID">polar</span>(<span class="Number">5.7</span>, <span class="Number">1.2</span>);</span>
<span class="line"><span class="anchor" id="line-22-1"></span>}</span>
</pre></div></div><span class="anchor" id="line-944"></span><span class="anchor" id="line-945"></span><p class="line867">
</p><h3 id="Destruction">Destruction</h3>
<span class="anchor" id="line-946"></span><span class="anchor" id="line-947"></span><p class="line874">Although
 Vala manages the memory for you, you might need to add your own 
destructor if you choose to do manual memory management with pointers 
(more on that later) or if you have to release other resources.  The 
syntax is the same as in C# and C++: <span class="anchor" id="line-948"></span><span class="anchor" id="line-949"></span></p><p class="line867"><span class="anchor" id="line-950"></span><span class="anchor" id="line-951"></span><span class="anchor" id="line-952"></span><span class="anchor" id="line-953"></span><span class="anchor" id="line-954"></span><span class="anchor" id="line-955"></span><span class="anchor" id="line-1-128"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a24ab13d135e2b2d9ef7e751f0d8aeb5f615e434" lang="en"><span class="line"><span class="anchor" id="line-1-129"></span><span class="ResWord">class</span> <span class="ID">Demo</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-49"></span>    ~<span class="ID">Demo</span>() {</span>
<span class="line"><span class="anchor" id="line-3-38"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">in destructor</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-4-27"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-21"></span>}</span>
</pre></div></div><span class="anchor" id="line-956"></span><span class="anchor" id="line-957"></span><p class="line862">Since Vala's memory management is based on <em>reference counting</em> instead of <em>tracing garbage collection</em>, destructors are deterministic and can be used to implement the <a class="http" href="http://en.wikipedia.org/wiki/RAII">RAII</a> pattern for resource management (closing streams, database connections, ...). <span class="anchor" id="line-958"></span><span class="anchor" id="line-959"></span></p><p class="line867">
</p><h3 id="Signals">Signals</h3>
<span class="anchor" id="line-960"></span><span class="anchor" id="line-961"></span><p class="line862">Signals
 are a system provided by the Object class in GLib, and made easily 
accessible by Vala to all descendants of Object.  A signal is 
recognisable to C# programmers as an event, or to Java programmers as an
 alternative way of implementing event listeners.  In short, a signal is
 simply a way of executing an arbitrary number of externally identical 
methods (i.e. ones with the same signature) at approximately the same 
time.  The actual methods of execution are internal to <em>gobject</em>, and not important to Vala programs. <span class="anchor" id="line-962"></span><span class="anchor" id="line-963"></span></p><p class="line862">A
 signal is defined as a member of a class, and appears similar to a 
method with no body.  Signal handlers can then be added to the signal 
using the <tt class="backtick">connect()</tt> method.  In order to dive 
right in at the deep end, the following example also introduces lambda 
expressions, a very useful way to write signal handling code in Vala: <span class="anchor" id="line-964"></span><span class="anchor" id="line-965"></span></p><p class="line867"><span class="anchor" id="line-966"></span><span class="anchor" id="line-967"></span><span class="anchor" id="line-968"></span><span class="anchor" id="line-969"></span><span class="anchor" id="line-970"></span><span class="anchor" id="line-971"></span><span class="anchor" id="line-972"></span><span class="anchor" id="line-973"></span><span class="anchor" id="line-974"></span><span class="anchor" id="line-975"></span><span class="anchor" id="line-976"></span><span class="anchor" id="line-977"></span><span class="anchor" id="line-978"></span><span class="anchor" id="line-979"></span><span class="anchor" id="line-980"></span><span class="anchor" id="line-981"></span><span class="anchor" id="line-982"></span><span class="anchor" id="line-1-130"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-dc31ee4bc3851f310ede6e2bccfcaa95476d3236" lang="en"><span class="line"><span class="anchor" id="line-1-131"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Test</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-50"></span></span>
<span class="line"><span class="anchor" id="line-3-39"></span>    <span class="ResWord">public</span> <span class="ID">signal</span> <span class="ResWord">void</span> <span class="ID">sig_1</span>(<span class="ResWord">int</span> <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-4-28"></span></span>
<span class="line"><span class="anchor" id="line-5-22"></span>    <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">int</span> <span class="ID">main</span>(<span class="ID">string</span>[] <span class="ID">args</span>) {</span>
<span class="line"><span class="anchor" id="line-6-18"></span>        <span class="ID">Test</span> <span class="ID">t1</span> = <span class="ResWord">new</span> <span class="ID">Test</span>();</span>
<span class="line"><span class="anchor" id="line-7-16"></span></span>
<span class="line"><span class="anchor" id="line-8-15"></span>        <span class="ID">t1</span>.<span class="ID">sig_1</span>.<span class="ID">connect</span>((<span class="ID">t</span>, <span class="ID">a</span>) =&gt; {</span>
<span class="line"><span class="anchor" id="line-9-14"></span>            <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">a</span>);</span>
<span class="line"><span class="anchor" id="line-10-11"></span>        });</span>
<span class="line"><span class="anchor" id="line-11-10"></span></span>
<span class="line"><span class="anchor" id="line-12-9"></span>        <span class="ID">t1</span>.<span class="ID">sig_1</span>(<span class="Number">5</span>);</span>
<span class="line"><span class="anchor" id="line-13-8"></span></span>
<span class="line"><span class="anchor" id="line-14-7"></span>        <span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-15-7"></span>    }</span>
<span class="line"><span class="anchor" id="line-16-5"></span>}</span>
</pre></div></div><span class="anchor" id="line-983"></span><span class="anchor" id="line-984"></span><p class="line874">This
 code introduces a new class called "Test", using familiar syntax.  The 
first member of this class is a signal, called "sig_1", which is defined
 as passing an integer.  In the main method of this program, we first 
create a Test instance - a requirement since signals always belong to 
instances of classes.  Next, we assign to our instance's "sig_1" signal a
 handler, which we define inline as a lambda expression.  The definition
 states that the method will receive two arguments which we call "t" and
 "a", but do not provide types for.  We can be this terse because Vala 
already knows the definition of the signal and can therefore understand 
what types are required. <span class="anchor" id="line-985"></span><span class="anchor" id="line-986"></span></p><p class="line874">The
 reason there are two parameters to the handler is that whenever a 
signal is emitted, the object on which it is emitted is passed as the 
first argument to the handler.  The second argument is that one that the
 signal says it will provide. <span class="anchor" id="line-987"></span><span class="anchor" id="line-988"></span></p><p class="line874">Finally,
 we get impatient and decide to emit a signal.  We do this by calling 
the signal as though it was a method of our class, and allow gobject to 
take care of forwarding the message to all attached handlers.  
Understanding the mechanism used for this is not required to use signals
 from Vala. <span class="anchor" id="line-989"></span><span class="anchor" id="line-990"></span></p><p class="line862">NB: Currently the <tt class="backtick">public</tt> access modifier is the only possible option - all signals can be both connected to and emitted by any piece of code. <span class="anchor" id="line-991"></span><span class="anchor" id="line-992"></span></p><p class="line874">Note: Since April 2010 signals can be annotated with any combination of flags: <span class="anchor" id="line-993"></span><span class="anchor" id="line-994"></span><span class="anchor" id="line-995"></span><span class="anchor" id="line-996"></span><span class="anchor" id="line-1-132"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-3a19e4cf14718b28203224319e48e1b850c42a87" lang="en"><span class="line"><span class="anchor" id="line-1-133"></span>    [<span class="ID">Signal</span> (<span class="ID">action</span>=<span class="ConsWord">true</span>, <span class="ID">detailed</span>=<span class="ConsWord">true</span>, <span class="ID">run</span>=<span class="ConsWord">true</span>, <span class="ID">no_recurse</span>=<span class="ConsWord">true</span>, <span class="ID">no_hooks</span>=<span class="ConsWord">true</span>)]</span>
<span class="line"><span class="anchor" id="line-2-51"></span>    <span class="ResWord">public</span> <span class="ID">signal</span> <span class="ResWord">void</span> <span class="ID">sig_1</span> ();</span>
</pre></div></div><span class="anchor" id="line-997"></span><span class="anchor" id="line-998"></span><p class="line867">
</p><h3 id="Properties">Properties</h3>
<span class="anchor" id="line-999"></span><span class="anchor" id="line-1000"></span><p class="line874">It is good object oriented programming practice to hide implementation details <span class="anchor" id="line-1001"></span>from the users of your classes (<a class="http" href="http://en.wikipedia.org/wiki/Information_hiding">information hiding principle</a>),
 so you can later change the internals without breaking the public API. 
 One practice is to make fields private and provide accessor methods for
 getting and setting their values (getters and setters). <span class="anchor" id="line-1002"></span><span class="anchor" id="line-1003"></span></p><p class="line874">If you're a Java programmer you will probably think of something like this: <span class="anchor" id="line-1004"></span><span class="anchor" id="line-1005"></span></p><p class="line867"><span class="anchor" id="line-1006"></span><span class="anchor" id="line-1007"></span><span class="anchor" id="line-1008"></span><span class="anchor" id="line-1009"></span><span class="anchor" id="line-1010"></span><span class="anchor" id="line-1011"></span><span class="anchor" id="line-1012"></span><span class="anchor" id="line-1013"></span><span class="anchor" id="line-1014"></span><span class="anchor" id="line-1015"></span><span class="anchor" id="line-1016"></span><span class="anchor" id="line-1017"></span><span class="anchor" id="line-1-134"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ff6e87b2338f411e52741b665251febe62c1638f" lang="en"><span class="line"><span class="anchor" id="line-1-135"></span><span class="ResWord">class</span> <span class="ID">Person</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-52"></span>    <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">age</span> = <span class="Number">32</span>;</span>
<span class="line"><span class="anchor" id="line-3-40"></span></span>
<span class="line"><span class="anchor" id="line-4-29"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">get_age</span>() {</span>
<span class="line"><span class="anchor" id="line-5-23"></span>        <span class="ResWord">return</span> <span class="ResWord">this</span>.<span class="ID">age</span>;</span>
<span class="line"><span class="anchor" id="line-6-19"></span>    }</span>
<span class="line"><span class="anchor" id="line-7-17"></span></span>
<span class="line"><span class="anchor" id="line-8-16"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">set_age</span>(<span class="ResWord">int</span> <span class="ID">age</span>) {</span>
<span class="line"><span class="anchor" id="line-9-15"></span>        <span class="ResWord">this</span>.<span class="ID">age</span> = <span class="ID">age</span>;</span>
<span class="line"><span class="anchor" id="line-10-12"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-11"></span>}</span>
</pre></div></div><span class="anchor" id="line-1018"></span><span class="anchor" id="line-1019"></span><p class="line874">This
 works, but Vala can do better.  The problem is that these methods are 
cumbersome to work with.  Let's suppose that you want to increase the 
age of a person by one year: <span class="anchor" id="line-1020"></span><span class="anchor" id="line-1021"></span></p><p class="line867"><span class="anchor" id="line-1022"></span><span class="anchor" id="line-1023"></span><span class="anchor" id="line-1024"></span><span class="anchor" id="line-1-136"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-523731ce53e85fb619877bfa4b4edfd7ee3de48e" lang="en"><span class="line"><span class="anchor" id="line-1-137"></span><span class="ID">var</span> <span class="ID">alice</span> = <span class="ResWord">new</span> <span class="ID">Person</span>();</span>
<span class="line"><span class="anchor" id="line-2-53"></span><span class="ID">alice</span>.<span class="ID">set_age</span>(<span class="ID">alice</span>.<span class="ID">get_age</span>() + <span class="Number">1</span>);</span>
</pre></div></div><span class="anchor" id="line-1025"></span><span class="anchor" id="line-1026"></span><p class="line874">This is where properties come into play: <span class="anchor" id="line-1027"></span><span class="anchor" id="line-1028"></span></p><p class="line867"><span class="anchor" id="line-1029"></span><span class="anchor" id="line-1030"></span><span class="anchor" id="line-1031"></span><span class="anchor" id="line-1032"></span><span class="anchor" id="line-1033"></span><span class="anchor" id="line-1034"></span><span class="anchor" id="line-1035"></span><span class="anchor" id="line-1036"></span><span class="anchor" id="line-1037"></span><span class="anchor" id="line-1038"></span><span class="anchor" id="line-1-138"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-5fed98a174449708eba58290dc8aa483d8618c37" lang="en"><span class="line"><span class="anchor" id="line-1-139"></span><span class="ResWord">class</span> <span class="ID">Person</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-54"></span>    <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">_age</span> = <span class="Number">32</span>;  <span class="Comment">// underscore prefix to avoid name clash with property</span></span>
<span class="line"><span class="anchor" id="line-3-41"></span><span class="Comment"></span></span>
<span class="line"><span class="anchor" id="line-4-30"></span>    <span class="Comment">/* Property */</span></span>
<span class="line"><span class="anchor" id="line-5-24"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">age</span> {</span>
<span class="line"><span class="anchor" id="line-6-20"></span>        <span class="ID">get</span> { <span class="ResWord">return</span> <span class="ID">_age</span>; }</span>
<span class="line"><span class="anchor" id="line-7-18"></span>        <span class="ID">set</span> { <span class="ID">_age</span> = <span class="ID">value</span>; }</span>
<span class="line"><span class="anchor" id="line-8-17"></span>    }</span>
<span class="line"><span class="anchor" id="line-9-16"></span>}</span>
</pre></div></div><span class="anchor" id="line-1039"></span><span class="anchor" id="line-1040"></span><p class="line862">This syntax should be familiar to C# programmers. A property has a <tt class="backtick">get</tt> and a <tt class="backtick">set</tt> block for getting and setting its value. <tt class="backtick">value</tt> is a keyword that represents the new value that should be assigned to the property. <span class="anchor" id="line-1041"></span><span class="anchor" id="line-1042"></span></p><p class="line874">Now
 you can access the property as if it was a public field. But behind the
 scenes the code in the get and set blocks is executed. <span class="anchor" id="line-1043"></span><span class="anchor" id="line-1044"></span></p><p class="line867"><span class="anchor" id="line-1045"></span><span class="anchor" id="line-1046"></span><span class="anchor" id="line-1047"></span><span class="anchor" id="line-1048"></span><span class="anchor" id="line-1-140"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ed8f3912cddf6559ec458be04aee8e9ddd9735f5" lang="en"><span class="line"><span class="anchor" id="line-1-141"></span><span class="ID">var</span> <span class="ID">alice</span> = <span class="ResWord">new</span> <span class="ID">Person</span>();</span>
<span class="line"><span class="anchor" id="line-2-55"></span><span class="ID">alice</span>.<span class="ID">age</span> = <span class="ID">alice</span>.<span class="ID">age</span> + <span class="Number">1</span>;  <span class="Comment">// or even shorter:</span></span>
<span class="line"><span class="anchor" id="line-3-42"></span><span class="Comment"></span><span class="ID">alice</span>.<span class="ID">age</span>++;</span>
</pre></div></div><span class="anchor" id="line-1049"></span><span class="anchor" id="line-1050"></span><p class="line874">If you only do the standard implementation as shown above then you can write the property even shorter: <span class="anchor" id="line-1051"></span><span class="anchor" id="line-1052"></span></p><p class="line867"><span class="anchor" id="line-1053"></span><span class="anchor" id="line-1054"></span><span class="anchor" id="line-1055"></span><span class="anchor" id="line-1056"></span><span class="anchor" id="line-1057"></span><span class="anchor" id="line-1-142"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d9fd25b1c5db73c1583e0f53f2ac1caa52162f80" lang="en"><span class="line"><span class="anchor" id="line-1-143"></span><span class="ResWord">class</span> <span class="ID">Person</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-56"></span>    <span class="Comment">/* Property with standard getter and setter and default value */</span></span>
<span class="line"><span class="anchor" id="line-3-43"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">age</span> { <span class="ID">get</span>; <span class="ID">set</span>; <span class="ResWord">default</span> = <span class="Number">32</span>; }</span>
<span class="line"><span class="anchor" id="line-4-31"></span>}</span>
</pre></div></div><span class="anchor" id="line-1058"></span><span class="anchor" id="line-1059"></span><p class="line874">With properties you can change the internal working of classes without changing the public API.  For example: <span class="anchor" id="line-1060"></span><span class="anchor" id="line-1061"></span></p><p class="line867"><span class="anchor" id="line-1062"></span><span class="anchor" id="line-1063"></span><span class="anchor" id="line-1064"></span><span class="anchor" id="line-1065"></span><span class="anchor" id="line-1066"></span><span class="anchor" id="line-1067"></span><span class="anchor" id="line-1068"></span><span class="anchor" id="line-1069"></span><span class="anchor" id="line-1070"></span><span class="anchor" id="line-1071"></span><span class="anchor" id="line-1072"></span><span class="anchor" id="line-1-144"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-81c55e75481b2c0d843064fe543b50d48c611e2a" lang="en"><span class="line"><span class="anchor" id="line-1-145"></span><span class="ResWord">static</span> <span class="ResWord">int</span> <span class="ID">current_year</span> = <span class="Number">2525</span>;</span>
<span class="line"><span class="anchor" id="line-2-57"></span></span>
<span class="line"><span class="anchor" id="line-3-44"></span><span class="ResWord">class</span> <span class="ID">Person</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-4-32"></span>    <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">year_of_birth</span> = <span class="Number">2493</span>;</span>
<span class="line"><span class="anchor" id="line-5-25"></span></span>
<span class="line"><span class="anchor" id="line-6-21"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">age</span> {</span>
<span class="line"><span class="anchor" id="line-7-19"></span>        <span class="ID">get</span> { <span class="ResWord">return</span> <span class="ID">current_year</span> - <span class="ID">year_of_birth</span>; }</span>
<span class="line"><span class="anchor" id="line-8-18"></span>        <span class="ID">set</span> { <span class="ID">year_of_birth</span> = <span class="ID">current_year</span> - <span class="ID">value</span>; }</span>
<span class="line"><span class="anchor" id="line-9-17"></span>    }</span>
<span class="line"><span class="anchor" id="line-10-13"></span>}</span>
</pre></div></div><span class="anchor" id="line-1073"></span><span class="anchor" id="line-1074"></span><p class="line874">This
 time the age is calculated on the fly from the year of birth.  Note 
that you can do more than just simple variable access or assignment 
within the get and set blocks.  You could do a database access, logging,
 cache updates, etc. <span class="anchor" id="line-1075"></span><span class="anchor" id="line-1076"></span></p><p class="line874">If you want to make a property read-only for the users of the class you should make the setter private: <span class="anchor" id="line-1077"></span><span class="anchor" id="line-1078"></span></p><p class="line867"><span class="anchor" id="line-1079"></span><span class="anchor" id="line-1080"></span><span class="anchor" id="line-1-146"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-462c4220af67b553eee43ace01a3744bc99c54d5" lang="en"><span class="line"><span class="anchor" id="line-1-147"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">age</span> { <span class="ID">get</span>; <span class="ResWord">private</span> <span class="ID">set</span>; <span class="ResWord">default</span> = <span class="Number">32</span>; }</span>
</pre></div></div><span class="anchor" id="line-1081"></span><span class="anchor" id="line-1082"></span><p class="line874">Or, alternatively, you can leave out the set block: <span class="anchor" id="line-1083"></span><span class="anchor" id="line-1084"></span></p><p class="line867"><span class="anchor" id="line-1085"></span><span class="anchor" id="line-1086"></span><span class="anchor" id="line-1087"></span><span class="anchor" id="line-1088"></span><span class="anchor" id="line-1089"></span><span class="anchor" id="line-1090"></span><span class="anchor" id="line-1091"></span><span class="anchor" id="line-1092"></span><span class="anchor" id="line-1-148"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-db0ea08064dbc632a2acaea73cec02c08daad133" lang="en"><span class="line"><span class="anchor" id="line-1-149"></span><span class="ResWord">class</span> <span class="ID">Person</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-58"></span>    <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">_age</span> = <span class="Number">32</span>;</span>
<span class="line"><span class="anchor" id="line-3-45"></span></span>
<span class="line"><span class="anchor" id="line-4-33"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">age</span> {</span>
<span class="line"><span class="anchor" id="line-5-26"></span>        <span class="ID">get</span> { <span class="ResWord">return</span> <span class="ID">_age</span>; }</span>
<span class="line"><span class="anchor" id="line-6-22"></span>    }</span>
<span class="line"><span class="anchor" id="line-7-20"></span>}</span>
</pre></div></div><span class="anchor" id="line-1093"></span><span class="anchor" id="line-1094"></span><p class="line862">Properties may not only have a name but also a short description (called <em>nick</em>) and a long description (called <em>blurb</em>).  You can annotate <span class="anchor" id="line-1095"></span>these with a special attribute: <span class="anchor" id="line-1096"></span><span class="anchor" id="line-1097"></span></p><p class="line867"><span class="anchor" id="line-1098"></span><span class="anchor" id="line-1099"></span><span class="anchor" id="line-1100"></span><span class="anchor" id="line-1-150"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a62dd5e4dc00d3362e1df39f73f67e247083fb95" lang="en"><span class="line"><span class="anchor" id="line-1-151"></span>    [<span class="ID">Description</span>(<span class="ID">nick</span> = <span class="String">"</span><span class="String">age in years</span><span class="String">"</span>, <span class="ID">blurb</span> = <span class="String">"</span><span class="String">This is the person's age in years</span><span class="String">"</span>)]</span>
<span class="line"><span class="anchor" id="line-2-59"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">age</span> { <span class="ID">get</span>; <span class="ID">set</span>; <span class="ResWord">default</span> = <span class="Number">32</span>; }</span>
</pre></div></div><span class="anchor" id="line-1101"></span><span class="anchor" id="line-1102"></span><p class="line862">Properties and their additional descriptions can be queried at runtime.  Some programs such as the <a class="http" href="http://glade.gnome.org/">Glade</a>
 graphical user interface designer make use of this information.  In 
this way Glade can present human readable descriptions for properties of
 GTK+ widgets. <span class="anchor" id="line-1103"></span><span class="anchor" id="line-1104"></span></p><p class="line862">Every instance of a class derived from <tt class="backtick">GLib.Object</tt> has a signal called <tt class="backtick">notify</tt>.
  This signal gets emitted every time a property of its object changes. 
 So you can connect to this signal if you're interested in change 
notifications in general: <span class="anchor" id="line-1105"></span><span class="anchor" id="line-1106"></span></p><p class="line867"><span class="anchor" id="line-1107"></span><span class="anchor" id="line-1108"></span><span class="anchor" id="line-1109"></span><span class="anchor" id="line-1110"></span><span class="anchor" id="line-1-152"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c8d90d7c84ad3124ff86d1d1a446d14ca0eed788" lang="en"><span class="line"><span class="anchor" id="line-1-153"></span><span class="ID">obj</span>.<span class="ID">notify</span>.<span class="ID">connect</span>((<span class="ID">s</span>, <span class="ID">p</span>) =&gt; {</span>
<span class="line"><span class="anchor" id="line-2-60"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Property '%s' has changed!</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">p</span>.<span class="ID">name</span>);</span>
<span class="line"><span class="anchor" id="line-3-46"></span>});</span>
</pre></div></div><span class="anchor" id="line-1111"></span><span class="anchor" id="line-1112"></span><p class="line867"><tt class="backtick">s</tt> is the source of the signal (<tt class="backtick">obj</tt> in this example), <tt class="backtick">p</tt> is the property information of type <em>ParamSpec</em> for the changed property. If you're only interested in change <span class="anchor" id="line-1113"></span>notifications of a single property you can use this syntax: <span class="anchor" id="line-1114"></span><span class="anchor" id="line-1115"></span></p><p class="line867"><span class="anchor" id="line-1116"></span><span class="anchor" id="line-1117"></span><span class="anchor" id="line-1118"></span><span class="anchor" id="line-1119"></span><span class="anchor" id="line-1-154"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d6bdf08f1fb2bea24c5fee0a408dcafa5f83f950" lang="en"><span class="line"><span class="anchor" id="line-1-155"></span><span class="ID">alice</span>.<span class="ID">notify</span>[<span class="String">"</span><span class="String">age</span><span class="String">"</span>].<span class="ID">connect</span>((<span class="ID">s</span>, <span class="ID">p</span>) =&gt; {</span>
<span class="line"><span class="anchor" id="line-2-61"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">age has changed</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-47"></span>});</span>
</pre></div></div><span class="anchor" id="line-1120"></span><span class="anchor" id="line-1121"></span><p class="line862">Note that in this case you must use the string representation of the property name where underscores are replaced by dashes: <tt class="backtick">my_property_name</tt> becomes <tt class="backtick">"my-property-name"</tt> in this representation, which is the GObject property naming convention. <span class="anchor" id="line-1122"></span><span class="anchor" id="line-1123"></span></p><p class="line862">Change notifications can be disabled with a <tt class="backtick">CCode</tt> attribute tag immediately before the declaration of the property: <span class="anchor" id="line-1124"></span><span class="anchor" id="line-1125"></span></p><p class="line867"><span class="anchor" id="line-1126"></span><span class="anchor" id="line-1127"></span><span class="anchor" id="line-1128"></span><span class="anchor" id="line-1129"></span><span class="anchor" id="line-1130"></span><span class="anchor" id="line-1131"></span><span class="anchor" id="line-1132"></span><span class="anchor" id="line-1133"></span><span class="anchor" id="line-1-156"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ebaef261452f3e9bf2800937ad3b68268af22266" lang="en"><span class="line"><span class="anchor" id="line-1-157"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">MyObject</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-62"></span>    [<span class="ID">CCode</span>(<span class="ID">notify</span> = <span class="ConsWord">false</span>)]</span>
<span class="line"><span class="anchor" id="line-3-48"></span>    <span class="Comment">// notify signal is NOT emitted upon changes in the property</span></span>
<span class="line"><span class="anchor" id="line-4-34"></span><span class="Comment"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">without_notification</span> { <span class="ID">get</span>; <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-5-27"></span>    <span class="Comment">// notify signal is emitted upon changes in the property</span></span>
<span class="line"><span class="anchor" id="line-6-23"></span><span class="Comment"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">with_notification</span> { <span class="ID">get</span>; <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-7-21"></span>}</span>
</pre></div></div><span class="anchor" id="line-1134"></span><span class="anchor" id="line-1135"></span><p class="line862">There's another type of properties called <em>construct properties</em> that are described later in the section about gobject-style construction. <span class="anchor" id="line-1136"></span><span class="anchor" id="line-1137"></span></p><p class="line874">Note:
 in case your property is type of struct, to get the property value with
 Object.get(), you have to declare your variable as example below <span class="anchor" id="line-1138"></span><span class="anchor" id="line-1139"></span><span class="anchor" id="line-1140"></span><span class="anchor" id="line-1141"></span><span class="anchor" id="line-1142"></span><span class="anchor" id="line-1143"></span><span class="anchor" id="line-1144"></span><span class="anchor" id="line-1145"></span><span class="anchor" id="line-1146"></span><span class="anchor" id="line-1147"></span><span class="anchor" id="line-1148"></span><span class="anchor" id="line-1149"></span><span class="anchor" id="line-1150"></span><span class="anchor" id="line-1151"></span><span class="anchor" id="line-1152"></span><span class="anchor" id="line-1153"></span><span class="anchor" id="line-1154"></span><span class="anchor" id="line-1155"></span><span class="anchor" id="line-1156"></span><span class="anchor" id="line-1157"></span><span class="anchor" id="line-1-158"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-dabed0844d22854e7c9ace82147bfaceaf02e5d1" lang="en"><span class="line"><span class="anchor" id="line-1-159"></span><span class="ResWord">struct</span> <span class="ID">Color</span></span>
<span class="line"><span class="anchor" id="line-2-63"></span>{</span>
<span class="line"><span class="anchor" id="line-3-49"></span>    <span class="ResWord">public</span> <span class="ID">uint32</span> <span class="ID">argb</span>;</span>
<span class="line"><span class="anchor" id="line-4-35"></span></span>
<span class="line"><span class="anchor" id="line-5-28"></span>    <span class="ResWord">public</span> <span class="ID">Color</span>() { <span class="ID">argb</span> = <span class="Number">0x12345678</span>; }</span>
<span class="line"><span class="anchor" id="line-6-24"></span>}</span>
<span class="line"><span class="anchor" id="line-7-22"></span></span>
<span class="line"><span class="anchor" id="line-8-19"></span><span class="ResWord">class</span> <span class="ID">Shape</span>: <span class="ID">GLib</span>.<span class="ID">Object</span></span>
<span class="line"><span class="anchor" id="line-9-18"></span>{</span>
<span class="line"><span class="anchor" id="line-10-14"></span>    <span class="ResWord">public</span> <span class="ID">Color</span> <span class="ID">c</span> { <span class="ID">get</span>; <span class="ID">set</span>; <span class="ResWord">default</span> = <span class="ID">Color</span>(); }</span>
<span class="line"><span class="anchor" id="line-11-12"></span>}</span>
<span class="line"><span class="anchor" id="line-12-10"></span></span>
<span class="line"><span class="anchor" id="line-13-9"></span><span class="ResWord">int</span> <span class="ID">main</span>()</span>
<span class="line"><span class="anchor" id="line-14-8"></span>{</span>
<span class="line"><span class="anchor" id="line-15-8"></span>    <span class="ID">Color</span>? <span class="ID">c</span> = <span class="ID">null</span>;</span>
<span class="line"><span class="anchor" id="line-16-6"></span>    <span class="ID">Shape</span> <span class="ID">s</span> = <span class="ResWord">new</span> <span class="ID">Shape</span>();</span>
<span class="line"><span class="anchor" id="line-17-4"></span>    <span class="ID">s</span>.<span class="ID">get</span>(<span class="String">"</span><span class="String">c</span><span class="String">"</span>, <span class="ID">out</span> <span class="ID">c</span>);</span>
<span class="line"><span class="anchor" id="line-18-3"></span>}</span>
</pre></div></div><span class="anchor" id="line-1158"></span><span class="anchor" id="line-1159"></span><p class="line874">This
 way, c is an reference instead of an instance of Color on stack. What 
you passed into s.get() is "Color **" instead of "Color *". <span class="anchor" id="line-1160"></span><span class="anchor" id="line-1161"></span></p><p class="line867">
</p><h3 id="Inheritance">Inheritance</h3>
<span class="anchor" id="line-1162"></span><span class="anchor" id="line-1163"></span><p class="line874">In
 Vala, a class may derive from one or zero other classes.  In practice 
this is always likely to be one, although there is no implicit 
inheritance as there is in languages like Java. <span class="anchor" id="line-1164"></span><span class="anchor" id="line-1165"></span></p><p class="line874">When
 defining a class that inherits from another, you create a relationship 
between the classes where instances of the subclass are also instances 
of the superclass.  This means that operations on instances of the 
superclass are also applicable on instances of the subclass.  As such, 
wherever an instance of the superclass is required, an instance of the 
subclass can be substituted. <span class="anchor" id="line-1166"></span><span class="anchor" id="line-1167"></span></p><p class="line874">When
 writing the definition of a class it is possible to exercise precise 
control over who can access what methods and data in the object.  The 
following example demonstrates a range of these options: <span class="anchor" id="line-1168"></span><span class="anchor" id="line-1169"></span></p><p class="line867"><span class="anchor" id="line-1170"></span><span class="anchor" id="line-1171"></span><span class="anchor" id="line-1172"></span><span class="anchor" id="line-1173"></span><span class="anchor" id="line-1174"></span><span class="anchor" id="line-1175"></span><span class="anchor" id="line-1176"></span><span class="anchor" id="line-1177"></span><span class="anchor" id="line-1178"></span><span class="anchor" id="line-1179"></span><span class="anchor" id="line-1180"></span><span class="anchor" id="line-1181"></span><span class="anchor" id="line-1182"></span><span class="anchor" id="line-1183"></span><span class="anchor" id="line-1184"></span><span class="anchor" id="line-1185"></span><span class="anchor" id="line-1186"></span><span class="anchor" id="line-1187"></span><span class="anchor" id="line-1188"></span><span class="anchor" id="line-1189"></span><span class="anchor" id="line-1190"></span><span class="anchor" id="line-1191"></span><span class="anchor" id="line-1192"></span><span class="anchor" id="line-1-160"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-e8dea449005246fb7c5fa2dc63b9ec039de257cd" lang="en"><span class="line"><span class="anchor" id="line-1-161"></span><span class="ResWord">class</span> <span class="ID">SuperClass</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-64"></span></span>
<span class="line"><span class="anchor" id="line-3-50"></span>    <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">data</span>;</span>
<span class="line"><span class="anchor" id="line-4-36"></span></span>
<span class="line"><span class="anchor" id="line-5-29"></span>    <span class="ResWord">public</span> <span class="ID">SuperClass</span>(<span class="ResWord">int</span> <span class="ID">data</span>) {</span>
<span class="line"><span class="anchor" id="line-6-25"></span>        <span class="ResWord">this</span>.<span class="ID">data</span> = <span class="ID">data</span>;</span>
<span class="line"><span class="anchor" id="line-7-23"></span>    }</span>
<span class="line"><span class="anchor" id="line-8-20"></span></span>
<span class="line"><span class="anchor" id="line-9-19"></span>    <span class="ResWord">protected</span> <span class="ResWord">void</span> <span class="ID">protected_method</span>() {</span>
<span class="line"><span class="anchor" id="line-10-15"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-13"></span></span>
<span class="line"><span class="anchor" id="line-12-11"></span>    <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">void</span> <span class="ID">public_static_method</span>() {</span>
<span class="line"><span class="anchor" id="line-13-10"></span>    }</span>
<span class="line"><span class="anchor" id="line-14-9"></span>}</span>
<span class="line"><span class="anchor" id="line-15-9"></span></span>
<span class="line"><span class="anchor" id="line-16-7"></span><span class="ResWord">class</span> <span class="ID">SubClass</span> : <span class="ID">SuperClass</span> {</span>
<span class="line"><span class="anchor" id="line-17-5"></span></span>
<span class="line"><span class="anchor" id="line-18-4"></span>    <span class="ResWord">public</span> <span class="ID">SubClass</span>() {</span>
<span class="line"><span class="anchor" id="line-19-2"></span>        <span class="ID">base</span>(<span class="Number">10</span>);</span>
<span class="line"><span class="anchor" id="line-20-2"></span>    }</span>
<span class="line"><span class="anchor" id="line-21-2"></span>}</span>
</pre></div></div><span class="anchor" id="line-1193"></span><span class="anchor" id="line-1194"></span><p class="line867"><em>data</em> is an instance data member of <em>SuperClass</em>.  There will be a member of this type in every instance of <em>SuperClass</em>, and it is declared <tt class="backtick">private</tt> so will only be accessible by code that is a part of <em>SuperClass</em>. <span class="anchor" id="line-1195"></span><span class="anchor" id="line-1196"></span></p><p class="line867"><em>protected_method</em> is an instance method of <em>SuperClass</em>.  You will be able to execute this method only an instance of <em>SuperClass</em> or of one of its subclasses, and only from code that belongs to <em>SuperClass</em> or one of its subclasses - this latter rule being the result of the <tt class="backtick">protected</tt> modifier. <span class="anchor" id="line-1197"></span><span class="anchor" id="line-1198"></span></p><p class="line867"><em>public_static_method</em> has two modifiers.  The <tt class="backtick">static</tt> modifier means that this method may be called without owning an instance of <em>SuperClass</em> or of one of its subclasses.  As a result, this method will not have access to a <tt class="backtick">this</tt> reference when it is executed.  The <tt class="backtick">public</tt> modifier means that this method can be called from any code, no matter its relationship with <em>SuperClass</em> or its subclasses. <span class="anchor" id="line-1199"></span><span class="anchor" id="line-1200"></span></p><p class="line862">Given these definitions, an instance of <em>SubClass</em> will contain all three members of <em>SuperClass</em>, but will only be able to access the non-private members.  External code will only be able to access the public method. <span class="anchor" id="line-1201"></span><span class="anchor" id="line-1202"></span></p><p class="line862">With <tt class="backtick">base</tt> a constructor of a subclass can chain up to a constructor of its base class. <span class="anchor" id="line-1203"></span><span class="anchor" id="line-1204"></span></p><p class="line867">
</p><h3 id="Abstract_Classes">Abstract Classes</h3>
<span class="anchor" id="line-1205"></span><span class="anchor" id="line-1206"></span><p class="line862">There is another modifier for methods, called <tt class="backtick">abstract</tt>.
  This modifier allows you to describe a method that is not actually 
implemented in the class.  Instead, it must be implemented by subclasses
 before it can be called.  This allows you to define operations that can
 be called on all instances of a type, whilst ensuring that all more 
specific types provide their own version of the functionality. <span class="anchor" id="line-1207"></span><span class="anchor" id="line-1208"></span></p><p class="line862">A class containing abstract methods must be declared <tt class="backtick">abstract</tt> as well.  The result of this is to prevent any instantiation of the type. <span class="anchor" id="line-1209"></span><span class="anchor" id="line-1210"></span></p><p class="line867"><span class="anchor" id="line-1211"></span><span class="anchor" id="line-1212"></span><span class="anchor" id="line-1213"></span><span class="anchor" id="line-1214"></span><span class="anchor" id="line-1215"></span><span class="anchor" id="line-1216"></span><span class="anchor" id="line-1217"></span><span class="anchor" id="line-1218"></span><span class="anchor" id="line-1219"></span><span class="anchor" id="line-1220"></span><span class="anchor" id="line-1221"></span><span class="anchor" id="line-1222"></span><span class="anchor" id="line-1223"></span><span class="anchor" id="line-1224"></span><span class="anchor" id="line-1225"></span><span class="anchor" id="line-1226"></span><span class="anchor" id="line-1227"></span><span class="anchor" id="line-1228"></span><span class="anchor" id="line-1229"></span><span class="anchor" id="line-1230"></span><span class="anchor" id="line-1231"></span><span class="anchor" id="line-1232"></span><span class="anchor" id="line-1233"></span><span class="anchor" id="line-1-162"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-cf3ae7cb9fc0eda485230fbef2de2f3a6ded1443" lang="en"><span class="line"><span class="anchor" id="line-1-163"></span><span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">class</span> <span class="ID">Animal</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-65"></span></span>
<span class="line"><span class="anchor" id="line-3-51"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">eat</span>() {</span>
<span class="line"><span class="anchor" id="line-4-37"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">*chomp chomp*</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-5-30"></span>    }</span>
<span class="line"><span class="anchor" id="line-6-26"></span></span>
<span class="line"><span class="anchor" id="line-7-24"></span>    <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">void</span> <span class="ID">say_hello</span>();</span>
<span class="line"><span class="anchor" id="line-8-21"></span>}</span>
<span class="line"><span class="anchor" id="line-9-20"></span></span>
<span class="line"><span class="anchor" id="line-10-16"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Tiger</span> : <span class="ID">Animal</span> {</span>
<span class="line"><span class="anchor" id="line-11-14"></span></span>
<span class="line"><span class="anchor" id="line-12-12"></span>    <span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">void</span> <span class="ID">say_hello</span>() {</span>
<span class="line"><span class="anchor" id="line-13-11"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">*roar*</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-14-10"></span>    }</span>
<span class="line"><span class="anchor" id="line-15-10"></span>}</span>
<span class="line"><span class="anchor" id="line-16-8"></span></span>
<span class="line"><span class="anchor" id="line-17-6"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Duck</span> : <span class="ID">Animal</span> {</span>
<span class="line"><span class="anchor" id="line-18-5"></span></span>
<span class="line"><span class="anchor" id="line-19-3"></span>    <span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">void</span> <span class="ID">say_hello</span>() {</span>
<span class="line"><span class="anchor" id="line-20-3"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">*quack*</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-21-3"></span>    }</span>
<span class="line"><span class="anchor" id="line-22-2"></span>}</span>
</pre></div></div><span class="anchor" id="line-1234"></span><span class="anchor" id="line-1235"></span><p class="line862">The implementation of an abstract method must be marked with <tt class="backtick">override</tt>.  Properties may be abstract as well. <span class="anchor" id="line-1236"></span><span class="anchor" id="line-1237"></span></p><p class="line867">
</p><h4 id="Virtual_Methods">Virtual Methods</h4>
<span class="anchor" id="line-1238"></span><span class="anchor" id="line-1239"></span><p class="line862">A <tt class="backtick">virtual</tt> method allows to define default implementations to <tt class="backtick">abstract</tt> classes and allows to derived classes to override its behavior, this is different than hiding methods. <span class="anchor" id="line-1240"></span><span class="anchor" id="line-1241"></span></p><p class="line867"><span class="anchor" id="line-1242"></span><span class="anchor" id="line-1243"></span><span class="anchor" id="line-1244"></span><span class="anchor" id="line-1245"></span><span class="anchor" id="line-1246"></span><span class="anchor" id="line-1247"></span><span class="anchor" id="line-1248"></span><span class="anchor" id="line-1249"></span><span class="anchor" id="line-1250"></span><span class="anchor" id="line-1251"></span><span class="anchor" id="line-1252"></span><span class="anchor" id="line-1253"></span><span class="anchor" id="line-1254"></span><span class="anchor" id="line-1255"></span><span class="anchor" id="line-1256"></span><span class="anchor" id="line-1257"></span><span class="anchor" id="line-1258"></span><span class="anchor" id="line-1259"></span><span class="anchor" id="line-1260"></span><span class="anchor" id="line-1261"></span><span class="anchor" id="line-1262"></span><span class="anchor" id="line-1263"></span><span class="anchor" id="line-1264"></span><span class="anchor" id="line-1265"></span><span class="anchor" id="line-1266"></span><span class="anchor" id="line-1267"></span><span class="anchor" id="line-1268"></span><span class="anchor" id="line-1269"></span><span class="anchor" id="line-1270"></span><span class="anchor" id="line-1271"></span><span class="anchor" id="line-1272"></span><span class="anchor" id="line-1273"></span><span class="anchor" id="line-1274"></span><span class="anchor" id="line-1275"></span><span class="anchor" id="line-1276"></span><span class="anchor" id="line-1277"></span><span class="anchor" id="line-1278"></span><span class="anchor" id="line-1279"></span><span class="anchor" id="line-1280"></span><span class="anchor" id="line-1281"></span><span class="anchor" id="line-1282"></span><span class="anchor" id="line-1283"></span><span class="anchor" id="line-1284"></span><span class="anchor" id="line-1285"></span><span class="anchor" id="line-1286"></span><span class="anchor" id="line-1287"></span><span class="anchor" id="line-1288"></span><span class="anchor" id="line-1289"></span><span class="anchor" id="line-1290"></span><span class="anchor" id="line-1-164"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-4529dafa84d276734a8ae58b326eca0721658632" lang="en"><span class="line"><span class="anchor" id="line-1-165"></span><span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">class</span> <span class="ID">Caller</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-66"></span>   <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ID">string</span> <span class="ID">name</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-3-52"></span>   <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">void</span> <span class="ID">update</span> (<span class="ID">string</span> <span class="ID">new_name</span>);</span>
<span class="line"><span class="anchor" id="line-4-38"></span>   <span class="ResWord">public</span> <span class="ResWord">virtual</span> <span class="ResWord">bool</span> <span class="ID">reset</span> ()</span>
<span class="line"><span class="anchor" id="line-5-31"></span>   {</span>
<span class="line"><span class="anchor" id="line-6-27"></span>      <span class="ID">name</span> = <span class="String">"</span><span class="String">No Name</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-7-25"></span>      <span class="ResWord">return</span> <span class="ConsWord">true</span>;</span>
<span class="line"><span class="anchor" id="line-8-22"></span>   }</span>
<span class="line"><span class="anchor" id="line-9-21"></span>}</span>
<span class="line"><span class="anchor" id="line-10-17"></span></span>
<span class="line"><span class="anchor" id="line-11-15"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">ContactCV</span> : <span class="ID">Caller</span></span>
<span class="line"><span class="anchor" id="line-12-13"></span>{</span>
<span class="line"><span class="anchor" id="line-13-12"></span>   <span class="ResWord">public</span> <span class="ID">override</span> <span class="ID">string</span> <span class="ID">name</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-14-11"></span>   <span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">void</span> <span class="ID">update</span> (<span class="ID">string</span> <span class="ID">new_name</span>)</span>
<span class="line"><span class="anchor" id="line-15-11"></span>   {</span>
<span class="line"><span class="anchor" id="line-16-9"></span>     <span class="ID">name</span> = <span class="String">"</span><span class="String">ContactCV - </span><span class="String">"</span> + <span class="ID">new_name</span>;</span>
<span class="line"><span class="anchor" id="line-17-7"></span>   }</span>
<span class="line"><span class="anchor" id="line-18-6"></span>   <span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">bool</span> <span class="ID">reset</span> ()</span>
<span class="line"><span class="anchor" id="line-19-4"></span>   {</span>
<span class="line"><span class="anchor" id="line-20-4"></span>      <span class="ID">name</span> = <span class="String">"</span><span class="String">ContactCV-Name</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-21-4"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span> (<span class="String">"</span><span class="String">CotactCV.reset () implementation!</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-22-3"></span>      <span class="ResWord">return</span> <span class="ConsWord">true</span>;</span>
<span class="line"><span class="anchor" id="line-23-1"></span>   }</span>
<span class="line"><span class="anchor" id="line-24-1"></span>}</span>
<span class="line"><span class="anchor" id="line-25-1"></span></span>
<span class="line"><span class="anchor" id="line-26-1"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Contact</span> : <span class="ID">Caller</span> {</span>
<span class="line"><span class="anchor" id="line-27-1"></span>   <span class="ResWord">public</span> <span class="ID">override</span> <span class="ID">string</span> <span class="ID">name</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-28-1"></span>   <span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">void</span> <span class="ID">update</span> (<span class="ID">string</span> <span class="ID">new_name</span>)</span>
<span class="line"><span class="anchor" id="line-29-1"></span>   {</span>
<span class="line"><span class="anchor" id="line-30-1"></span>     <span class="ID">name</span> = <span class="String">"</span><span class="String">Contact - </span><span class="String">"</span> + <span class="ID">new_name</span>;</span>
<span class="line"><span class="anchor" id="line-31-1"></span>   }</span>
<span class="line"><span class="anchor" id="line-32-1"></span>   </span>
<span class="line"><span class="anchor" id="line-33-1"></span>   <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">void</span> <span class="ID">main</span> ()</span>
<span class="line"><span class="anchor" id="line-34-1"></span>   {</span>
<span class="line"><span class="anchor" id="line-35-1"></span>      <span class="ID">var</span> <span class="ID">c</span> = <span class="ResWord">new</span> <span class="ID">Contact</span> ();</span>
<span class="line"><span class="anchor" id="line-36-1"></span>      <span class="ID">c</span>.<span class="ID">update</span> (<span class="String">"</span><span class="String">John Strauss</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-37-1"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span>(@<span class="String">"</span><span class="String">Name: $(c.name)</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-38-1"></span>      <span class="ID">c</span>.<span class="ID">reset</span> ();</span>
<span class="line"><span class="anchor" id="line-39-1"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span>(@<span class="String">"</span><span class="String">Reset Name: $(c.name)</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-40-1"></span>      </span>
<span class="line"><span class="anchor" id="line-41-1"></span>      <span class="ID">var</span> <span class="ID">cv</span> = <span class="ResWord">new</span> <span class="ID">ContactCV</span> ();</span>
<span class="line"><span class="anchor" id="line-42-1"></span>      <span class="ID">cv</span>.<span class="ID">update</span> (<span class="String">"</span><span class="String">Xochitl Calva</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-43-1"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span>(@<span class="String">"</span><span class="String">Name: $(cv.name)</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-44-1"></span>      <span class="ID">cv</span>.<span class="ID">reset</span> ();</span>
<span class="line"><span class="anchor" id="line-45-1"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span>(@<span class="String">"</span><span class="String">Reset Name: $(cv.name)</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-46-1"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">END</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-47-1"></span>   }</span>
<span class="line"><span class="anchor" id="line-48-1"></span>}</span>
</pre></div></div><span class="anchor" id="line-1291"></span><span class="anchor" id="line-1292"></span><p class="line862">As you can see in the above example, <tt class="backtick">Caller</tt> is an <tt class="backtick">abstract</tt> class defining both an abstract property and a method, but adds a <tt class="backtick">virtual</tt> method which can be overridden by derived classes. <tt class="backtick">Contact</tt> class implements abstract methods and properties of <tt class="backtick">Caller</tt>, while using the default implementation for <tt class="backtick">reset()</tt> by avoiding to define a new one. <tt class="backtick">ContactCV</tt> class implements all abstract definitions on <tt class="backtick">Caller</tt>, but overrides <tt class="backtick">reset()</tt> so as to define its own implementation. <span class="anchor" id="line-1293"></span><span class="anchor" id="line-1294"></span></p><p class="line867">
</p><h3 id="Interfaces-1">Interfaces</h3>
<span class="anchor" id="line-1295"></span><span class="anchor" id="line-1296"></span><p class="line874">A
 class in Vala may implement any number of interfaces.  Each interface 
is a type, much like a class, but one that cannot be instantiated.  By 
"implementing" one or more interfaces, a class may declare that its 
instances are also instances of the interface, and therefore may be used
 in any situation where an instance of that interface is expected. <span class="anchor" id="line-1297"></span><span class="anchor" id="line-1298"></span></p><p class="line874">The
 procedure for implementing an interface is the same as for inheriting 
from classes with abstract methods in - if the class is to be useful it 
must provide implementations for all methods that are described but not 
yet implemented. <span class="anchor" id="line-1299"></span><span class="anchor" id="line-1300"></span></p><p class="line874">A simple interface definition looks like: <span class="anchor" id="line-1301"></span><span class="anchor" id="line-1302"></span></p><p class="line867"><span class="anchor" id="line-1303"></span><span class="anchor" id="line-1304"></span><span class="anchor" id="line-1305"></span><span class="anchor" id="line-1306"></span><span class="anchor" id="line-1307"></span><span class="anchor" id="line-1-166"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-38c45e213160bfd188ef966f11647d465fd84bb0" lang="en"><span class="line"><span class="anchor" id="line-1-167"></span><span class="ResWord">public</span> <span class="ID">interface</span> <span class="ID">ITest</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-67"></span>    <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">int</span> <span class="ID">data_1</span> { <span class="ID">get</span>; <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-3-53"></span>    <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">void</span> <span class="ID">method_1</span>();</span>
<span class="line"><span class="anchor" id="line-4-39"></span>}</span>
</pre></div></div><span class="anchor" id="line-1308"></span><span class="anchor" id="line-1309"></span><p class="line862">This code describes an interface "I<tt class="backtick"></tt>Test"
 which requires GLib.Object as parent of the implementor class and 
contains two members.  "data_1" is a property, as described above, 
except that it is declared <tt class="backtick">abstract</tt>.  Vala 
will therefore not implement this property, but instead require that 
classes implementing this interface have a property called "data_1" that
 has both <tt class="backtick">get</tt> and <tt class="backtick">set</tt> accessors - it is required that this be <tt class="backtick">abstract</tt>
 as an interface may not have any data members.  The second member 
"method_1" is a method.  Here it is declared that this method must be 
implemented by classes that implement this interface. <span class="anchor" id="line-1310"></span><span class="anchor" id="line-1311"></span></p><p class="line874">The simplest possible full implementation of this interface is: <span class="anchor" id="line-1312"></span><span class="anchor" id="line-1313"></span></p><p class="line867"><span class="anchor" id="line-1314"></span><span class="anchor" id="line-1315"></span><span class="anchor" id="line-1316"></span><span class="anchor" id="line-1317"></span><span class="anchor" id="line-1318"></span><span class="anchor" id="line-1319"></span><span class="anchor" id="line-1-168"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b871e8b390dd3bffaf5d30d56aafca9da68002c3" lang="en"><span class="line"><span class="anchor" id="line-1-169"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Test1</span> : <span class="ID">GLib</span>.<span class="ID">Object</span>, <span class="ID">ITest</span> {</span>
<span class="line"><span class="anchor" id="line-2-68"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">data_1</span> { <span class="ID">get</span>; <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-3-54"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">method_1</span>() {</span>
<span class="line"><span class="anchor" id="line-4-40"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-32"></span>}</span>
</pre></div></div><span class="anchor" id="line-1320"></span><span class="anchor" id="line-1321"></span><p class="line874">And may be used as follows: <span class="anchor" id="line-1322"></span><span class="anchor" id="line-1323"></span></p><p class="line867"><span class="anchor" id="line-1324"></span><span class="anchor" id="line-1325"></span><span class="anchor" id="line-1326"></span><span class="anchor" id="line-1327"></span><span class="anchor" id="line-1328"></span><span class="anchor" id="line-1329"></span><span class="anchor" id="line-1-170"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-04f92b06cd1b6be98e708fd752513797774257a3" lang="en"><span class="line"><span class="anchor" id="line-1-171"></span><span class="ID">var</span> <span class="ID">t</span> = <span class="ResWord">new</span> <span class="ID">Test1</span>();</span>
<span class="line"><span class="anchor" id="line-2-69"></span><span class="ID">t</span>.<span class="ID">method_1</span>();</span>
<span class="line"><span class="anchor" id="line-3-55"></span></span>
<span class="line"><span class="anchor" id="line-4-41"></span><span class="ID">ITest</span> <span class="ID">i</span> = <span class="ID">t</span>;</span>
<span class="line"><span class="anchor" id="line-5-33"></span><span class="ID">i</span>.<span class="ID">method_1</span>();</span>
</pre></div></div><span class="anchor" id="line-1330"></span><span class="anchor" id="line-1331"></span><p class="line867">
</p><h4 id="Defining_Prerequisites">Defining Prerequisites</h4>
<span class="anchor" id="line-1332"></span><span class="anchor" id="line-1333"></span><p class="line862">Interfaces
 in Vala may not inherit from other interfaces, but they may declare 
other interfaces to be prerequisites, which works in roughly the same 
way.  For example, it may be desirable to say that any class that 
implements a <tt class="backtick">List</tt> interface must also implement a <tt class="backtick">Collection</tt> and <tt class="backtick">Traversable</tt> interfaces.  The syntax for this is exactly the same as for describing interface implementation in classes: <span class="anchor" id="line-1334"></span><span class="anchor" id="line-1335"></span></p><p class="line867"><span class="anchor" id="line-1336"></span><span class="anchor" id="line-1337"></span><span class="anchor" id="line-1338"></span><span class="anchor" id="line-1-172"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-7f9831323666a6abb8b34720672ba05a7b09f47c" lang="en"><span class="line"><span class="anchor" id="line-1-173"></span><span class="ResWord">public</span> <span class="ID">interface</span> <span class="ID">List</span> : <span class="ID">Collection</span>, <span class="ID">Traversable</span> {</span>
<span class="line"><span class="anchor" id="line-2-70"></span>}</span>
</pre></div></div><span class="anchor" id="line-1339"></span><span class="anchor" id="line-1340"></span><p class="line874">This
 definition of "List" may not be implemented in a class without 
"Collection" also being implemented, and so Vala enforces the following 
style of declaration for a class wishing to implement "List", where all 
implemented interfaces must be described: <span class="anchor" id="line-1341"></span><span class="anchor" id="line-1342"></span></p><p class="line867"><span class="anchor" id="line-1343"></span><span class="anchor" id="line-1344"></span><span class="anchor" id="line-1345"></span><span class="anchor" id="line-1-174"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d8a1e401bfded9ce9e329a15048e142d1588ee1a" lang="en"><span class="line"><span class="anchor" id="line-1-175"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">ListClass</span> : <span class="ID">GLib</span>.<span class="ID">Object</span>, <span class="ID">Collection</span>, <span class="ID">List</span> {</span>
<span class="line"><span class="anchor" id="line-2-71"></span>}</span>
</pre></div></div><span class="anchor" id="line-1346"></span><span class="anchor" id="line-1347"></span><p class="line874">Vala
 interfaces may also have a class as a prerequisite.  If a class name is
 given in the list of prerequisites, the interface may only be 
implemented in classes that derive from that prerequisite class.  This 
is often used to ensure that an instance of an interface is also a 
GLib.Object subclass, and so the interface can be used, for example, as 
the type of a property. <span class="anchor" id="line-1348"></span><span class="anchor" id="line-1349"></span></p><p class="line874">The
 fact that interfaces can not inherit from other interfaces is mostly 
only a technical distinction - in practice Vala's system works the same 
as other languages in this area, but with the extra feature of 
prerequisite classes. <span class="anchor" id="line-1350"></span><span class="anchor" id="line-1351"></span></p><p class="line867">
</p><h4 id="Defining_default_implementation_in_methods">Defining default implementation in methods</h4>
<span class="anchor" id="line-1352"></span><span class="anchor" id="line-1353"></span><p class="line874">There's
 another important difference between Vala interfaces and Java/C# 
interfaces: Vala interfaces may have non-abstract methods. <span class="anchor" id="line-1354"></span><span class="anchor" id="line-1355"></span></p><p class="line862">Vala actually allows method implementations in interfaces, then a method with a default implementation must be declared as <tt class="backtick">virtual</tt>. Due to this fact Vala interfaces can act as <a class="http" href="http://en.wikipedia.org/wiki/Mixins">mixins</a>.  This is a restricted form of multiple inheritance. <span class="anchor" id="line-1356"></span><span class="anchor" id="line-1357"></span></p><p class="line867"><span class="anchor" id="line-1358"></span><span class="anchor" id="line-1359"></span><span class="anchor" id="line-1360"></span><span class="anchor" id="line-1361"></span><span class="anchor" id="line-1362"></span><span class="anchor" id="line-1363"></span><span class="anchor" id="line-1364"></span><span class="anchor" id="line-1365"></span><span class="anchor" id="line-1366"></span><span class="anchor" id="line-1367"></span><span class="anchor" id="line-1-176"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-7f9ca3c49c5c591a576dd5fa9771110166c6d9ca" lang="en"><span class="line"><span class="anchor" id="line-1-177"></span><span class="ResWord">public</span> <span class="ID">interface</span> <span class="ID">Callable</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-72"></span>   <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">bool</span> <span class="ID">answering</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-3-56"></span>   <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">void</span> <span class="ID">answer</span> ();</span>
<span class="line"><span class="anchor" id="line-4-42"></span>   <span class="ResWord">public</span> <span class="ResWord">virtual</span> <span class="ResWord">bool</span> <span class="ID">hang</span> ()</span>
<span class="line"><span class="anchor" id="line-5-34"></span>   {</span>
<span class="line"><span class="anchor" id="line-6-28"></span>      <span class="ID">answering</span> = <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-7-26"></span>      <span class="ResWord">return</span> <span class="ConsWord">true</span>;</span>
<span class="line"><span class="anchor" id="line-8-23"></span>   }</span>
<span class="line"><span class="anchor" id="line-9-22"></span>}</span>
</pre></div></div><span class="anchor" id="line-1368"></span><span class="anchor" id="line-1369"></span><p class="line862">Interface <tt class="backtick">Callable</tt> defines an abstract property called <tt class="backtick">answering</tt>, where any class implementing this interface can monitor the state of a call, details about <tt class="backtick">answer</tt> a call is a mautter of the implementator, but <tt class="backtick">hang</tt> defines a default implementation to set <tt class="backtick">answering</tt> to false when hanging a call. <span class="anchor" id="line-1370"></span><span class="anchor" id="line-1371"></span><span class="anchor" id="line-1372"></span></p><p class="line867"><span class="anchor" id="line-1373"></span><span class="anchor" id="line-1374"></span><span class="anchor" id="line-1375"></span><span class="anchor" id="line-1376"></span><span class="anchor" id="line-1377"></span><span class="anchor" id="line-1378"></span><span class="anchor" id="line-1379"></span><span class="anchor" id="line-1380"></span><span class="anchor" id="line-1381"></span><span class="anchor" id="line-1382"></span><span class="anchor" id="line-1383"></span><span class="anchor" id="line-1384"></span><span class="anchor" id="line-1385"></span><span class="anchor" id="line-1386"></span><span class="anchor" id="line-1387"></span><span class="anchor" id="line-1388"></span><span class="anchor" id="line-1389"></span><span class="anchor" id="line-1390"></span><span class="anchor" id="line-1-178"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d1bbecbf0479f6de36c6e996bfccd9de92db6004" lang="en"><span class="line"><span class="anchor" id="line-1-179"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Phone</span> : <span class="ID">GLib</span>.<span class="ID">Object</span>, <span class="ID">Callable</span> {</span>
<span class="line"><span class="anchor" id="line-2-73"></span>   <span class="ResWord">public</span> <span class="ResWord">bool</span> <span class="ID">answering</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-3-57"></span>   <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">answer</span> ()</span>
<span class="line"><span class="anchor" id="line-4-43"></span>   {</span>
<span class="line"><span class="anchor" id="line-5-35"></span>     <span class="Comment">/* answer code implementation */</span></span>
<span class="line"><span class="anchor" id="line-6-29"></span>   }</span>
<span class="line"><span class="anchor" id="line-7-27"></span>   </span>
<span class="line"><span class="anchor" id="line-8-24"></span>   <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">void</span> <span class="ID">main</span> ()</span>
<span class="line"><span class="anchor" id="line-9-23"></span>   {</span>
<span class="line"><span class="anchor" id="line-10-18"></span>      <span class="ID">var</span> <span class="ID">f</span> = <span class="ResWord">new</span> <span class="ID">Phone</span> ();</span>
<span class="line"><span class="anchor" id="line-11-16"></span>      <span class="ResWord">if</span> (<span class="ID">f</span>.<span class="ID">hang</span> ())</span>
<span class="line"><span class="anchor" id="line-12-14"></span>         <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hand done.</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-13-13"></span>      <span class="ResWord">else</span></span>
<span class="line"><span class="anchor" id="line-14-12"></span>         <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hand Error!</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-15-12"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">END</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-16-10"></span>   }</span>
<span class="line"><span class="anchor" id="line-17-8"></span>}</span>
</pre></div></div><span class="anchor" id="line-1391"></span><span class="anchor" id="line-1392"></span><p class="line862">When compiling and running, you will find that <tt class="backtick">Phone</tt> class actually no implements <tt class="backtick">Callable.hang()</tt> method, but it is able to use it, then the result is a message <tt class="backtick">Hang&nbsp;done.</tt> <span class="anchor" id="line-1393"></span><span class="anchor" id="line-1394"></span></p><p class="line867"><span class="anchor" id="line-1395"></span><span class="anchor" id="line-1396"></span><span class="anchor" id="line-1397"></span><span class="anchor" id="line-1398"></span><span class="anchor" id="line-1399"></span><span class="anchor" id="line-1400"></span><span class="anchor" id="line-1401"></span><span class="anchor" id="line-1402"></span><span class="anchor" id="line-1403"></span><span class="anchor" id="line-1404"></span><span class="anchor" id="line-1405"></span><span class="anchor" id="line-1406"></span><span class="anchor" id="line-1407"></span><span class="anchor" id="line-1408"></span><span class="anchor" id="line-1409"></span><span class="anchor" id="line-1-180"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-751ed486f743bb8a88712ce30d1846f90949f34c" lang="en"><span class="line"><span class="anchor" id="line-1-181"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">TechPhone</span> : <span class="ID">GLib</span>.<span class="ID">Object</span>, <span class="ID">Callable</span></span>
<span class="line"><span class="anchor" id="line-2-74"></span>{</span>
<span class="line"><span class="anchor" id="line-3-58"></span>   <span class="ResWord">public</span> <span class="ResWord">bool</span> <span class="ID">answering</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-4-44"></span>   <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">answer</span> ()</span>
<span class="line"><span class="anchor" id="line-5-36"></span>   {</span>
<span class="line"><span class="anchor" id="line-6-30"></span>     <span class="Comment">/* answer code implementation */</span></span>
<span class="line"><span class="anchor" id="line-7-28"></span>   }</span>
<span class="line"><span class="anchor" id="line-8-25"></span>   <span class="ResWord">public</span> <span class="ResWord">bool</span> <span class="ID">hang</span> ()</span>
<span class="line"><span class="anchor" id="line-9-24"></span>   {</span>
<span class="line"><span class="anchor" id="line-10-19"></span>      <span class="ID">answering</span> = <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-11-17"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span> (<span class="String">"</span><span class="String">TechPhone.hang () implementation!</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-12-15"></span>      <span class="ResWord">return</span> <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-13-14"></span>   }</span>
<span class="line"><span class="anchor" id="line-14-13"></span>}</span>
</pre></div></div><span class="anchor" id="line-1410"></span><span class="anchor" id="line-1411"></span><p class="line862">In this case <tt class="backtick">TechPhone</tt> is another implementation to <tt class="backtick">Callable</tt>, then when <tt class="backtick">hang()</tt> method is called on an instance of <tt class="backtick">TechPhone</tt> it will always return <tt class="backtick">false</tt> and print the message <tt class="backtick">TechPhone.hang&nbsp;()&nbsp;implementation!</tt>, hidding completelly <tt class="backtick">Callable.hang()</tt> default implementation. <span class="anchor" id="line-1412"></span><span class="anchor" id="line-1413"></span></p><p class="line867">
</p><h4 id="Properties-1">Properties</h4>
<span class="anchor" id="line-1414"></span><span class="anchor" id="line-1415"></span><p class="line862">An
 interface can define properties that must be implemented for classes. 
Implementator class must define a property with the same signature and 
access permissions to the property's <tt class="backtick">get</tt> and <tt class="backtick">set</tt>. <span class="anchor" id="line-1416"></span><span class="anchor" id="line-1417"></span></p><p class="line862">As any GObject property, you can define a body to property's <tt class="backtick">set</tt> and <tt class="backtick">get</tt> in the implementator class, when no body is used values are set and get by default. If given, you must define a <tt class="backtick">private</tt> field to store the properties values to be used outside or inside the class. <span class="anchor" id="line-1418"></span><span class="anchor" id="line-1419"></span></p><p class="line867"><tt class="backtick">Callable</tt> interface definition, defines an <tt class="backtick">answering</tt> property.  In this case this interface defines a <tt class="backtick">answering</tt> with a <tt class="backtick">protected&nbsp;set</tt>, allowing a read only property for any object using an instance of <tt class="backtick">Callable</tt>, but allows class implementors to write values to it, like <tt class="backtick">TechPhone</tt> class does when implements <tt class="backtick">hang()</tt> method. <span class="anchor" id="line-1420"></span><span class="anchor" id="line-1421"></span></p><p class="line867">
</p><h4 id="Mixins_and_Multiple_Inheritance">Mixins and Multiple Inheritance</h4>
<span class="anchor" id="line-1422"></span><span class="anchor" id="line-1423"></span><p class="line874">As
 described above, Vala while it is backed by C and GObject, can provide a
 limited multiple inheritance mechanism, by adding virtual methods to 
Interfaces. Is possible to add some ways to define default method 
implementations in interface implementor class and allow derived classes
 to override that methods. <span class="anchor" id="line-1424"></span><span class="anchor" id="line-1425"></span></p><p class="line862">If you define a <tt class="backtick">virtual</tt>
 method in an interface and implement it in a class, you can't override 
interface's method without leaving derived classes unable to access to 
interface default one. Consider following code: <span class="anchor" id="line-1426"></span><span class="anchor" id="line-1427"></span></p><p class="line867"><span class="anchor" id="line-1428"></span><span class="anchor" id="line-1429"></span><span class="anchor" id="line-1430"></span><span class="anchor" id="line-1431"></span><span class="anchor" id="line-1432"></span><span class="anchor" id="line-1433"></span><span class="anchor" id="line-1434"></span><span class="anchor" id="line-1435"></span><span class="anchor" id="line-1436"></span><span class="anchor" id="line-1437"></span><span class="anchor" id="line-1438"></span><span class="anchor" id="line-1439"></span><span class="anchor" id="line-1440"></span><span class="anchor" id="line-1441"></span><span class="anchor" id="line-1442"></span><span class="anchor" id="line-1443"></span><span class="anchor" id="line-1444"></span><span class="anchor" id="line-1445"></span><span class="anchor" id="line-1446"></span><span class="anchor" id="line-1447"></span><span class="anchor" id="line-1448"></span><span class="anchor" id="line-1449"></span><span class="anchor" id="line-1450"></span><span class="anchor" id="line-1451"></span><span class="anchor" id="line-1452"></span><span class="anchor" id="line-1453"></span><span class="anchor" id="line-1454"></span><span class="anchor" id="line-1455"></span><span class="anchor" id="line-1456"></span><span class="anchor" id="line-1457"></span><span class="anchor" id="line-1458"></span><span class="anchor" id="line-1459"></span><span class="anchor" id="line-1460"></span><span class="anchor" id="line-1461"></span><span class="anchor" id="line-1462"></span><span class="anchor" id="line-1463"></span><span class="anchor" id="line-1464"></span><span class="anchor" id="line-1465"></span><span class="anchor" id="line-1466"></span><span class="anchor" id="line-1467"></span><span class="anchor" id="line-1468"></span><span class="anchor" id="line-1469"></span><span class="anchor" id="line-1470"></span><span class="anchor" id="line-1471"></span><span class="anchor" id="line-1472"></span><span class="anchor" id="line-1473"></span><span class="anchor" id="line-1474"></span><span class="anchor" id="line-1475"></span><span class="anchor" id="line-1476"></span><span class="anchor" id="line-1477"></span><span class="anchor" id="line-1478"></span><span class="anchor" id="line-1479"></span><span class="anchor" id="line-1480"></span><span class="anchor" id="line-1-182"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-cfeee99cc2dba1b0b9cd75ba6fb4a00fad7c0e02" lang="en"><span class="line"><span class="anchor" id="line-1-183"></span><span class="ResWord">public</span> <span class="ID">interface</span> <span class="ID">Callable</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-75"></span>   <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">bool</span> <span class="ID">answering</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-3-59"></span>   <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">void</span> <span class="ID">answer</span> ();</span>
<span class="line"><span class="anchor" id="line-4-45"></span>   <span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">bool</span> <span class="ID">hang</span> ();</span>
<span class="line"><span class="anchor" id="line-5-37"></span>   <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">bool</span> <span class="ID">default_hang</span> (<span class="ID">Callable</span> <span class="ID">call</span>)</span>
<span class="line"><span class="anchor" id="line-6-31"></span>   {</span>
<span class="line"><span class="anchor" id="line-7-29"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span> (<span class="String">"</span><span class="String">At Callable.hang()</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-8-26"></span>      <span class="ID">call</span>.<span class="ID">answering</span> = <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-9-25"></span>      <span class="ResWord">return</span> <span class="ConsWord">true</span>;</span>
<span class="line"><span class="anchor" id="line-10-20"></span>   }</span>
<span class="line"><span class="anchor" id="line-11-18"></span>}</span>
<span class="line"><span class="anchor" id="line-12-16"></span></span>
<span class="line"><span class="anchor" id="line-13-15"></span><span class="ResWord">public</span> <span class="ID">abstract</span> <span class="ResWord">class</span> <span class="ID">Caller</span> : <span class="ID">GLib</span>.<span class="ID">Object</span>, <span class="ID">Callable</span></span>
<span class="line"><span class="anchor" id="line-14-14"></span>{</span>
<span class="line"><span class="anchor" id="line-15-13"></span>   <span class="ResWord">public</span> <span class="ResWord">bool</span> <span class="ID">answering</span> { <span class="ID">get</span>; <span class="ResWord">protected</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-16-11"></span>   <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">answer</span> ()</span>
<span class="line"><span class="anchor" id="line-17-9"></span>   {</span>
<span class="line"><span class="anchor" id="line-18-7"></span>     <span class="ID">stdout</span>.<span class="ID">printf</span> (<span class="String">"</span><span class="String">At Caller.answer()</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-19-5"></span>     <span class="ID">answering</span> = <span class="ConsWord">true</span>;</span>
<span class="line"><span class="anchor" id="line-20-5"></span>     <span class="ID">hang</span> ();</span>
<span class="line"><span class="anchor" id="line-21-5"></span>   }</span>
<span class="line"><span class="anchor" id="line-22-4"></span>   <span class="ResWord">public</span> <span class="ResWord">virtual</span> <span class="ResWord">bool</span> <span class="ID">hang</span> () { <span class="ResWord">return</span> <span class="ID">Callable</span>.<span class="ID">default_hang</span> (<span class="ResWord">this</span>); }</span>
<span class="line"><span class="anchor" id="line-23-2"></span>}</span>
<span class="line"><span class="anchor" id="line-24-2"></span></span>
<span class="line"><span class="anchor" id="line-25-2"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">TechPhone</span> : <span class="ID">Caller</span> {</span>
<span class="line"><span class="anchor" id="line-26-2"></span>        <span class="ResWord">public</span> <span class="ID">string</span> <span class="ID">number</span> { <span class="ID">get</span>; <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-27-2"></span>}</span>
<span class="line"><span class="anchor" id="line-28-2"></span></span>
<span class="line"><span class="anchor" id="line-29-2"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Phone</span> : <span class="ID">Caller</span> {</span>
<span class="line"><span class="anchor" id="line-30-2"></span>   <span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">bool</span> <span class="ID">hang</span> () {</span>
<span class="line"><span class="anchor" id="line-31-2"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span> (<span class="String">"</span><span class="String">At Phone.hang()</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-32-2"></span>        <span class="ResWord">return</span> <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-33-2"></span>   }</span>
<span class="line"><span class="anchor" id="line-34-2"></span>   </span>
<span class="line"><span class="anchor" id="line-35-2"></span>   <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">void</span> <span class="ID">main</span> ()</span>
<span class="line"><span class="anchor" id="line-36-2"></span>   {</span>
<span class="line"><span class="anchor" id="line-37-2"></span>      <span class="ID">var</span> <span class="ID">f</span> = (<span class="ID">Callable</span>) <span class="ResWord">new</span> <span class="ID">Phone</span> ();</span>
<span class="line"><span class="anchor" id="line-38-2"></span>      <span class="ID">f</span>.<span class="ID">answer</span> ();</span>
<span class="line"><span class="anchor" id="line-39-2"></span>      <span class="ResWord">if</span> (<span class="ID">f</span>.<span class="ID">hang</span> ())</span>
<span class="line"><span class="anchor" id="line-40-2"></span>         <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hand done.</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-41-2"></span>      <span class="ResWord">else</span></span>
<span class="line"><span class="anchor" id="line-42-2"></span>         <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hand Error!</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-43-2"></span>      </span>
<span class="line"><span class="anchor" id="line-44-2"></span>      <span class="ID">var</span> <span class="ID">t</span> = (<span class="ID">Callable</span>) <span class="ResWord">new</span> <span class="ID">TechPhone</span> ();</span>
<span class="line"><span class="anchor" id="line-45-2"></span>      <span class="ID">t</span>.<span class="ID">answer</span> ();</span>
<span class="line"><span class="anchor" id="line-46-2"></span>      <span class="ResWord">if</span> (<span class="ID">t</span>.<span class="ID">hang</span> ())</span>
<span class="line"><span class="anchor" id="line-47-2"></span>         <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Tech Hand done.</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-48-2"></span>      <span class="ResWord">else</span></span>
<span class="line"><span class="anchor" id="line-49-1"></span>         <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Tech Hand Error!</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-50-1"></span>      <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">END</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-51-1"></span>   }</span>
<span class="line"><span class="anchor" id="line-52-1"></span>}</span>
</pre></div></div><span class="anchor" id="line-1481"></span><span class="anchor" id="line-1482"></span><p class="line862">In this case, we have defined a <tt class="backtick">Callable</tt> interface with a default implementation for <tt class="backtick">abstract&nbsp;bool&nbsp;hang&nbsp;()</tt> called <tt class="backtick">default_hang</tt>, it could be a <tt class="backtick">static</tt> or <tt class="backtick">virtual</tt> method. Then <tt class="backtick">Caller</tt> is a base class implementing <tt class="backtick">Callable</tt> for the <tt class="backtick">TechPhone</tt> and <tt class="backtick">Phone</tt> classes, while <tt class="backtick">Caller</tt>'s  <tt class="backtick">hang&nbsp;()</tt> method simple call <tt class="backtick">Callable</tt> default implementation. <tt class="backtick">TechPhone</tt> doesn't do anything and just takes <tt class="backtick">Caller</tt> as base class, using the default method implementations; but <tt class="backtick">Phone</tt> overrides <tt class="backtick">Caller.hang&nbsp;()</tt> and this makes to use its own implementation, allowing to always call it even if it is cast to <tt class="backtick">Callable</tt> object. <span class="anchor" id="line-1483"></span><span class="anchor" id="line-1484"></span></p><p class="line867">
</p><h3 id="Polymorphism">Polymorphism</h3>
<span class="anchor" id="line-1485"></span><span class="anchor" id="line-1486"></span><p class="line867"><em>Polymorphism</em>
 describes the way in which the same object can be used as though it 
were more than one distinct type of thing.  Several of the techniques 
already described here suggest how this is possible in Vala: An instance
 of a class may be used as in instance of a superclass, or of any 
implemented interfaces, without any knowledge of its actual type. <span class="anchor" id="line-1487"></span><span class="anchor" id="line-1488"></span></p><p class="line874">A
 logical extension of this power is to allow a subtype to behave 
differently to its parent type when addressed in exactly the same way.  
This is not a very easy concept to explain, so I'll begin with an 
example of what will happen if you do not directly aim for this goal: <span class="anchor" id="line-1489"></span><span class="anchor" id="line-1490"></span></p><p class="line867"><span class="anchor" id="line-1491"></span><span class="anchor" id="line-1492"></span><span class="anchor" id="line-1493"></span><span class="anchor" id="line-1494"></span><span class="anchor" id="line-1495"></span><span class="anchor" id="line-1496"></span><span class="anchor" id="line-1497"></span><span class="anchor" id="line-1498"></span><span class="anchor" id="line-1499"></span><span class="anchor" id="line-1500"></span><span class="anchor" id="line-1501"></span><span class="anchor" id="line-1502"></span><span class="anchor" id="line-1-184"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-df3cdf7166cb2b0fb38f3122a2f952fa3ceed150" lang="en"><span class="line"><span class="anchor" id="line-1-185"></span><span class="ResWord">class</span> <span class="ID">SuperClass</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-76"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">method_1</span>() {</span>
<span class="line"><span class="anchor" id="line-3-60"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">SuperClass.method_1()</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-4-46"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-38"></span>}</span>
<span class="line"><span class="anchor" id="line-6-32"></span></span>
<span class="line"><span class="anchor" id="line-7-30"></span><span class="ResWord">class</span> <span class="ID">SubClass</span> : <span class="ID">SuperClass</span> {</span>
<span class="line"><span class="anchor" id="line-8-27"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">method_1</span>() {</span>
<span class="line"><span class="anchor" id="line-9-26"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">SubClass.method_1()</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-10-21"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-19"></span>}</span>
</pre></div></div><span class="anchor" id="line-1503"></span><span class="anchor" id="line-1504"></span><p class="line862">These two classes both implement a method called "method_1", and "Sub<tt class="backtick"></tt>Class" therefore contains two methods called "method_1", as it inherits one from "Super<tt class="backtick"></tt>Class".  Each of these may be called as the following code shows: <span class="anchor" id="line-1505"></span><span class="anchor" id="line-1506"></span></p><p class="line867"><span class="anchor" id="line-1507"></span><span class="anchor" id="line-1508"></span><span class="anchor" id="line-1509"></span><span class="anchor" id="line-1510"></span><span class="anchor" id="line-1511"></span><span class="anchor" id="line-1-186"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1917276660215ffd8687fdf70430c69e92b6f2ed" lang="en"><span class="line"><span class="anchor" id="line-1-187"></span><span class="ID">SubClass</span> <span class="ID">o1</span> = <span class="ResWord">new</span> <span class="ID">SubClass</span>();</span>
<span class="line"><span class="anchor" id="line-2-77"></span><span class="ID">o1</span>.<span class="ID">method_1</span>();</span>
<span class="line"><span class="anchor" id="line-3-61"></span><span class="ID">SuperClass</span> <span class="ID">o2</span> = <span class="ID">o1</span>;</span>
<span class="line"><span class="anchor" id="line-4-47"></span><span class="ID">o2</span>.<span class="ID">method_1</span>();</span>
</pre></div></div><span class="anchor" id="line-1512"></span><span class="anchor" id="line-1513"></span><p class="line862">This will actually result in two different methods being called.  The second line believes "o1" to be a "Sub<tt class="backtick"></tt>Class" and will call that class's version of the method.  The fourth line believes "o2" to be a "Super<tt class="backtick"></tt>Class" and will call that class's version of the method. <span class="anchor" id="line-1514"></span><span class="anchor" id="line-1515"></span></p><p class="line862">The problem this example exposes, is that any code holding a reference to "Super<tt class="backtick"></tt>Class"
 will call the methods actually described in that class, even in the 
actual object is of a subclass.  The way to change this behaviour is 
using virtual methods.  Consider the following rewritten version of the 
last example: <span class="anchor" id="line-1516"></span><span class="anchor" id="line-1517"></span></p><p class="line867"><span class="anchor" id="line-1518"></span><span class="anchor" id="line-1519"></span><span class="anchor" id="line-1520"></span><span class="anchor" id="line-1521"></span><span class="anchor" id="line-1522"></span><span class="anchor" id="line-1523"></span><span class="anchor" id="line-1524"></span><span class="anchor" id="line-1525"></span><span class="anchor" id="line-1526"></span><span class="anchor" id="line-1527"></span><span class="anchor" id="line-1528"></span><span class="anchor" id="line-1529"></span><span class="anchor" id="line-1-188"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1024df454c225a6eb5c4581f3e66548cb42f80ec" lang="en"><span class="line"><span class="anchor" id="line-1-189"></span><span class="ResWord">class</span> <span class="ID">SuperClass</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-78"></span>    <span class="ResWord">public</span> <span class="ResWord">virtual</span> <span class="ResWord">void</span> <span class="ID">method_1</span>() {</span>
<span class="line"><span class="anchor" id="line-3-62"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">SuperClass.method_1()</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-4-48"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-39"></span>}</span>
<span class="line"><span class="anchor" id="line-6-33"></span></span>
<span class="line"><span class="anchor" id="line-7-31"></span><span class="ResWord">class</span> <span class="ID">SubClass</span> : <span class="ID">SuperClass</span> {</span>
<span class="line"><span class="anchor" id="line-8-28"></span>    <span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">void</span> <span class="ID">method_1</span>() {</span>
<span class="line"><span class="anchor" id="line-9-27"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">SubClass.method_1()</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-10-22"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-20"></span>}</span>
</pre></div></div><span class="anchor" id="line-1530"></span><span class="anchor" id="line-1531"></span><p class="line862">When this code is used in the same way as before, "Sub<tt class="backtick"></tt>Class"'s
 "method_1" will be called twice.  This is because we have told the 
system that "method_1" is a virtual method, meaning that if it is 
overridden in a subclass, that new version will always be executed on 
instances of that subclass, regardless of the knowledge of the caller. <span class="anchor" id="line-1532"></span><span class="anchor" id="line-1533"></span></p><p class="line874">This
 distinction is probably familiar to programmers of some languages, such
 as C++, but it is in fact the opposite of Java style languages, in 
which steps must be taken to prevent a method being virtual. <span class="anchor" id="line-1534"></span><span class="anchor" id="line-1535"></span></p><p class="line862">You will probably now also have recognised that when method is declared as <tt class="backtick">abstract</tt>
 it must also be virtual.  Otherwise, it would not be possible to 
execute that method given an apparent instance of the type it was 
declared in.  When implementing an abstract method in a subclass, you 
may therefore choose to  declare the implementation as <tt class="backtick">override</tt>, thus passing on the virtual nature of the method, and allowing subtypes to do the same if they desire. <span class="anchor" id="line-1536"></span><span class="anchor" id="line-1537"></span></p><p class="line862">It's
 also possible to implement interface methods in such a way that 
subclasses can change the implementation.  The process in this case is 
for the initial implementation to declare the method implementation to 
be <tt class="backtick">virtual</tt>, and then subclasses can override as required. <span class="anchor" id="line-1538"></span><span class="anchor" id="line-1539"></span></p><p class="line862">When
 writing a class, it is common to want to use functionality defined in a
 class you have inherited from.  This is complicated where the method 
name is used more than one in the inheritance tree for your class.  For 
this Vala provides the <tt class="backtick">base</tt> keyword.  The most
 common case is where you have overridden a virtual method to provide 
extra functionality, but still need the parent class' method to be 
called.  The following example shows this case: <span class="anchor" id="line-1540"></span><span class="anchor" id="line-1541"></span></p><p class="line867"><span class="anchor" id="line-1542"></span><span class="anchor" id="line-1543"></span><span class="anchor" id="line-1544"></span><span class="anchor" id="line-1545"></span><span class="anchor" id="line-1546"></span><span class="anchor" id="line-1-190"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ed69ffd17e80a261390b40db69e1ea4b64dfaf67" lang="en"><span class="line"><span class="anchor" id="line-1-191"></span><span class="ResWord">public</span> <span class="ID">override</span> <span class="ResWord">void</span> <span class="ID">method_name</span>() {</span>
<span class="line"><span class="anchor" id="line-2-79"></span>    <span class="ID">base</span>.<span class="ID">method_name</span>();</span>
<span class="line"><span class="anchor" id="line-3-63"></span>    <span class="ID">extra_task</span>();</span>
<span class="line"><span class="anchor" id="line-4-49"></span>}</span>
</pre></div></div><span class="anchor" id="line-1547"></span><span class="anchor" id="line-1548"></span><p class="line874">Vala also allows properties to be virtual: <span class="anchor" id="line-1549"></span><span class="anchor" id="line-1550"></span></p><p class="line867"><span class="anchor" id="line-1551"></span><span class="anchor" id="line-1552"></span><span class="anchor" id="line-1553"></span><span class="anchor" id="line-1554"></span><span class="anchor" id="line-1555"></span><span class="anchor" id="line-1556"></span><span class="anchor" id="line-1557"></span><span class="anchor" id="line-1558"></span><span class="anchor" id="line-1559"></span><span class="anchor" id="line-1560"></span><span class="anchor" id="line-1561"></span><span class="anchor" id="line-1562"></span><span class="anchor" id="line-1563"></span><span class="anchor" id="line-1564"></span><span class="anchor" id="line-1565"></span><span class="anchor" id="line-1-192"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d1fe712cc87585c60ea7a9d44edbe781ea404ead" lang="en"><span class="line"><span class="anchor" id="line-1-193"></span><span class="ResWord">class</span> <span class="ID">SuperClass</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-80"></span>    <span class="ResWord">public</span> <span class="ResWord">virtual</span> <span class="ID">string</span> <span class="ID">prop_1</span> {</span>
<span class="line"><span class="anchor" id="line-3-64"></span>        <span class="ID">get</span> {</span>
<span class="line"><span class="anchor" id="line-4-50"></span>            <span class="ResWord">return</span> <span class="String">"</span><span class="String">SuperClass.prop_1</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-5-40"></span>        }</span>
<span class="line"><span class="anchor" id="line-6-34"></span>    }</span>
<span class="line"><span class="anchor" id="line-7-32"></span>}</span>
<span class="line"><span class="anchor" id="line-8-29"></span></span>
<span class="line"><span class="anchor" id="line-9-28"></span><span class="ResWord">class</span> <span class="ID">SubClass</span> : <span class="ID">SuperClass</span> {</span>
<span class="line"><span class="anchor" id="line-10-23"></span>    <span class="ResWord">public</span> <span class="ID">override</span> <span class="ID">string</span> <span class="ID">prop_1</span> {</span>
<span class="line"><span class="anchor" id="line-11-21"></span>        <span class="ID">get</span> {</span>
<span class="line"><span class="anchor" id="line-12-17"></span>            <span class="ResWord">return</span> <span class="String">"</span><span class="String">SubClass.prop_1</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-13-16"></span>        }</span>
<span class="line"><span class="anchor" id="line-14-15"></span>    }</span>
</pre></div></div><span class="anchor" id="line-1566"></span><span class="anchor" id="line-1567"></span><p class="line867">
</p><h3 id="Method_Hiding">Method Hiding</h3>
<span class="anchor" id="line-1568"></span><span class="anchor" id="line-1569"></span><p class="line862">By using the <tt class="backtick">new</tt>
 modifier you can hide an inherited method with a new method of the same
 name.  The new method may have a different signature.  Method hiding is
 not to be confused with method overriding, because method hiding does 
not exhibit polymorphic behaviour. <span class="anchor" id="line-1570"></span><span class="anchor" id="line-1571"></span></p><p class="line867"><span class="anchor" id="line-1572"></span><span class="anchor" id="line-1573"></span><span class="anchor" id="line-1574"></span><span class="anchor" id="line-1575"></span><span class="anchor" id="line-1576"></span><span class="anchor" id="line-1577"></span><span class="anchor" id="line-1578"></span><span class="anchor" id="line-1579"></span><span class="anchor" id="line-1-194"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-dd3a20cc2e678be51953ec00ea0f1251dfbab180" lang="en"><span class="line"><span class="anchor" id="line-1-195"></span><span class="ResWord">class</span> <span class="ID">Foo</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-81"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">my_method</span>() { }</span>
<span class="line"><span class="anchor" id="line-3-65"></span>}</span>
<span class="line"><span class="anchor" id="line-4-51"></span></span>
<span class="line"><span class="anchor" id="line-5-41"></span><span class="ResWord">class</span> <span class="ID">Bar</span> : <span class="ID">Foo</span> {</span>
<span class="line"><span class="anchor" id="line-6-35"></span>    <span class="ResWord">public</span> <span class="ResWord">new</span> <span class="ResWord">void</span> <span class="ID">my_method</span>() { }</span>
<span class="line"><span class="anchor" id="line-7-33"></span>}</span>
</pre></div></div><span class="anchor" id="line-1580"></span><span class="anchor" id="line-1581"></span><p class="line874">You can still call the original method by casting to the base class or interface: <span class="anchor" id="line-1582"></span><span class="anchor" id="line-1583"></span></p><p class="line867"><span class="anchor" id="line-1584"></span><span class="anchor" id="line-1585"></span><span class="anchor" id="line-1586"></span><span class="anchor" id="line-1587"></span><span class="anchor" id="line-1588"></span><span class="anchor" id="line-1589"></span><span class="anchor" id="line-1-196"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-85d7408f1d65ff4f166fa53e00eed73d2d10c1fd" lang="en"><span class="line"><span class="anchor" id="line-1-197"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-2-82"></span>    <span class="ID">var</span> <span class="ID">bar</span> = <span class="ResWord">new</span> <span class="ID">Bar</span>();</span>
<span class="line"><span class="anchor" id="line-3-66"></span>    <span class="ID">bar</span>.<span class="ID">my_method</span>();</span>
<span class="line"><span class="anchor" id="line-4-52"></span>    (<span class="ID">bar</span> <span class="ID">as</span> <span class="ID">Foo</span>).<span class="ID">my_method</span>();</span>
<span class="line"><span class="anchor" id="line-5-42"></span>}</span>
</pre></div></div><span class="anchor" id="line-1590"></span><span class="anchor" id="line-1591"></span><p class="line867">
</p><h3 id="Run-Time_Type_Information">Run-Time Type Information</h3>
<span class="anchor" id="line-1592"></span><span class="anchor" id="line-1593"></span><p class="line862">Since
 Vala classes are registered at runtime and each instance carries its 
type information you can dynamically check the type of an object with 
the <tt class="backtick">is</tt> operator: <span class="anchor" id="line-1594"></span><span class="anchor" id="line-1595"></span></p><p class="line867"><span class="anchor" id="line-1596"></span><span class="anchor" id="line-1597"></span><span class="anchor" id="line-1-198"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-79ac4ccc1284d20bf58cc12aefc72f17e8cd8c31" lang="en"><span class="line"><span class="anchor" id="line-1-199"></span><span class="ResWord">bool</span> <span class="ID">b</span> = <span class="ID">object</span> <span class="ID">is</span> <span class="ID">SomeTypeName</span>;</span>
</pre></div></div><span class="anchor" id="line-1598"></span><span class="anchor" id="line-1599"></span><p class="line862">You can get the type information of <tt class="backtick">Object</tt> instances with the <tt class="backtick">get_type()</tt> method: <span class="anchor" id="line-1600"></span><span class="anchor" id="line-1601"></span></p><p class="line867"><span class="anchor" id="line-1602"></span><span class="anchor" id="line-1603"></span><span class="anchor" id="line-1604"></span><span class="anchor" id="line-1-200"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-dd6e117673bceaa36ac028b25529dcba96b99867" lang="en"><span class="line"><span class="anchor" id="line-1-201"></span><span class="ID">Type</span> <span class="ID">type</span> = <span class="ID">object</span>.<span class="ID">get_type</span>();</span>
<span class="line"><span class="anchor" id="line-2-83"></span><span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%s</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">type</span>.<span class="ID">name</span>());</span>
</pre></div></div><span class="anchor" id="line-1605"></span><span class="anchor" id="line-1606"></span><p class="line862">With the <tt class="backtick">typeof()</tt>
 operator you can get the type information of a type directly. From this
 type information you can later create new instances with <tt class="backtick">Object.new()</tt>: <span class="anchor" id="line-1607"></span><span class="anchor" id="line-1608"></span></p><p class="line867"><span class="anchor" id="line-1609"></span><span class="anchor" id="line-1610"></span><span class="anchor" id="line-1611"></span><span class="anchor" id="line-1-202"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b0b8e2d1148b94e01d888489cf5e102d50dd12e3" lang="en"><span class="line"><span class="anchor" id="line-1-203"></span><span class="ID">Type</span> <span class="ID">type</span> = <span class="ID">typeof</span>(<span class="ID">Foo</span>);</span>
<span class="line"><span class="anchor" id="line-2-84"></span><span class="ID">Foo</span> <span class="ID">foo</span> = (<span class="ID">Foo</span>) <span class="ID">Object</span>.<span class="ResWord">new</span>(<span class="ID">type</span>);</span>
</pre></div></div><span class="anchor" id="line-1612"></span><span class="anchor" id="line-1613"></span><p class="line862">Which constructor will be called?  It's the <tt class="backtick">construct&nbsp;{}</tt> block that will be described in the section about gobject-style construction. <span class="anchor" id="line-1614"></span><span class="anchor" id="line-1615"></span></p><p class="line867">
</p><h3 id="Dynamic_Type_Casting">Dynamic Type Casting</h3>
<span class="anchor" id="line-1616"></span><span class="anchor" id="line-1617"></span><p class="line862">For the dynamic cast, a variable is casted by a postfix expression <tt class="backtick">as&nbsp;DesiredTypeName</tt>.  Vala will include a runtime type checking to ensure this casting is reasonable - if it is an illegal casting, <tt class="backtick">null</tt> will be returned.  However, this requires both the source type and the target type to be referenced class types. <span class="anchor" id="line-1618"></span><span class="anchor" id="line-1619"></span></p><p class="line874">For example, <span class="anchor" id="line-1620"></span><span class="anchor" id="line-1621"></span><span class="anchor" id="line-1622"></span><span class="anchor" id="line-1-204"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ab07df1efd9252ceeccd4cf5771d1856f3d361c7" lang="en"><span class="line"><span class="anchor" id="line-1-205"></span><span class="ID">Button</span> <span class="ID">b</span> = <span class="ID">widget</span> <span class="ID">as</span> <span class="ID">Button</span>;</span>
</pre></div></div><span class="anchor" id="line-1623"></span><span class="anchor" id="line-1624"></span><p class="line862">If for some reason the class of the <tt class="backtick">widget</tt> instance is not the Button class or one of its subclasses or does not implement the Button interface, <tt class="backtick">b</tt> will be <tt class="backtick">null</tt>. This cast is equivalent to: <span class="anchor" id="line-1625"></span><span class="anchor" id="line-1626"></span></p><p class="line867"><span class="anchor" id="line-1627"></span><span class="anchor" id="line-1628"></span><span class="anchor" id="line-1-206"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-56701ada2ccb96a29745da634bb4d1ffc12b89a6" lang="en"><span class="line"><span class="anchor" id="line-1-207"></span><span class="ID">Button</span> <span class="ID">b</span> = (<span class="ID">widget</span> <span class="ID">is</span> <span class="ID">Button</span>) ? (<span class="ID">Button</span>) <span class="ID">widget</span> : <span class="ID">null</span>;</span>
</pre></div></div><span class="anchor" id="line-1629"></span><span class="anchor" id="line-1630"></span><p class="line867">
</p><h3 id="Generics">Generics</h3>
<span class="anchor" id="line-1631"></span><span class="anchor" id="line-1632"></span><p class="line874">Vala
 includes a runtime generics system, by which a particular instance of a
 class can be restricted with a particular type or set of types chosen 
at construction time.  This restriction is generally used to require 
that data stored in the object must be of a particular type, for example
 in order to implement a list of objects of a certain type.  In that 
example, Vala would make sure that only objects of the requested type 
could be added to the list, and that on retrieval all objects would be 
cast to that type. <span class="anchor" id="line-1633"></span><span class="anchor" id="line-1634"></span></p><p class="line874">In
 Vala, generics are handled while the program is running.  When you 
define a class that can be restricted by a type, there still exists only
 one class, with each instance customised individually.  This is in 
contrast to C++ which creates a new class for each type restriction 
required - Vala's is similar to the system used by Java.  This has 
various consequences, most importantly: that static members are shared 
by the type as a whole, regardless of the restrictions placed on each 
instance; and that given a class and a subclass, a generic refined by 
the subclass can be used as a generic refined by the class. <span class="anchor" id="line-1635"></span><span class="anchor" id="line-1636"></span></p><p class="line874">The following code demonstrates how to use the generics system to define a minimal wrapper class: <span class="anchor" id="line-1637"></span><span class="anchor" id="line-1638"></span></p><p class="line867"><span class="anchor" id="line-1639"></span><span class="anchor" id="line-1640"></span><span class="anchor" id="line-1641"></span><span class="anchor" id="line-1642"></span><span class="anchor" id="line-1643"></span><span class="anchor" id="line-1644"></span><span class="anchor" id="line-1645"></span><span class="anchor" id="line-1646"></span><span class="anchor" id="line-1647"></span><span class="anchor" id="line-1648"></span><span class="anchor" id="line-1649"></span><span class="anchor" id="line-1650"></span><span class="anchor" id="line-1-208"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-3f4293942defc34ea603458beac6f95cdd936364" lang="en"><span class="line"><span class="anchor" id="line-1-209"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Wrapper</span>&lt;<span class="ID">G</span>&gt; : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-85"></span>    <span class="ResWord">private</span> <span class="ID">G</span> <span class="ID">data</span>;</span>
<span class="line"><span class="anchor" id="line-3-67"></span></span>
<span class="line"><span class="anchor" id="line-4-53"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">set_data</span>(<span class="ID">G</span> <span class="ID">data</span>) {</span>
<span class="line"><span class="anchor" id="line-5-43"></span>        <span class="ResWord">this</span>.<span class="ID">data</span> = <span class="ID">data</span>;</span>
<span class="line"><span class="anchor" id="line-6-36"></span>    }</span>
<span class="line"><span class="anchor" id="line-7-34"></span></span>
<span class="line"><span class="anchor" id="line-8-30"></span>    <span class="ResWord">public</span> <span class="ID">G</span> <span class="ID">get_data</span>() {</span>
<span class="line"><span class="anchor" id="line-9-29"></span>        <span class="ResWord">return</span> <span class="ResWord">this</span>.<span class="ID">data</span>;</span>
<span class="line"><span class="anchor" id="line-10-24"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-22"></span>}</span>
</pre></div></div><span class="anchor" id="line-1651"></span><span class="anchor" id="line-1652"></span><p class="line874">This
 "Wrapper" class must be restricted with a type in order to instantiate 
it - in this case the type will be identified as "G", and so instances 
of this class will store one object of "G" type, and have methods to set
 or get that object.  (The reason for this specific example is to 
provide reason explain that currently a generic class cannot use 
properties of its restriction type, and so this class has simple get and
 set methods instead.) <span class="anchor" id="line-1653"></span><span class="anchor" id="line-1654"></span></p><p class="line862">In order to instantiate this class, a type must be chosen, for example the built in <tt class="backtick">string</tt> type (in Vala there is no restriction on what type may be used in a generic).  To create an briefly use this class: <span class="anchor" id="line-1655"></span><span class="anchor" id="line-1656"></span></p><p class="line867"><span class="anchor" id="line-1657"></span><span class="anchor" id="line-1658"></span><span class="anchor" id="line-1659"></span><span class="anchor" id="line-1660"></span><span class="anchor" id="line-1-210"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a87561406f84cdcbf951cd99f6caff500c0f7bbe" lang="en"><span class="line"><span class="anchor" id="line-1-211"></span><span class="ID">var</span> <span class="ID">wrapper</span> = <span class="ResWord">new</span> <span class="ID">Wrapper</span>&lt;<span class="ID">string</span>&gt;();</span>
<span class="line"><span class="anchor" id="line-2-86"></span><span class="ID">wrapper</span>.<span class="ID">set_data</span>(<span class="String">"</span><span class="String">test</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-68"></span><span class="ID">var</span> <span class="ID">data</span> = <span class="ID">wrapper</span>.<span class="ID">get_data</span>();</span>
</pre></div></div><span class="anchor" id="line-1661"></span><span class="anchor" id="line-1662"></span><p class="line874">As
 you can see, when the data is retrieved from the wrapper, it is 
assigned to an identifier with no explicit type.  This is possible 
because Vala knows what sort of objects are in each wrapper instance, 
and therefore can do this work for you. <span class="anchor" id="line-1663"></span><span class="anchor" id="line-1664"></span></p><p class="line874">The fact that Vala does not create multiple classes out of your generic definition means that you can code as follows: <span class="anchor" id="line-1665"></span><span class="anchor" id="line-1666"></span></p><p class="line867"><span class="anchor" id="line-1667"></span><span class="anchor" id="line-1668"></span><span class="anchor" id="line-1669"></span><span class="anchor" id="line-1670"></span><span class="anchor" id="line-1671"></span><span class="anchor" id="line-1672"></span><span class="anchor" id="line-1673"></span><span class="anchor" id="line-1674"></span><span class="anchor" id="line-1675"></span><span class="anchor" id="line-1676"></span><span class="anchor" id="line-1677"></span><span class="anchor" id="line-1-212"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-9930bc3c902135af501f4e7d06683a4f8a4ccb79" lang="en"><span class="line"><span class="anchor" id="line-1-213"></span><span class="ResWord">class</span> <span class="ID">TestClass</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-87"></span>}</span>
<span class="line"><span class="anchor" id="line-3-69"></span></span>
<span class="line"><span class="anchor" id="line-4-54"></span><span class="ResWord">void</span> <span class="ID">accept_object_wrapper</span>(<span class="ID">Wrapper</span>&lt;<span class="ID">Glib</span>.<span class="ID">Object</span>&gt; <span class="ID">w</span>) {</span>
<span class="line"><span class="anchor" id="line-5-44"></span>}</span>
<span class="line"><span class="anchor" id="line-6-37"></span></span>
<span class="line"><span class="anchor" id="line-7-35"></span>...</span>
<span class="line"><span class="anchor" id="line-8-31"></span><span class="ID">var</span> <span class="ID">test_wrapper</span> = <span class="ResWord">new</span> <span class="ID">Wrapper</span>&lt;<span class="ID">TestClass</span>&gt;();</span>
<span class="line"><span class="anchor" id="line-9-30"></span><span class="ID">accept_object_wrapper</span>(<span class="ID">test_wrapper</span>);</span>
<span class="line"><span class="anchor" id="line-10-25"></span>...</span>
</pre></div></div><span class="anchor" id="line-1678"></span><span class="anchor" id="line-1679"></span><p class="line862">Since all "Test<tt class="backtick"></tt>Class" instances are also <tt class="backtick">Object</tt>s,
 the "accept_object_wrapper" method will happily accept the object it is
 passed, and treat its wrapped object as though it was a <tt class="backtick">GLib.Object</tt> instance. <span class="anchor" id="line-1680"></span><span class="anchor" id="line-1681"></span></p><p class="line867">
</p><h3 id="GObject-Style_Construction">GObject-Style Construction</h3>
<span class="anchor" id="line-1682"></span><span class="anchor" id="line-1683"></span><p class="line862">As
 pointed out before, Vala supports an alternative construction scheme 
that is slightly different to the one described before, but closer to 
the way GObject construction works.  Which one you prefer depends on 
whether you come from the GObject side or from the Java or C# side.  The
 gobject-style construction scheme introduces some new syntax elements: <em>construct properties</em>, a special <tt class="backtick">Object(...)</tt> call and a <tt class="backtick">construct</tt> block.  Let's take a look at how this works: <span class="anchor" id="line-1684"></span><span class="anchor" id="line-1685"></span></p><p class="line867"><span class="anchor" id="line-1686"></span><span class="anchor" id="line-1687"></span><span class="anchor" id="line-1688"></span><span class="anchor" id="line-1689"></span><span class="anchor" id="line-1690"></span><span class="anchor" id="line-1691"></span><span class="anchor" id="line-1692"></span><span class="anchor" id="line-1693"></span><span class="anchor" id="line-1694"></span><span class="anchor" id="line-1695"></span><span class="anchor" id="line-1696"></span><span class="anchor" id="line-1697"></span><span class="anchor" id="line-1698"></span><span class="anchor" id="line-1699"></span><span class="anchor" id="line-1700"></span><span class="anchor" id="line-1701"></span><span class="anchor" id="line-1702"></span><span class="anchor" id="line-1703"></span><span class="anchor" id="line-1704"></span><span class="anchor" id="line-1705"></span><span class="anchor" id="line-1-214"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-3ac2c3d1a1b6f276c0f33e7c71531dfef8d068c6" lang="en"><span class="line"><span class="anchor" id="line-1-215"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Person</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-88"></span></span>
<span class="line"><span class="anchor" id="line-3-70"></span>    <span class="Comment">/* Construction properties */</span></span>
<span class="line"><span class="anchor" id="line-4-55"></span>    <span class="ResWord">public</span> <span class="ID">string</span> <span class="ID">name</span> { <span class="ID">get</span>; <span class="ID">construct</span>; }</span>
<span class="line"><span class="anchor" id="line-5-45"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">age</span> { <span class="ID">get</span>; <span class="ID">construct</span> <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-6-38"></span></span>
<span class="line"><span class="anchor" id="line-7-36"></span>    <span class="ResWord">public</span> <span class="ID">Person</span>(<span class="ID">string</span> <span class="ID">name</span>) {</span>
<span class="line"><span class="anchor" id="line-8-32"></span>        <span class="ID">Object</span>(<span class="ID">name:</span> <span class="ID">name</span>);</span>
<span class="line"><span class="anchor" id="line-9-31"></span>    }</span>
<span class="line"><span class="anchor" id="line-10-26"></span></span>
<span class="line"><span class="anchor" id="line-11-23"></span>    <span class="ResWord">public</span> <span class="ID">Person</span>.<span class="ID">with_age</span>(<span class="ID">string</span> <span class="ID">name</span>, <span class="ResWord">int</span> <span class="ID">years</span>) {</span>
<span class="line"><span class="anchor" id="line-12-18"></span>        <span class="ID">Object</span>(<span class="ID">name:</span> <span class="ID">name</span>, <span class="ID">age:</span> <span class="ID">years</span>);</span>
<span class="line"><span class="anchor" id="line-13-17"></span>    }</span>
<span class="line"><span class="anchor" id="line-14-16"></span></span>
<span class="line"><span class="anchor" id="line-15-14"></span>    <span class="ID">construct</span> {</span>
<span class="line"><span class="anchor" id="line-16-12"></span>        <span class="Comment">// do anything else</span></span>
<span class="line"><span class="anchor" id="line-17-10"></span><span class="Comment"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Welcome %s</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ResWord">this</span>.<span class="ID">name</span>);</span>
<span class="line"><span class="anchor" id="line-18-8"></span>    }</span>
<span class="line"><span class="anchor" id="line-19-6"></span>}</span>
</pre></div></div><span class="anchor" id="line-1706"></span><span class="anchor" id="line-1707"></span><p class="line862">With the gobject-style construction scheme each construction method only contains an <tt class="backtick">Object(...)</tt> call for setting so-called <em>construct properties</em>.  The <tt class="backtick">Object(...)</tt> call takes a variable number of named arguments in the form of <tt class="backtick">property:&nbsp;value</tt>.  These properties must be declared as <tt class="backtick">construct</tt> or <tt class="backtick">set</tt> properties.  They will be set to the given values and afterwards all <tt class="backtick">construct&nbsp;{}</tt> blocks in the hierarchy from <em>GLib.Object</em> down to our class will be called. <span class="anchor" id="line-1708"></span><span class="anchor" id="line-1709"></span></p><p class="line862">The <tt class="backtick">construct</tt>
 block is guaranteed to be called when an instance of this class is 
created, even if it is created as a subtype.  It does neither have any 
parameters, nor a return value.  Within this block you can call other 
methods and set member variables as needed. <span class="anchor" id="line-1710"></span><span class="anchor" id="line-1711"></span></p><p class="line862">Construct properties are defined just as <tt class="backtick">get</tt> and <tt class="backtick">set</tt>
 properties, and therefore can run arbitrary code on assignment.  If you
 need to do initialisation based on a single construct property, it is 
possible to write a custom <tt class="backtick">construct</tt> block for the property, which will be executed immediately on assignment, and before any other construction code. <span class="anchor" id="line-1712"></span><span class="anchor" id="line-1713"></span></p><p class="line862">If a construct property is declared without <tt class="backtick">set</tt> it is a so-called <em>construct only</em> property, which means it can only be assigned on construction, but no longer afterwards. In the example above <em>name</em> is such a construct only property. <span class="anchor" id="line-1714"></span><span class="anchor" id="line-1715"></span></p><p class="line874">Here's
 a summary of the various types of properties together with the 
nomenclature usually found in the documentation of gobject-based 
libraries: <span class="anchor" id="line-1716"></span><span class="anchor" id="line-1717"></span></p><p class="line867"><span class="anchor" id="line-1718"></span><span class="anchor" id="line-1719"></span><span class="anchor" id="line-1720"></span><span class="anchor" id="line-1721"></span><span class="anchor" id="line-1722"></span><span class="anchor" id="line-1723"></span><span class="anchor" id="line-1-216"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-2e46f6e48526b255b75defd02629e385c49b1331" lang="en"><span class="line"><span class="anchor" id="line-1-217"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">a</span> { <span class="ID">get</span>; <span class="ResWord">private</span> <span class="ID">set</span>; }    <span class="Comment">// Read</span></span>
<span class="line"><span class="anchor" id="line-2-89"></span><span class="Comment"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">b</span> { <span class="ResWord">private</span> <span class="ID">get</span>; <span class="ID">set</span>; }    <span class="Comment">// Write</span></span>
<span class="line"><span class="anchor" id="line-3-71"></span><span class="Comment"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">c</span> { <span class="ID">get</span>; <span class="ID">set</span>; }            <span class="Comment">// Read / Write</span></span>
<span class="line"><span class="anchor" id="line-4-56"></span><span class="Comment"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">d</span> { <span class="ID">get</span>; <span class="ID">set</span> <span class="ID">construct</span>; }  <span class="Comment">// Read / Write / Construct</span></span>
<span class="line"><span class="anchor" id="line-5-46"></span><span class="Comment"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">e</span> { <span class="ID">get</span>; <span class="ID">construct</span>; }      <span class="Comment">// Read / Write-Construct-Only</span></span>
<span class="line"><span class="anchor" id="line-6-39"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-1724"></span><span class="anchor" id="line-1725"></span><p class="line862">In
 some cases you may also want to perform some action - not when 
instances of a class is created - but when the class itself is created 
by the GObject runtime. In GObject terminology we are talking about a 
snippet of code run inside the <tt>class_init</tt> function for the class in question. In Java this is known as <em>static initializer blocks</em>. In Vala this looks like: <span class="anchor" id="line-1726"></span><span class="anchor" id="line-1727"></span></p><p class="line867"><span class="anchor" id="line-1728"></span><span class="anchor" id="line-1729"></span><span class="anchor" id="line-1730"></span><span class="anchor" id="line-1731"></span><span class="anchor" id="line-1732"></span><span class="anchor" id="line-1733"></span><span class="anchor" id="line-1-218"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-3d6ccc47ea7b9dd37b6582808c91cf804011d1dd" lang="en"><span class="line"><span class="anchor" id="line-1-219"></span>    <span class="Comment">/* This snippet of code is run when the class</span></span>
<span class="line"><span class="anchor" id="line-2-90"></span><span class="Comment">     * is registered with the type system */</span></span>
<span class="line"><span class="anchor" id="line-3-72"></span>    <span class="ResWord">static</span> <span class="ID">construct</span> {</span>
<span class="line"><span class="anchor" id="line-4-57"></span>      ...</span>
<span class="line"><span class="anchor" id="line-5-47"></span>    }</span>
</pre></div></div><span class="anchor" id="line-1734"></span><span class="anchor" id="line-1735"></span><p class="line867">
</p><h2 id="Advanced_Features">Advanced Features</h2>
<span class="anchor" id="line-1736"></span><span class="anchor" id="line-1737"></span><p class="line867">
</p><h3 id="Assertions_and_Contract_Programming">Assertions and Contract Programming</h3>
<span class="anchor" id="line-1738"></span><span class="anchor" id="line-1739"></span><p class="line862">With <em>assertions</em> a programmer can check assumptions at runtime.  The syntax is <tt class="backtick">assert(</tt><em>condition</em><tt class="backtick">)</tt>.
  If an assertion fails the program will terminate with an appropriate 
error message.  There are a few more assertion methods within the GLib 
standard namespace, e.g.: <span class="anchor" id="line-1740"></span><span class="anchor" id="line-1741"></span></p><div><table><tbody><tr>  <td><p class="line862">assert_not_reached()</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1742"></span><p class="line862">return_if_fail(bool expr)</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1743"></span><p class="line862">return_if_reached()</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1744"></span><p class="line862">warn_if_fail(bool expr)</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1745"></span><p class="line862">warn_if_reached()</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-1746"></span><span class="anchor" id="line-1747"></span><p class="line862">You might be tempted to use assertions in order to check method arguments for <tt class="backtick">null</tt>.  However, this is not necessary, since Vala does that implicitly for all parameters that are not marked with <tt class="backtick">?</tt> as being <em>nullable</em>. <span class="anchor" id="line-1748"></span><span class="anchor" id="line-1749"></span></p><p class="line867"><span class="anchor" id="line-1750"></span><span class="anchor" id="line-1751"></span><span class="anchor" id="line-1752"></span><span class="anchor" id="line-1753"></span><span class="anchor" id="line-1754"></span><span class="anchor" id="line-1755"></span><span class="anchor" id="line-1756"></span><span class="anchor" id="line-1-220"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-9825dd1bf888a57a9a186f64e32abd984a8585bd" lang="en"><span class="line"><span class="anchor" id="line-1-221"></span><span class="ResWord">void</span> <span class="ID">method_name</span>(<span class="ID">Foo</span> <span class="ID">foo</span>, <span class="ID">Bar</span> <span class="ID">bar</span>) {</span>
<span class="line"><span class="anchor" id="line-2-91"></span>    <span class="Comment">/* Not necessary, Vala does that for you:</span></span>
<span class="line"><span class="anchor" id="line-3-73"></span><span class="Comment">    return_if_fail(foo != null);</span></span>
<span class="line"><span class="anchor" id="line-4-58"></span><span class="Comment">    return_if_fail(bar != null);</span></span>
<span class="line"><span class="anchor" id="line-5-48"></span><span class="Comment">    */</span></span>
<span class="line"><span class="anchor" id="line-6-40"></span>}</span>
</pre></div></div><span class="anchor" id="line-1757"></span><span class="anchor" id="line-1758"></span><p class="line862">Vala supports basic <a class="http" href="http://en.wikipedia.org/wiki/Contract_programming">contract programming</a> features.  A method may have preconditions (<tt class="backtick">requires</tt>) and postconditions (<tt class="backtick">ensures</tt>) that must be fulfilled at the beginning or the end of a method respectively: <span class="anchor" id="line-1759"></span><span class="anchor" id="line-1760"></span></p><p class="line867"><span class="anchor" id="line-1761"></span><span class="anchor" id="line-1762"></span><span class="anchor" id="line-1763"></span><span class="anchor" id="line-1764"></span><span class="anchor" id="line-1765"></span><span class="anchor" id="line-1766"></span><span class="anchor" id="line-1767"></span><span class="anchor" id="line-1768"></span><span class="anchor" id="line-1-222"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-dbfa84d140c60174fd65eceeb713fdb92395dc8c" lang="en"><span class="line"><span class="anchor" id="line-1-223"></span><span class="ResWord">double</span> <span class="ID">method_name</span>(<span class="ResWord">int</span> <span class="ID">x</span>, <span class="ResWord">double</span> <span class="ID">d</span>)</span>
<span class="line"><span class="anchor" id="line-2-92"></span>        <span class="ID">requires</span> (<span class="ID">x</span> &gt; <span class="Number">0</span> &amp;&amp; <span class="ID">x</span> &lt; <span class="Number">10</span>)</span>
<span class="line"><span class="anchor" id="line-3-74"></span>        <span class="ID">requires</span> (<span class="ID">d</span> &gt;= <span class="Number">0.0</span> &amp;&amp; <span class="ID">d</span> &lt;= <span class="Number">1.0</span>)</span>
<span class="line"><span class="anchor" id="line-4-59"></span>        <span class="ID">ensures</span> (<span class="ID">result</span> &gt;= <span class="Number">0.0</span> &amp;&amp; <span class="ID">result</span> &lt;= <span class="Number">10.0</span>)</span>
<span class="line"><span class="anchor" id="line-5-49"></span>{</span>
<span class="line"><span class="anchor" id="line-6-41"></span>    <span class="ResWord">return</span> <span class="ID">d</span> * <span class="ID">x</span>;</span>
<span class="line"><span class="anchor" id="line-7-37"></span>}</span>
</pre></div></div><span class="anchor" id="line-1769"></span><span class="anchor" id="line-1770"></span><p class="line867"><tt class="backtick">result</tt> is a special variable representing the return value. <span class="anchor" id="line-1771"></span><span class="anchor" id="line-1772"></span></p><p class="line867">
</p><h3 id="Error_Handling">Error Handling</h3>
<span class="anchor" id="line-1773"></span><span class="anchor" id="line-1774"></span><p class="line874">GLib
 has a system for managing runtime exceptions called GError.  Vala 
translates this into a form familiar to modern programming languages, 
but its implementation means it is not quite the same as in Java or C#. 
 It is important to consider when to use this type of error handling - 
GError is very specifically designed to deal with recoverable runtime 
errors, i.e. factors that are not known until the program is run on a 
live system, and that are not fatal to the execution.  You should not 
use GError for problems that can be foreseen, such as reporting that an 
invalid value has been passed to a method.  If a method, for example, 
requires a number greater than 0 as a parameter, it should fail on 
negative values using contract programming techniques such as 
preconditions or assertions described in the previous section. <span class="anchor" id="line-1775"></span><span class="anchor" id="line-1776"></span></p><p class="line862">Vala errors are so-called <em>checked exceptions</em>,
 which means that errors must get handled at some point.  However, if 
you don't catch an error the Vala compiler will only issue a warning 
without stopping the compilation process. <span class="anchor" id="line-1777"></span><span class="anchor" id="line-1778"></span></p><p class="line862">Using exceptions (or <em>errors</em> in Vala terminology) is a matter of: <span class="anchor" id="line-1779"></span><span class="anchor" id="line-1780"></span></p><p class="line874">1) Declaring that a method may raise an error: <span class="anchor" id="line-1781"></span><span class="anchor" id="line-1782"></span></p><p class="line867"><span class="anchor" id="line-1783"></span><span class="anchor" id="line-1784"></span><span class="anchor" id="line-1785"></span><span class="anchor" id="line-1786"></span><span class="anchor" id="line-1-224"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-9bf2846b53fee92fe76688fddc43c71c693ec321" lang="en"><span class="line"><span class="anchor" id="line-1-225"></span><span class="ResWord">void</span> <span class="ID">my_method</span>() <span class="ResWord">throws</span> <span class="ID">IOError</span> {</span>
<span class="line"><span class="anchor" id="line-2-93"></span>    <span class="Comment">// ...</span></span>
<span class="line"><span class="anchor" id="line-3-75"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-1787"></span><span class="anchor" id="line-1788"></span><p class="line874">2) Throwing the error when appropriate: <span class="anchor" id="line-1789"></span><span class="anchor" id="line-1790"></span></p><p class="line867"><span class="anchor" id="line-1791"></span><span class="anchor" id="line-1792"></span><span class="anchor" id="line-1793"></span><span class="anchor" id="line-1794"></span><span class="anchor" id="line-1-226"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-dd9d6ede7b4540553ad8d11900720d0f44593d14" lang="en"><span class="line"><span class="anchor" id="line-1-227"></span><span class="ResWord">if</span> (<span class="ID">something_went_wrong</span>) {</span>
<span class="line"><span class="anchor" id="line-2-94"></span>    <span class="ResWord">throw</span> <span class="ResWord">new</span> <span class="ID">IOError</span>.<span class="ID">FILE_NOT_FOUND</span>(<span class="String">"</span><span class="String">Requested file could not be found.</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-76"></span>}</span>
</pre></div></div><span class="anchor" id="line-1795"></span><span class="anchor" id="line-1796"></span><p class="line874">3) Catching the error from the calling code: <span class="anchor" id="line-1797"></span><span class="anchor" id="line-1798"></span></p><p class="line867"><span class="anchor" id="line-1799"></span><span class="anchor" id="line-1800"></span><span class="anchor" id="line-1801"></span><span class="anchor" id="line-1802"></span><span class="anchor" id="line-1803"></span><span class="anchor" id="line-1804"></span><span class="anchor" id="line-1-228"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-9006cb4747ec029f921050b60d9439f9b439cbcf" lang="en"><span class="line"><span class="anchor" id="line-1-229"></span><span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-2-95"></span>    <span class="ID">my_method</span>();</span>
<span class="line"><span class="anchor" id="line-3-77"></span>} <span class="ResWord">catch</span> (<span class="ID">IOError</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-4-60"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Error: %s</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">e</span>.<span class="ID">message</span>);</span>
<span class="line"><span class="anchor" id="line-5-50"></span>}</span>
</pre></div></div><span class="anchor" id="line-1805"></span><span class="anchor" id="line-1806"></span><p class="line874">4) Comparing error code by "is" operator <span class="anchor" id="line-1807"></span><span class="anchor" id="line-1808"></span><span class="anchor" id="line-1809"></span><span class="anchor" id="line-1810"></span><span class="anchor" id="line-1811"></span><span class="anchor" id="line-1812"></span><span class="anchor" id="line-1813"></span><span class="anchor" id="line-1814"></span><span class="anchor" id="line-1815"></span><span class="anchor" id="line-1816"></span><span class="anchor" id="line-1817"></span><span class="anchor" id="line-1-230"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1188681a5d25e11371501f47713838e9cdf3707f" lang="en"><span class="line"><span class="anchor" id="line-1-231"></span><span class="ID">IOChannel</span> <span class="ID">channel</span>;</span>
<span class="line"><span class="anchor" id="line-2-96"></span><span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-3-78"></span>    <span class="ID">channel</span> = <span class="ResWord">new</span> <span class="ID">IOChannel</span>.<span class="ID">file</span>(<span class="String">"</span><span class="String">/tmp/my_lock</span><span class="String">"</span>, <span class="String">"</span><span class="String">w</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-4-61"></span>} <span class="ResWord">catch</span> (<span class="ID">FileError</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-5-51"></span>    <span class="ResWord">if</span>(<span class="ID">e</span> <span class="ID">is</span> <span class="ID">FileError</span>.<span class="ID">EXIST</span>) {</span>
<span class="line"><span class="anchor" id="line-6-42"></span>        <span class="ResWord">throw</span> <span class="ID">e</span>;</span>
<span class="line"><span class="anchor" id="line-7-38"></span>    }</span>
<span class="line"><span class="anchor" id="line-8-33"></span>    <span class="ID">GLib</span>.<span class="ID">error</span>(<span class="String">"</span><span class="String">"</span>, <span class="ID">e</span>.<span class="ID">message</span>);</span>
<span class="line"><span class="anchor" id="line-9-32"></span>}</span>
</pre></div></div><span class="anchor" id="line-1818"></span><span class="anchor" id="line-1819"></span><p class="line862">All
 this appears more or less as in other languages, but defining the types
 of errors allowed is fairly unique.  Errors have three components, 
known as "domain", "code" and message.  Messages we have already seen, 
it is simply a piece of text provided when the error is created.  Error 
domains describe the type of problem, and equates to a subclass of 
"Exception" in Java or similar.  In the above examples we imagined an 
error domain called "I<tt class="backtick"></tt>O<tt class="backtick"></tt>Error".
  The third part, the error code is a refinement describing the exact 
variety of problem encountered.  Each error domain has one or more error
 codes - in the example there is a code called "FILE_NOT_FOUND". <span class="anchor" id="line-1820"></span><span class="anchor" id="line-1821"></span></p><p class="line874">The
 way to define this information about error types is related to the 
implementation in glib.  In order for the examples here to work, a 
definition is needed such as: <span class="anchor" id="line-1822"></span><span class="anchor" id="line-1823"></span></p><p class="line867"><span class="anchor" id="line-1824"></span><span class="anchor" id="line-1825"></span><span class="anchor" id="line-1826"></span><span class="anchor" id="line-1827"></span><span class="anchor" id="line-1-232"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-305c4ca2bbd559ca4b0ece784e2f4b3200faaf39" lang="en"><span class="line"><span class="anchor" id="line-1-233"></span><span class="ID">errordomain</span> <span class="ID">IOError</span> {</span>
<span class="line"><span class="anchor" id="line-2-97"></span>    <span class="ID">FILE_NOT_FOUND</span></span>
<span class="line"><span class="anchor" id="line-3-79"></span>}</span>
</pre></div></div><span class="anchor" id="line-1828"></span><span class="anchor" id="line-1829"></span><p class="line862">When
 catching an error, you give the error domain you wish to catch errors 
in, and if an error in that domain is thrown, the code in the handler is
 run with the error assigned to the supplied name.  From that error 
object you can extract the error code and message as needed.  If you 
want to catch errors from more than one domain, simply provide extra <tt class="backtick">catch</tt> blocks.  There is also an optional block that can be placed after a <tt class="backtick">try</tt> and any <tt class="backtick">catch</tt> blocks, called <tt class="backtick">finally</tt>.
  This code is to be run always at the end of the section, regardless of
 whether an error was thrown or any catch blocks were executed, even if 
the error was in fact no handled and will be thrown again.  This allows,
 for example, any resources reserved in the try block be freed 
regardless of any errors raised.  A complete example of these features: <span class="anchor" id="line-1830"></span><span class="anchor" id="line-1831"></span></p><p class="line867"><span class="anchor" id="line-1832"></span><span class="anchor" id="line-1833"></span><span class="anchor" id="line-1834"></span><span class="anchor" id="line-1835"></span><span class="anchor" id="line-1836"></span><span class="anchor" id="line-1837"></span><span class="anchor" id="line-1838"></span><span class="anchor" id="line-1839"></span><span class="anchor" id="line-1840"></span><span class="anchor" id="line-1841"></span><span class="anchor" id="line-1842"></span><span class="anchor" id="line-1843"></span><span class="anchor" id="line-1844"></span><span class="anchor" id="line-1845"></span><span class="anchor" id="line-1846"></span><span class="anchor" id="line-1847"></span><span class="anchor" id="line-1848"></span><span class="anchor" id="line-1849"></span><span class="anchor" id="line-1850"></span><span class="anchor" id="line-1851"></span><span class="anchor" id="line-1852"></span><span class="anchor" id="line-1853"></span><span class="anchor" id="line-1854"></span><span class="anchor" id="line-1855"></span><span class="anchor" id="line-1856"></span><span class="anchor" id="line-1857"></span><span class="anchor" id="line-1858"></span><span class="anchor" id="line-1859"></span><span class="anchor" id="line-1860"></span><span class="anchor" id="line-1861"></span><span class="anchor" id="line-1862"></span><span class="anchor" id="line-1863"></span><span class="anchor" id="line-1864"></span><span class="anchor" id="line-1865"></span><span class="anchor" id="line-1866"></span><span class="anchor" id="line-1867"></span><span class="anchor" id="line-1868"></span><span class="anchor" id="line-1-234"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-eed98f91b5c23216b05cd2e4a921f6bce77e5af4" lang="en"><span class="line"><span class="anchor" id="line-1-235"></span><span class="ResWord">public</span> <span class="ID">errordomain</span> <span class="ID">ErrorType1</span> {</span>
<span class="line"><span class="anchor" id="line-2-98"></span>    <span class="ID">CODE_1A</span></span>
<span class="line"><span class="anchor" id="line-3-80"></span>}</span>
<span class="line"><span class="anchor" id="line-4-62"></span></span>
<span class="line"><span class="anchor" id="line-5-52"></span><span class="ResWord">public</span> <span class="ID">errordomain</span> <span class="ID">ErrorType2</span> {</span>
<span class="line"><span class="anchor" id="line-6-43"></span>    <span class="ID">CODE_2A</span>,</span>
<span class="line"><span class="anchor" id="line-7-39"></span>    <span class="ID">CODE_2B</span></span>
<span class="line"><span class="anchor" id="line-8-34"></span>}</span>
<span class="line"><span class="anchor" id="line-9-33"></span></span>
<span class="line"><span class="anchor" id="line-10-27"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Test</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-11-24"></span>    <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">void</span> <span class="ID">thrower</span>() <span class="ResWord">throws</span> <span class="ID">ErrorType1</span>, <span class="ID">ErrorType2</span> {</span>
<span class="line"><span class="anchor" id="line-12-19"></span>        <span class="ResWord">throw</span> <span class="ResWord">new</span> <span class="ID">ErrorType1</span>.<span class="ID">CODE_1A</span>(<span class="String">"</span><span class="String">Error</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-13-18"></span>    }</span>
<span class="line"><span class="anchor" id="line-14-17"></span></span>
<span class="line"><span class="anchor" id="line-15-15"></span>    <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">void</span> <span class="ID">catcher</span>() <span class="ResWord">throws</span> <span class="ID">ErrorType2</span> {</span>
<span class="line"><span class="anchor" id="line-16-13"></span>        <span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-17-11"></span>            <span class="ID">thrower</span>();</span>
<span class="line"><span class="anchor" id="line-18-9"></span>        } <span class="ResWord">catch</span> (<span class="ID">ErrorType1</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-19-7"></span>            <span class="Comment">// Deal with ErrorType1</span></span>
<span class="line"><span class="anchor" id="line-20-6"></span><span class="Comment"></span>        } <span class="ID">finally</span> {</span>
<span class="line"><span class="anchor" id="line-21-6"></span>            <span class="Comment">// Tidy up</span></span>
<span class="line"><span class="anchor" id="line-22-5"></span><span class="Comment"></span>        }</span>
<span class="line"><span class="anchor" id="line-23-3"></span>    }</span>
<span class="line"><span class="anchor" id="line-24-3"></span></span>
<span class="line"><span class="anchor" id="line-25-3"></span>    <span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">int</span> <span class="ID">main</span>(<span class="ID">string</span>[] <span class="ID">args</span>) {</span>
<span class="line"><span class="anchor" id="line-26-3"></span>        <span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-27-3"></span>            <span class="ID">catcher</span>();</span>
<span class="line"><span class="anchor" id="line-28-3"></span>        } <span class="ResWord">catch</span> (<span class="ID">ErrorType2</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-29-3"></span>            <span class="Comment">// Deal with ErrorType2</span></span>
<span class="line"><span class="anchor" id="line-30-3"></span><span class="Comment"></span>            <span class="ResWord">if</span> (<span class="ID">e</span> <span class="ID">is</span> <span class="ID">ErrorType2</span>.<span class="ID">CODE_2B</span>) {</span>
<span class="line"><span class="anchor" id="line-31-3"></span>                <span class="Comment">// Deal with this code</span></span>
<span class="line"><span class="anchor" id="line-32-3"></span><span class="Comment"></span>            }</span>
<span class="line"><span class="anchor" id="line-33-3"></span>        }</span>
<span class="line"><span class="anchor" id="line-34-3"></span>        <span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-35-3"></span>    }</span>
<span class="line"><span class="anchor" id="line-36-3"></span>}</span>
</pre></div></div><span class="anchor" id="line-1869"></span><span class="anchor" id="line-1870"></span><p class="line874">This
 example has two error domains, both of which can be thrown by the 
"thrower" method.  Catcher can only throw the second type of error, and 
so must handle the first type if "thrower" throws it.  Finally the 
"main" method will handle any errors from "catcher". <span class="anchor" id="line-1871"></span><span class="anchor" id="line-1872"></span></p><p class="line867">
</p><h3 id="Parameter_Directions">Parameter Directions</h3>
<span class="anchor" id="line-1873"></span><span class="anchor" id="line-1874"></span><p class="line874">A method in Vala is passed zero or more arguments.  The default behaviour when a method is called is as follows: <span class="anchor" id="line-1875"></span></p><ul><li>Any value type parameters are copied to a location local to the method as it executes. <span class="anchor" id="line-1876"></span></li><li>Any reference type parameters are not copied, instead just a reference to them is passed to the method. <span class="anchor" id="line-1877"></span><span class="anchor" id="line-1878"></span></li></ul><p class="line874">This behaviour can be changed with the modifiers 'ref' and 'out'. <span class="anchor" id="line-1879"></span><span class="anchor" id="line-1880"></span></p><dl><dt>'out' from the caller side</dt><dd>you may pass an uninitialised variable to the method and you may expect it to be initialised after the method returns <span class="anchor" id="line-1881"></span></dd><dt>'out' from callee side</dt><dd>the parameter is considered uninitialised and you have to initialise it <span class="anchor" id="line-1882"></span></dd><dt>'ref' from caller side</dt><dd>the variable you're passing to the method has to be initialised and it may be changed or not by the method <span class="anchor" id="line-1883"></span></dd><dt>'ref' from callee side</dt><dd>the parameter is considered initialised and you may change it or not <span class="anchor" id="line-1884"></span><span class="anchor" id="line-1885"></span></dd></dl><p class="line867"><span class="anchor" id="line-1886"></span><span class="anchor" id="line-1887"></span><span class="anchor" id="line-1888"></span><span class="anchor" id="line-1-236"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-3e238eeda19c75109fc8d3e5e2e7d00906beedd1" lang="en"><span class="line"><span class="anchor" id="line-1-237"></span><span class="ResWord">void</span> <span class="ID">method_1</span>(<span class="ResWord">int</span> <span class="ID">a</span>, <span class="ID">out</span> <span class="ResWord">int</span> <span class="ID">b</span>, <span class="ID">ref</span> <span class="ResWord">int</span> <span class="ID">c</span>) { ... }</span>
<span class="line"><span class="anchor" id="line-2-99"></span><span class="ResWord">void</span> <span class="ID">method_2</span>(<span class="ID">Object</span> <span class="ID">o</span>, <span class="ID">out</span> <span class="ID">Object</span> <span class="ID">p</span>, <span class="ID">ref</span> <span class="ID">Object</span> <span class="ID">q</span>) { ... }</span>
</pre></div></div><span class="anchor" id="line-1889"></span><span class="anchor" id="line-1890"></span><p class="line874">These methods can be called as follows: <span class="anchor" id="line-1891"></span><span class="anchor" id="line-1892"></span></p><p class="line867"><span class="anchor" id="line-1893"></span><span class="anchor" id="line-1894"></span><span class="anchor" id="line-1895"></span><span class="anchor" id="line-1896"></span><span class="anchor" id="line-1897"></span><span class="anchor" id="line-1898"></span><span class="anchor" id="line-1899"></span><span class="anchor" id="line-1900"></span><span class="anchor" id="line-1901"></span><span class="anchor" id="line-1902"></span><span class="anchor" id="line-1-238"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1a802ff08efa37dfab94be13030b022a753035ba" lang="en"><span class="line"><span class="anchor" id="line-1-239"></span><span class="ResWord">int</span> <span class="ID">a</span> = <span class="Number">1</span>;</span>
<span class="line"><span class="anchor" id="line-2-100"></span><span class="ResWord">int</span> <span class="ID">b</span>;</span>
<span class="line"><span class="anchor" id="line-3-81"></span><span class="ResWord">int</span> <span class="ID">c</span> = <span class="Number">3</span>;</span>
<span class="line"><span class="anchor" id="line-4-63"></span><span class="ID">method_1</span>(<span class="ID">a</span>, <span class="ID">out</span> <span class="ID">b</span>, <span class="ID">ref</span> <span class="ID">c</span>);</span>
<span class="line"><span class="anchor" id="line-5-53"></span></span>
<span class="line"><span class="anchor" id="line-6-44"></span><span class="ID">Object</span> <span class="ID">o</span> = <span class="ResWord">new</span> <span class="ID">Object</span>();</span>
<span class="line"><span class="anchor" id="line-7-40"></span><span class="ID">Object</span> <span class="ID">p</span>;</span>
<span class="line"><span class="anchor" id="line-8-35"></span><span class="ID">Object</span> <span class="ID">q</span> = <span class="ResWord">new</span> <span class="ID">Object</span>();</span>
<span class="line"><span class="anchor" id="line-9-34"></span><span class="ID">method_2</span>(<span class="ID">o</span>, <span class="ID">out</span> <span class="ID">p</span>, <span class="ID">ref</span> <span class="ID">q</span>);</span>
</pre></div></div><span class="anchor" id="line-1903"></span><span class="anchor" id="line-1904"></span><p class="line874">The treatment of each variable will be: <span class="anchor" id="line-1905"></span><span class="anchor" id="line-1906"></span></p><ul><li>"a"
 is of a value type.  The value will be copied into a new memory 
location local to the method, and so changes to it will not be visible 
to the caller. <span class="anchor" id="line-1907"></span></li><li><p class="line862">"b" is also of a value type, but passed as an <tt class="backtick">out</tt>
 parameter.  In this case, the value is not copied, instead a pointer to
 the data is passed to the method, and so any change to the method 
parameter will be visible to the calling code. <span class="anchor" id="line-1908"></span></p></li><li>"c" is treated in the same way as "b", the only change is in the signalled intent of the method. <span class="anchor" id="line-1909"></span><span class="anchor" id="line-1910"></span></li><li class="gap">"o"
 is of a reference type.  The method is passed a reference to the same 
object as the caller has.  The method can therefore change that object, 
but if it reassigns to the parameter, that change will not be visible to
 the caller. <span class="anchor" id="line-1911"></span></li><li><p class="line862">"p"
 is of the same type, but passed as an out parameter.  This means that 
the method will receive a pointer to the reference to the object.  It 
may therefore replace the reference with a reference to another object, 
and when the method returns the caller will instead own a reference to 
that other object.  When you use this type of parameter, if you do not 
assign a new reference to the parameter, it will be set to <tt class="backtick">null</tt>. <span class="anchor" id="line-1912"></span></p></li><li><p class="line862">"q"
 is again of the same type.  This case is treated like "p" with the 
important differences that the method may choose not to change the 
reference, and may access the object referred to.  Vala will ensure that
 in this instance "q" actually refers to any object, and is not set to <tt class="backtick">null</tt>. <span class="anchor" id="line-1913"></span><span class="anchor" id="line-1914"></span></p></li></ul><p class="line862">Here is an example of how to implement <tt class="backtick">method_1()</tt>: <span class="anchor" id="line-1915"></span><span class="anchor" id="line-1916"></span></p><p class="line867"><span class="anchor" id="line-1917"></span><span class="anchor" id="line-1918"></span><span class="anchor" id="line-1919"></span><span class="anchor" id="line-1920"></span><span class="anchor" id="line-1921"></span><span class="anchor" id="line-1-240"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-68cadfcf55375519aec207ac5cf8a4fe066b708d" lang="en"><span class="line"><span class="anchor" id="line-1-241"></span><span class="ResWord">void</span> <span class="ID">method_1</span>(<span class="ResWord">int</span> <span class="ID">a</span>, <span class="ID">out</span> <span class="ResWord">int</span> <span class="ID">b</span>, <span class="ID">ref</span> <span class="ResWord">int</span> <span class="ID">c</span>) {</span>
<span class="line"><span class="anchor" id="line-2-101"></span>    <span class="ID">b</span> = <span class="ID">a</span> + <span class="ID">c</span>;</span>
<span class="line"><span class="anchor" id="line-3-82"></span>    <span class="ID">c</span> = <span class="Number">3</span>;</span>
<span class="line"><span class="anchor" id="line-4-64"></span>}</span>
</pre></div></div><span class="anchor" id="line-1922"></span><span class="anchor" id="line-1923"></span><p class="line862">When setting the value to the out argument "b", Vala will ensure that "b" is not <tt class="backtick">null</tt>. So you can safely pass <tt class="backtick">null</tt> as the second argument of <tt class="backtick">method_1()</tt> if you are not interested by this value. <span class="anchor" id="line-1924"></span><span class="anchor" id="line-1925"></span></p><p class="line867">
</p><h3 id="Collections">Collections</h3>
<span class="anchor" id="line-1926"></span><span class="anchor" id="line-1927"></span><p class="line867"><a href="https://wiki.gnome.org/Projects/Libgee">Gee</a>
 is a library of collection classes, written in Vala.  The classes 
should all be familiar to users of libraries such as Java's Foundation 
Classes.  Gee consists of a set of interfaces and various types that 
implement these in different ways. <span class="anchor" id="line-1928"></span><span class="anchor" id="line-1929"></span></p><p class="line862">If you want to use Gee in your own application, install the library separately on your system.  Gee can be obtained from <a class="http" href="http://live.gnome.org/Projects/Libgee">http://live.gnome.org/Projects/Libgee</a>.  In order to use the library you must compile your programs with <tt class="backtick">--pkg&nbsp;gee-0.8</tt>. <span class="anchor" id="line-1930"></span><span class="anchor" id="line-1931"></span></p><p class="line874">The fundamental types of collection are: <span class="anchor" id="line-1932"></span><span class="anchor" id="line-1933"></span></p><ul><li>Lists: Ordered collections of items, accessible by numeric index. <span class="anchor" id="line-1934"></span></li><li>Sets: Unordered collections of distinct. <span class="anchor" id="line-1935"></span></li><li>Maps: Unordered collection of items, accessible by index of arbitrary type. <span class="anchor" id="line-1936"></span><span class="anchor" id="line-1937"></span></li></ul><p class="line862">All the lists and sets in the library implement the <em>Collection</em> interface, and all maps the <em>Map</em> interface.  Lists also implement <em>List</em> and sets <em>Set</em>.
  These common interfaces means not only that all collections of a 
similar type can be used interchangeably, but also that new collections 
can be written using the same interfaces, and therefore used with 
existing code. <span class="anchor" id="line-1938"></span><span class="anchor" id="line-1939"></span></p><p class="line862">Also common to every <em>Collection</em> type is the <em>Iterable</em>
 interface.  This means that any object in this category can be iterated
 through using a standard set of methods, or directly in Vala using the <tt class="backtick">foreach</tt> syntax. <span class="anchor" id="line-1940"></span><span class="anchor" id="line-1941"></span></p><p class="line874">All
 classes and interfaces use the generics system.  This means that they 
must be instantiated with a particular type or set of types that they 
will contain.  The system will ensure that only the intended types can 
be put into the collections, and that when objects are retrieved they 
are returned as the correct type. <span class="anchor" id="line-1942"></span><span class="anchor" id="line-1943"></span></p><p class="line867"><a class="http" href="http://valadoc.org/gee-0.8/index.htm">Full Gee API documentation</a>, <a href="https://wiki.gnome.org/Projects/Vala/GeeSamples">Gee Examples</a> <span class="anchor" id="line-1944"></span><span class="anchor" id="line-1945"></span></p><p class="line874">Some important Gee classes are: <span class="anchor" id="line-1946"></span><span class="anchor" id="line-1947"></span></p><p class="line867">
</p><h4 id="ArrayList.3CG.3E">ArrayList&lt;G&gt;</h4>
<span class="anchor" id="line-1948"></span><span class="anchor" id="line-1949"></span><p class="line862">Implementing: Iterable&lt;G&gt;, Collection&lt;G&gt;, List&lt;G&gt; <span class="anchor" id="line-1950"></span><span class="anchor" id="line-1951"></span></p><p class="line862">An ordered list of items of type <tt class="backtick">G</tt>
 backed by a dynamically resizing array.  This type is very fast for 
accessing data, but potentially slow at inserting items anywhere other 
than at the end, or at inserting items when the internal array is full. <span class="anchor" id="line-1952"></span><span class="anchor" id="line-1953"></span></p><p class="line867">
</p><h4 id="HashMap.3CK.2CV.3E">HashMap&lt;K,V&gt;</h4>
<span class="anchor" id="line-1954"></span><span class="anchor" id="line-1955"></span><p class="line862">Implementing: Iterable&lt;Entry&lt;K,V&gt;&gt;, Map&lt;K,V&gt; <span class="anchor" id="line-1956"></span><span class="anchor" id="line-1957"></span></p><p class="line862">A 1:1 map from elements of type <tt class="backtick">K</tt> to elements of type <tt class="backtick">V</tt>.
  The mapping is made by computing a hash value for each key - this can 
be customised by providing pointers to functions for hashing and testing
 equality of keys in specific ways. <span class="anchor" id="line-1958"></span><span class="anchor" id="line-1959"></span></p><p class="line874">You can optionally pass custom hash and equal functions to the constructor, for example: <span class="anchor" id="line-1960"></span><span class="anchor" id="line-1961"></span></p><p class="line867"><span class="anchor" id="line-1962"></span><span class="anchor" id="line-1963"></span><span class="anchor" id="line-1-242"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b25d6dd1b67a57bb74c69b6059f376acc58a69b3" lang="en"><span class="line"><span class="anchor" id="line-1-243"></span><span class="ID">var</span> <span class="ID">map</span> = <span class="ResWord">new</span> <span class="ID">Gee</span>.<span class="ID">HashMap</span>&lt;<span class="ID">Foo</span>, <span class="ID">Object</span>&gt;(<span class="ID">foo_hash</span>, <span class="ID">foo_equal</span>);</span>
</pre></div></div><span class="anchor" id="line-1964"></span><span class="anchor" id="line-1965"></span><p class="line874">For
 strings and integers the hash and equal functions are detected 
automatically, objects are distinguished by their references by default.
  You have to provide custom hash and equal functions only if you want 
to override the default behaviour. <span class="anchor" id="line-1966"></span><span class="anchor" id="line-1967"></span></p><p class="line867">
</p><h4 id="HashSet.3CG.3E">HashSet&lt;G&gt;</h4>
<span class="anchor" id="line-1968"></span><span class="anchor" id="line-1969"></span><p class="line862">Implementing: Iterable&lt;G&gt;, Collection&lt;G&gt;, Set&lt;G&gt; <span class="anchor" id="line-1970"></span><span class="anchor" id="line-1971"></span></p><p class="line862">A set of elements of type <tt class="backtick">G</tt>.
  Duplicates are detected by computing a hash value for each key - this 
can be customised by providing pointers to functions for hashing and 
testing equality of keys in specific ways. <span class="anchor" id="line-1972"></span><span class="anchor" id="line-1973"></span></p><p class="line867">
</p><h4 id="Read-Only_Views">Read-Only Views</h4>
<span class="anchor" id="line-1974"></span><span class="anchor" id="line-1975"></span><p class="line862">You can get a read-only view of a collection via the <em>read_only_view</em> property, e.g. <tt class="backtick">my_map.read_only_view</tt>.
  This will return a wrapper that has the same interface as its 
contained collection, but will not allow any form of modification, or 
any access to the contained collection. <span class="anchor" id="line-1976"></span><span class="anchor" id="line-1977"></span></p><p class="line867">
</p><h3 id="Methods_With_Syntax_Support">Methods With Syntax Support</h3>
<span class="anchor" id="line-1978"></span><span class="anchor" id="line-1979"></span><p class="line862">Vala
 recognizes some methods with certain names and signatures and provides 
syntax support for them.  For example, if a type has a <em>contains()</em> method objects of this type can be used with the <tt class="backtick">in</tt> operator.  The following table lists these special methods.  <em>T</em> and <em>Tn</em> are only type placeholders in this table and meant to be replaced with real types. <span class="anchor" id="line-1980"></span><span class="anchor" id="line-1981"></span></p><div><table><tbody><tr>  <td colspan="2"><p class="line891"><strong>Indexers</strong></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1982"></span><p class="line891"><tt class="backtick">T2&nbsp;get(T1&nbsp;index)</tt></p></td>
  <td><p class="line862">index access: <tt class="backtick">obj[index]</tt></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1983"></span><p class="line891"><tt class="backtick">void&nbsp;set(T1&nbsp;index,&nbsp;T2&nbsp;item)</tt></p></td>
  <td><p class="line862">index assignment: <tt class="backtick">obj[index]&nbsp;=&nbsp;item</tt></p></td>
</tr>
<tr>  <td colspan="2"><span class="anchor" id="line-1984"></span><p class="line891"><strong>Indexers with multiple indices</strong></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1985"></span><p class="line891"><tt class="backtick">T3&nbsp;get(T1&nbsp;index1,&nbsp;T2&nbsp;index2)</tt></p></td>
  <td><p class="line862">index access: <tt class="backtick">obj[index1,&nbsp;index2]</tt></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1986"></span><p class="line891"><tt class="backtick">void&nbsp;set(T1&nbsp;index1,&nbsp;T2&nbsp;index2,&nbsp;T3&nbsp;item)</tt></p></td>
  <td><p class="line862">index assignment: <tt class="backtick">obj[index1,&nbsp;index2]&nbsp;=&nbsp;item</tt></p></td>
</tr>
<tr>  <td colspan="2"><span class="anchor" id="line-1987"></span><p class="line862">(... and so on for more indices)</p></td>
</tr>
<tr>  <td colspan="2"><span class="anchor" id="line-1988"></span><p class="line891"><strong>Others</strong></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1989"></span><p class="line891"><tt class="backtick">T&nbsp;slice(long&nbsp;start,&nbsp;long&nbsp;end)</tt></p></td>
  <td><p class="line862">slicing: <tt class="backtick">obj[start:end]</tt></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1990"></span><p class="line891"><tt class="backtick">bool&nbsp;contains(T&nbsp;needle)</tt></p></td>
  <td><p class="line891"><tt class="backtick">in</tt> operator: <tt class="backtick">bool&nbsp;b&nbsp;=&nbsp;needle&nbsp;in&nbsp;obj</tt></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1991"></span><p class="line891"><tt class="backtick">string&nbsp;to_string()</tt></p></td>
  <td><p class="line862">support within string templates: <tt class="backtick">@"$obj"</tt></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1992"></span><p class="line891"><tt class="backtick">Iterator&nbsp;iterator()</tt></p></td>
  <td><p class="line862">iterable via <tt class="backtick">foreach</tt></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1993"></span><p class="line891"><tt class="backtick">T2&nbsp;get(T1&nbsp;index)</tt><br>
<tt class="backtick">T1&nbsp;size&nbsp;{&nbsp;get;&nbsp;}</tt></p></td>
  <td><p class="line862">iterable via <tt class="backtick">foreach</tt></p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-1994"></span><span class="anchor" id="line-1995"></span><p class="line862">The <em>Iterator</em> type can have any name and must implement one of these two protocols: <span class="anchor" id="line-1996"></span><span class="anchor" id="line-1997"></span></p><div><table><tbody><tr>  <td><p class="line891"><tt class="backtick">bool&nbsp;next()</tt><br>
<tt class="backtick">T&nbsp;get()</tt></p></td>
  <td><p class="line862">standard iterator protocol: iterating until <em>.next()</em> returns <tt class="backtick">false</tt>.  The current element is retrieved via <em>.get()</em>.</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-1998"></span><p class="line891"><tt class="backtick">T?&nbsp;next_value()</tt></p></td>
  <td><p class="line862">alternative iterator protocol: If the iterator object has a <em>.next_value()</em> function that returns a nullable type then we iterate by calling this function until it returns <tt class="backtick">null</tt>.</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-1999"></span><span class="anchor" id="line-2000"></span><p class="line874">This example implements some of these methods: <span class="anchor" id="line-2001"></span><span class="anchor" id="line-2002"></span></p><p class="line867"><span class="anchor" id="line-2003"></span><span class="anchor" id="line-2004"></span><span class="anchor" id="line-2005"></span><span class="anchor" id="line-2006"></span><span class="anchor" id="line-2007"></span><span class="anchor" id="line-2008"></span><span class="anchor" id="line-2009"></span><span class="anchor" id="line-2010"></span><span class="anchor" id="line-2011"></span><span class="anchor" id="line-2012"></span><span class="anchor" id="line-2013"></span><span class="anchor" id="line-2014"></span><span class="anchor" id="line-2015"></span><span class="anchor" id="line-2016"></span><span class="anchor" id="line-2017"></span><span class="anchor" id="line-2018"></span><span class="anchor" id="line-2019"></span><span class="anchor" id="line-2020"></span><span class="anchor" id="line-2021"></span><span class="anchor" id="line-2022"></span><span class="anchor" id="line-2023"></span><span class="anchor" id="line-2024"></span><span class="anchor" id="line-2025"></span><span class="anchor" id="line-2026"></span><span class="anchor" id="line-2027"></span><span class="anchor" id="line-2028"></span><span class="anchor" id="line-2029"></span><span class="anchor" id="line-2030"></span><span class="anchor" id="line-2031"></span><span class="anchor" id="line-2032"></span><span class="anchor" id="line-2033"></span><span class="anchor" id="line-2034"></span><span class="anchor" id="line-2035"></span><span class="anchor" id="line-2036"></span><span class="anchor" id="line-2037"></span><span class="anchor" id="line-2038"></span><span class="anchor" id="line-2039"></span><span class="anchor" id="line-2040"></span><span class="anchor" id="line-2041"></span><span class="anchor" id="line-2042"></span><span class="anchor" id="line-2043"></span><span class="anchor" id="line-2044"></span><span class="anchor" id="line-2045"></span><span class="anchor" id="line-2046"></span><span class="anchor" id="line-2047"></span><span class="anchor" id="line-2048"></span><span class="anchor" id="line-2049"></span><span class="anchor" id="line-2050"></span><span class="anchor" id="line-1-244"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-da256d2dad8b53fad2ae12a6292bfe22240a3fb5" lang="en"><span class="line"><span class="anchor" id="line-1-245"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">EvenNumbers</span> {</span>
<span class="line"><span class="anchor" id="line-2-102"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">get</span>(<span class="ResWord">int</span> <span class="ID">index</span>) {</span>
<span class="line"><span class="anchor" id="line-3-83"></span>        <span class="ResWord">return</span> <span class="ID">index</span> * <span class="Number">2</span>;</span>
<span class="line"><span class="anchor" id="line-4-65"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-54"></span></span>
<span class="line"><span class="anchor" id="line-6-45"></span>    <span class="ResWord">public</span> <span class="ResWord">bool</span> <span class="ID">contains</span>(<span class="ResWord">int</span> <span class="ID">i</span>) {</span>
<span class="line"><span class="anchor" id="line-7-41"></span>        <span class="ResWord">return</span> <span class="ID">i</span> % <span class="Number">2</span> == <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-8-36"></span>    }</span>
<span class="line"><span class="anchor" id="line-9-35"></span></span>
<span class="line"><span class="anchor" id="line-10-28"></span>    <span class="ResWord">public</span> <span class="ID">string</span> <span class="ID">to_string</span>() {</span>
<span class="line"><span class="anchor" id="line-11-25"></span>        <span class="ResWord">return</span> <span class="String">"</span><span class="String">[This object enumerates even numbers]</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-12-20"></span>    }</span>
<span class="line"><span class="anchor" id="line-13-19"></span></span>
<span class="line"><span class="anchor" id="line-14-18"></span>    <span class="ResWord">public</span> <span class="ID">Iterator</span> <span class="ID">iterator</span>() {</span>
<span class="line"><span class="anchor" id="line-15-16"></span>        <span class="ResWord">return</span> <span class="ResWord">new</span> <span class="ID">Iterator</span>(<span class="ResWord">this</span>);</span>
<span class="line"><span class="anchor" id="line-16-14"></span>    }</span>
<span class="line"><span class="anchor" id="line-17-12"></span></span>
<span class="line"><span class="anchor" id="line-18-10"></span>    <span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Iterator</span> {</span>
<span class="line"><span class="anchor" id="line-19-8"></span>        <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">index</span>;</span>
<span class="line"><span class="anchor" id="line-20-7"></span>        <span class="ResWord">private</span> <span class="ID">EvenNumbers</span> <span class="ID">even</span>;</span>
<span class="line"><span class="anchor" id="line-21-7"></span></span>
<span class="line"><span class="anchor" id="line-22-6"></span>        <span class="ResWord">public</span> <span class="ID">Iterator</span>(<span class="ID">EvenNumbers</span> <span class="ID">even</span>) {</span>
<span class="line"><span class="anchor" id="line-23-4"></span>            <span class="ResWord">this</span>.<span class="ID">even</span> = <span class="ID">even</span>;</span>
<span class="line"><span class="anchor" id="line-24-4"></span>        }</span>
<span class="line"><span class="anchor" id="line-25-4"></span></span>
<span class="line"><span class="anchor" id="line-26-4"></span>        <span class="ResWord">public</span> <span class="ResWord">bool</span> <span class="ID">next</span>() {</span>
<span class="line"><span class="anchor" id="line-27-4"></span>            <span class="ResWord">return</span> <span class="ConsWord">true</span>;</span>
<span class="line"><span class="anchor" id="line-28-4"></span>        }</span>
<span class="line"><span class="anchor" id="line-29-4"></span></span>
<span class="line"><span class="anchor" id="line-30-4"></span>        <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">get</span>() {</span>
<span class="line"><span class="anchor" id="line-31-4"></span>            <span class="ResWord">this</span>.<span class="ID">index</span>++;</span>
<span class="line"><span class="anchor" id="line-32-4"></span>            <span class="ResWord">return</span> <span class="ResWord">this</span>.<span class="ID">even</span>[<span class="ResWord">this</span>.<span class="ID">index</span> - <span class="Number">1</span>];</span>
<span class="line"><span class="anchor" id="line-33-4"></span>        }</span>
<span class="line"><span class="anchor" id="line-34-4"></span>    }</span>
<span class="line"><span class="anchor" id="line-35-4"></span>}</span>
<span class="line"><span class="anchor" id="line-36-4"></span></span>
<span class="line"><span class="anchor" id="line-37-3"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-38-3"></span>    <span class="ID">var</span> <span class="ID">even</span> = <span class="ResWord">new</span> <span class="ID">EvenNumbers</span>();</span>
<span class="line"><span class="anchor" id="line-39-3"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">even</span>[<span class="Number">5</span>]);   <span class="Comment">// get()</span></span>
<span class="line"><span class="anchor" id="line-40-3"></span><span class="Comment"></span>    <span class="ResWord">if</span> (<span class="Number">4</span> <span class="ID">in</span> <span class="ID">even</span>) {                  <span class="Comment">// contains()</span></span>
<span class="line"><span class="anchor" id="line-41-3"></span><span class="Comment"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(@<span class="String">"</span><span class="String">$even</span><span class="SPChar">\n</span><span class="String">"</span>);    <span class="Comment">// to_string()</span></span>
<span class="line"><span class="anchor" id="line-42-3"></span><span class="Comment"></span>    }</span>
<span class="line"><span class="anchor" id="line-43-3"></span>    <span class="ID">foreach</span> (<span class="ResWord">int</span> <span class="ID">i</span> <span class="ID">in</span> <span class="ID">even</span>) {         <span class="Comment">// iterator()</span></span>
<span class="line"><span class="anchor" id="line-44-3"></span><span class="Comment"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">i</span>);</span>
<span class="line"><span class="anchor" id="line-45-3"></span>        <span class="ResWord">if</span> (<span class="ID">i</span> == <span class="Number">20</span>) <span class="ResWord">break</span>;</span>
<span class="line"><span class="anchor" id="line-46-3"></span>    }</span>
<span class="line"><span class="anchor" id="line-47-3"></span>}</span>
</pre></div></div><span class="anchor" id="line-2051"></span><span class="anchor" id="line-2052"></span><p class="line867">
</p><h3 id="Multi-Threading">Multi-Threading</h3>
<span class="anchor" id="line-2053"></span><span class="anchor" id="line-2054"></span><p class="line867">
</p><h4 id="Threads_in_Vala">Threads in Vala</h4>
<span class="anchor" id="line-2055"></span><span class="anchor" id="line-2056"></span><p class="line874">A
 program written in Vala may have more than one thread of execution, 
allowing it it do more than one thing at a time.  Exactly how this is 
managed is outside of Vala's scope - threads may be sharing a single 
processor core or not, depending on the environment. <span class="anchor" id="line-2057"></span><span class="anchor" id="line-2058"></span></p><p class="line862">A
 thread in Vala is not defined at compile time, instead it is simply a 
portion of Vala code that is requested at runtime to be executed as a 
new thread.  This is done using the static methods of the <em>Thread</em> class in GLib, as shown in the following (very simplified) example: <span class="anchor" id="line-2059"></span><span class="anchor" id="line-2060"></span></p><p class="line867"><span class="anchor" id="line-2061"></span><span class="anchor" id="line-2062"></span><span class="anchor" id="line-2063"></span><span class="anchor" id="line-2064"></span><span class="anchor" id="line-2065"></span><span class="anchor" id="line-2066"></span><span class="anchor" id="line-2067"></span><span class="anchor" id="line-2068"></span><span class="anchor" id="line-2069"></span><span class="anchor" id="line-2070"></span><span class="anchor" id="line-2071"></span><span class="anchor" id="line-2072"></span><span class="anchor" id="line-2073"></span><span class="anchor" id="line-2074"></span><span class="anchor" id="line-2075"></span><span class="anchor" id="line-2076"></span><span class="anchor" id="line-2077"></span><span class="anchor" id="line-2078"></span><span class="anchor" id="line-2079"></span><span class="anchor" id="line-2080"></span><span class="anchor" id="line-1-246"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-d410e47846e498010c228e0e7c3b1994c3ceeb82" lang="en"><span class="line"><span class="anchor" id="line-1-247"></span><span class="ResWord">void</span>* <span class="ID">thread_func</span>() {</span>
<span class="line"><span class="anchor" id="line-2-103"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Thread running.</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-84"></span>    <span class="ResWord">return</span> <span class="ID">null</span>;</span>
<span class="line"><span class="anchor" id="line-4-66"></span>}</span>
<span class="line"><span class="anchor" id="line-5-55"></span></span>
<span class="line"><span class="anchor" id="line-6-46"></span><span class="ResWord">int</span> <span class="ID">main</span>(<span class="ID">string</span>[] <span class="ID">args</span>) {</span>
<span class="line"><span class="anchor" id="line-7-42"></span>    <span class="ResWord">if</span> (!<span class="ID">Thread</span>.<span class="ID">supported</span>()) {</span>
<span class="line"><span class="anchor" id="line-8-37"></span>        <span class="ID">stderr</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Cannot run without threads.</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-9-36"></span>        <span class="ResWord">return</span> <span class="Number">1</span>;</span>
<span class="line"><span class="anchor" id="line-10-29"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-26"></span></span>
<span class="line"><span class="anchor" id="line-12-21"></span>    <span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-13-20"></span>        <span class="ID">Thread</span>.<span class="ID">create</span>(<span class="ID">thread_func</span>, <span class="ConsWord">false</span>);</span>
<span class="line"><span class="anchor" id="line-14-19"></span>    } <span class="ResWord">catch</span> (<span class="ID">ThreadError</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-15-17"></span>        <span class="ResWord">return</span> <span class="Number">1</span>;</span>
<span class="line"><span class="anchor" id="line-16-15"></span>    }</span>
<span class="line"><span class="anchor" id="line-17-13"></span></span>
<span class="line"><span class="anchor" id="line-18-11"></span>    <span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="anchor" id="line-19-9"></span>}</span>
</pre></div></div><span class="anchor" id="line-2081"></span><span class="anchor" id="line-2082"></span><p class="line862">This short program will request a new thread be created and executed.  The code to be run being that in <em>thread_func</em>.
  Also note the test at the start of the main method - a Vala program 
will not be able to use threads unless compiled appropriately, so if you
 build this example in the usual way, it will just display an error and 
stop running.  Being able to check for thread support at runtime allows a
 program to be built to run either with or without threads if that is 
wanted.  In order to build with thread support, run: <span class="anchor" id="line-2083"></span><span class="anchor" id="line-2084"></span></p><p class="line867"><span class="anchor" id="line-2085"></span><span class="anchor" id="line-2086"></span></p><pre><span class="anchor" id="line-1-18"></span>$ valac --thread threading-sample.vala</pre><span class="anchor" id="line-2087"></span><span class="anchor" id="line-2088"></span><p class="line874">This will both include required libraries and make sure the threading system is initialised whenever possible. <span class="anchor" id="line-2089"></span><span class="anchor" id="line-2090"></span></p><p class="line874">The
 program will now run without segmentation faults, but it will still not
 act as expected.  Without any sort of event loop, a Vala program will 
terminate when its primary thread (the one created to run "main") ends. 
 In order to control this behaviour, you can allow threads to cooperate.
  This can be done powerfully using event loops and asynchronous queues,
 but in this introduction to threading we will just show the basic 
capabilities of threads. <span class="anchor" id="line-2091"></span><span class="anchor" id="line-2092"></span></p><p class="line862">It
 is possible for a thread to tell the system that it currently has no 
need to execute, and thereby suggest that another thread should be run 
instead, this is done using the static method <em>Thread.yield()</em>.  If this statement was placed at the end of the above <em>main</em>
 method, the runtime system will pause the main thread for an instant 
and check if there are other threads that can be run - on finding the 
newly created thread in a runnable state, it will run that instead until
 it is finished - and the program will act is it appears it should.  
However, there is no guarantee that this will happen still.  The system 
is able to decide when threads run, and as such might not allow the new 
thread to finish before the primary thread is restarted and the program 
ends. <span class="anchor" id="line-2093"></span><span class="anchor" id="line-2094"></span></p><p class="line862">In order to wait for a thread to finish entirely there is the <em>join()</em> method.  Calling this method on a <em>Thread</em>
 object causes the calling thread to wait for the other thread to finish
 before proceeding.  It also allows a thread to receive the return value
 of another, if that is useful.  To implement joining threads: <span class="anchor" id="line-2095"></span><span class="anchor" id="line-2096"></span></p><p class="line867"><span class="anchor" id="line-2097"></span><span class="anchor" id="line-2098"></span><span class="anchor" id="line-2099"></span><span class="anchor" id="line-2100"></span><span class="anchor" id="line-2101"></span><span class="anchor" id="line-2102"></span><span class="anchor" id="line-2103"></span><span class="anchor" id="line-1-248"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-990900481065f2a057ccacd61d015fcf9a0008c0" lang="en"><span class="line"><span class="anchor" id="line-1-249"></span><span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-2-104"></span>    <span class="ID">unowned</span> <span class="ID">Thread</span> <span class="ResWord">thread</span> = <span class="ID">Thread</span>.<span class="ID">create</span>(<span class="ID">thread_func</span>, <span class="ConsWord">true</span>);</span>
<span class="line"><span class="anchor" id="line-3-85"></span>    <span class="ResWord">thread</span>.<span class="ID">join</span>();</span>
<span class="line"><span class="anchor" id="line-4-67"></span>} <span class="ResWord">catch</span> (<span class="ID">ThreadError</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-5-56"></span>    <span class="ResWord">return</span> <span class="Number">1</span>;</span>
<span class="line"><span class="anchor" id="line-6-47"></span>}</span>
</pre></div></div><span class="anchor" id="line-2104"></span><span class="anchor" id="line-2105"></span><p class="line862">This time, when we create the thread we give <tt class="backtick">true</tt>
 as the last argument.  This marks the thread as "joinable".  We also 
remember the value returned from the creation - an unowned reference to a
 <tt class="backtick">Thread</tt> object (unowned references are 
explained later and are not vital to this section.)  With this reference
 it is possible to join the new thread to the primary thread.  With this
 version of the program it is guaranteed that the newly created thread 
will be allowed to fully execute before the primary thread continues and
 the program terminates. <span class="anchor" id="line-2106"></span><span class="anchor" id="line-2107"></span></p><p class="line862">All
 these examples have a potential problem, in that the newly created 
thread doesn't know the context in which it should run.  In C you would 
supply the thread creation method with some data, in Vala instead you 
would normally pass an instance method to <tt class="backtick">Thread.create</tt>, instead of a static method. <span class="anchor" id="line-2108"></span><span class="anchor" id="line-2109"></span></p><p class="line867">
</p><h4 id="Resource_Control">Resource Control</h4>
<span class="anchor" id="line-2110"></span><span class="anchor" id="line-2111"></span><p class="line874">Whenever
 more than one thread of execution is running simultaneously, there is a
 chance that data are accessed simultaneously.  This can lead to race 
conditions, where the outcome depends on when the system decides to 
switch between threads. <span class="anchor" id="line-2112"></span><span class="anchor" id="line-2113"></span></p><p class="line862">In order to control this situation, you can use the <tt class="backtick">lock</tt>
 keyword to ensure that certain blocks of code will not be interrupted 
by other threads that need to access the same data.  The best way to 
show this is probably with an example: <span class="anchor" id="line-2114"></span><span class="anchor" id="line-2115"></span></p><p class="line867"><span class="anchor" id="line-2116"></span><span class="anchor" id="line-2117"></span><span class="anchor" id="line-2118"></span><span class="anchor" id="line-2119"></span><span class="anchor" id="line-2120"></span><span class="anchor" id="line-2121"></span><span class="anchor" id="line-2122"></span><span class="anchor" id="line-2123"></span><span class="anchor" id="line-2124"></span><span class="anchor" id="line-2125"></span><span class="anchor" id="line-2126"></span><span class="anchor" id="line-2127"></span><span class="anchor" id="line-2128"></span><span class="anchor" id="line-2129"></span><span class="anchor" id="line-2130"></span><span class="anchor" id="line-2131"></span><span class="anchor" id="line-2132"></span><span class="anchor" id="line-2133"></span><span class="anchor" id="line-2134"></span><span class="anchor" id="line-2135"></span><span class="anchor" id="line-2136"></span><span class="anchor" id="line-1-250"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-6718286519ace0958a5ca6d4bebf28c646cc0432" lang="en"><span class="line"><span class="anchor" id="line-1-251"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">Test</span> : <span class="ID">GLib</span>.<span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-105"></span></span>
<span class="line"><span class="anchor" id="line-3-86"></span>    <span class="ResWord">private</span> <span class="ResWord">int</span> <span class="ID">a</span> { <span class="ID">get</span>; <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-4-68"></span></span>
<span class="line"><span class="anchor" id="line-5-57"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">action_1</span>() {</span>
<span class="line"><span class="anchor" id="line-6-48"></span>        <span class="ID">lock</span> (<span class="ID">a</span>) {</span>
<span class="line"><span class="anchor" id="line-7-43"></span>            <span class="ResWord">int</span> <span class="ID">tmp</span> = <span class="ID">a</span>;</span>
<span class="line"><span class="anchor" id="line-8-38"></span>            <span class="ID">tmp</span>++;</span>
<span class="line"><span class="anchor" id="line-9-37"></span>            <span class="ID">a</span> = <span class="ID">tmp</span>;</span>
<span class="line"><span class="anchor" id="line-10-30"></span>        }</span>
<span class="line"><span class="anchor" id="line-11-27"></span>    }</span>
<span class="line"><span class="anchor" id="line-12-22"></span></span>
<span class="line"><span class="anchor" id="line-13-21"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">action_2</span>() {</span>
<span class="line"><span class="anchor" id="line-14-20"></span>        <span class="ID">lock</span> (<span class="ID">a</span>) {</span>
<span class="line"><span class="anchor" id="line-15-18"></span>            <span class="ResWord">int</span> <span class="ID">tmp</span> = <span class="ID">a</span>;</span>
<span class="line"><span class="anchor" id="line-16-16"></span>            <span class="ID">tmp</span>--;</span>
<span class="line"><span class="anchor" id="line-17-14"></span>            <span class="ID">a</span> = <span class="ID">tmp</span>;</span>
<span class="line"><span class="anchor" id="line-18-12"></span>        }</span>
<span class="line"><span class="anchor" id="line-19-10"></span>    }</span>
<span class="line"><span class="anchor" id="line-20-8"></span>}</span>
</pre></div></div><span class="anchor" id="line-2137"></span><span class="anchor" id="line-2138"></span><p class="line862">This
 class defines two methods, where both need to change the value of "a". 
 If there were no lock statements here, it would be possible for the 
instructions in these methods to be interweaved, and the resulting 
change to "a" would be effectively random.  As there are the <tt class="backtick">lock</tt>
 statements here, Vala will guarantee that if one thread has locked "a",
 another thread that needs the same lock will have to wait its turn. <span class="anchor" id="line-2139"></span><span class="anchor" id="line-2140"></span></p><p class="line874">In
 Vala it is only possible to lock members of the object that is 
executing the code.  This might appear to be a major restriction, but in
 fact the standard use for this technique should involve classes that 
are individually responsible for controlling a resource, and so all 
locking will indeed be internal to the class.  Likewise, in above 
example all accesses to "a" are encapsulated in the class. <span class="anchor" id="line-2141"></span><span class="anchor" id="line-2142"></span></p><p class="line867">
</p><h3 id="The_Main_Loop">The Main Loop</h3>
<span class="anchor" id="line-2143"></span><span class="anchor" id="line-2144"></span><p class="line862">GLib includes a system for running an event loop, in the classes around <tt class="backtick">Main</tt><tt class="backtick">Loop</tt>.
  The purpose of this system is to allow you to write a program that 
waits for events and responds to them, instead of having to constantly 
check conditions.  This is the model that GTK+ uses, so that a program 
can wait for user interaction without having to have any currently 
running code. <span class="anchor" id="line-2145"></span><span class="anchor" id="line-2146"></span></p><p class="line862">The following program creates and starts a <tt class="backtick">Main</tt><tt class="backtick">Loop</tt>,
 and then attaches a source of events to it.  In this case the source is
 a simple timer, that will execute the given method after 2000ms.  The 
method will in fact just stop the main loop, which will in this case 
exit the program. <span class="anchor" id="line-2147"></span><span class="anchor" id="line-2148"></span></p><p class="line867"><span class="anchor" id="line-2149"></span><span class="anchor" id="line-2150"></span><span class="anchor" id="line-2151"></span><span class="anchor" id="line-2152"></span><span class="anchor" id="line-2153"></span><span class="anchor" id="line-2154"></span><span class="anchor" id="line-2155"></span><span class="anchor" id="line-2156"></span><span class="anchor" id="line-2157"></span><span class="anchor" id="line-2158"></span><span class="anchor" id="line-2159"></span><span class="anchor" id="line-2160"></span><span class="anchor" id="line-2161"></span><span class="anchor" id="line-2162"></span><span class="anchor" id="line-2163"></span><span class="anchor" id="line-2164"></span><span class="anchor" id="line-1-252"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b6b3b84e389aecb7dd164896837821fad39f1364" lang="en"><span class="line"><span class="anchor" id="line-1-253"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-2-106"></span></span>
<span class="line"><span class="anchor" id="line-3-87"></span>    <span class="ID">var</span> <span class="ID">loop</span> = <span class="ResWord">new</span> <span class="ID">MainLoop</span>();</span>
<span class="line"><span class="anchor" id="line-4-69"></span>    <span class="ID">var</span> <span class="ID">time</span> = <span class="ResWord">new</span> <span class="ID">TimeoutSource</span>(<span class="Number">2000</span>);</span>
<span class="line"><span class="anchor" id="line-5-58"></span></span>
<span class="line"><span class="anchor" id="line-6-49"></span>    <span class="ID">time</span>.<span class="ID">set_callback</span>(() =&gt; {</span>
<span class="line"><span class="anchor" id="line-7-44"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Time!</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-8-39"></span>        <span class="ID">loop</span>.<span class="ID">quit</span>();</span>
<span class="line"><span class="anchor" id="line-9-38"></span>        <span class="ResWord">return</span> <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-10-31"></span>    });</span>
<span class="line"><span class="anchor" id="line-11-28"></span></span>
<span class="line"><span class="anchor" id="line-12-23"></span>    <span class="ID">time</span>.<span class="ID">attach</span>(<span class="ID">loop</span>.<span class="ID">get_context</span>());</span>
<span class="line"><span class="anchor" id="line-13-22"></span></span>
<span class="line"><span class="anchor" id="line-14-21"></span>    <span class="ID">loop</span>.<span class="ID">run</span>();</span>
<span class="line"><span class="anchor" id="line-15-19"></span>}</span>
</pre></div></div><span class="anchor" id="line-2165"></span><span class="anchor" id="line-2166"></span><p class="line874">When
 using GTK+, a main loop will be created automatically, and will be 
started when you call the `Gtk.main()' method.  This marks the point 
where the program is ready to run and start accepting events from the 
user or elsewhere.  The code in GTK+ is equivalent to the short example 
above, and so you may add event sources in much the same way, although 
of course you need to use the GTK+ methods to control the main loop. <span class="anchor" id="line-2167"></span><span class="anchor" id="line-2168"></span></p><p class="line867"><span class="anchor" id="line-2169"></span><span class="anchor" id="line-2170"></span><span class="anchor" id="line-2171"></span><span class="anchor" id="line-2172"></span><span class="anchor" id="line-2173"></span><span class="anchor" id="line-2174"></span><span class="anchor" id="line-2175"></span><span class="anchor" id="line-2176"></span><span class="anchor" id="line-2177"></span><span class="anchor" id="line-2178"></span><span class="anchor" id="line-2179"></span><span class="anchor" id="line-2180"></span><span class="anchor" id="line-2181"></span><span class="anchor" id="line-2182"></span><span class="anchor" id="line-2183"></span><span class="anchor" id="line-2184"></span><span class="anchor" id="line-1-254"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b3ad9b1cacfc4b30c9c6edfbd7941a8557ac07b5" lang="en"><span class="line"><span class="anchor" id="line-1-255"></span><span class="ResWord">void</span> <span class="ID">main</span>(<span class="ID">string</span>[] <span class="ID">args</span>) {</span>
<span class="line"><span class="anchor" id="line-2-107"></span></span>
<span class="line"><span class="anchor" id="line-3-88"></span>    <span class="ID">Gtk</span>.<span class="ID">init</span>(<span class="ID">ref</span> <span class="ID">args</span>);</span>
<span class="line"><span class="anchor" id="line-4-70"></span>    <span class="ID">var</span> <span class="ID">time</span> = <span class="ResWord">new</span> <span class="ID">TimeoutSource</span>(<span class="Number">2000</span>);</span>
<span class="line"><span class="anchor" id="line-5-59"></span></span>
<span class="line"><span class="anchor" id="line-6-50"></span>    <span class="ID">time</span>.<span class="ID">set_callback</span>(() =&gt; {</span>
<span class="line"><span class="anchor" id="line-7-45"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Time!</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-8-40"></span>        <span class="ID">Gtk</span>.<span class="ID">main_quit</span>();</span>
<span class="line"><span class="anchor" id="line-9-39"></span>        <span class="ResWord">return</span> <span class="ConsWord">false</span>;</span>
<span class="line"><span class="anchor" id="line-10-32"></span>    });</span>
<span class="line"><span class="anchor" id="line-11-29"></span></span>
<span class="line"><span class="anchor" id="line-12-24"></span>    <span class="ID">time</span>.<span class="ID">attach</span>(<span class="ID">null</span>);</span>
<span class="line"><span class="anchor" id="line-13-23"></span></span>
<span class="line"><span class="anchor" id="line-14-22"></span>    <span class="ID">Gtk</span>.<span class="ID">main</span>();</span>
<span class="line"><span class="anchor" id="line-15-20"></span>}</span>
</pre></div></div><span class="anchor" id="line-2185"></span><span class="anchor" id="line-2186"></span><p class="line862">A
 common requirement in GUI programs is to execute some code as soon as 
possible, but only when it will not disturb the user.  For this, you use
 IdleSource instances.  These send events to the programs main loop, but
 request they only be dealt with when there is nothing more important to
 do. <span class="anchor" id="line-2187"></span><span class="anchor" id="line-2188"></span></p><p class="line874">For more information about event loops, see the GLib and GTK+ documentation. <span class="anchor" id="line-2189"></span><span class="anchor" id="line-2190"></span></p><p class="line867">
</p><h3 id="Asynchronous_Methods">Asynchronous Methods</h3>
<span class="anchor" id="line-2191"></span><span class="anchor" id="line-2192"></span><p class="line874">Asynchronous methods are methods whose execution can be paused and <span class="anchor" id="line-2193"></span>resumed under the control of the programmer.  They are often used in <span class="anchor" id="line-2194"></span>the main thread of an application where a method needs to wait for an <span class="anchor" id="line-2195"></span>external slow task to complete, but must not stop other processing from <span class="anchor" id="line-2196"></span>happening.  (For example, one slow operation must not freeze the whole GUI). <span class="anchor" id="line-2197"></span>When the method has to wait, it gives control of the CPU back to its <span class="anchor" id="line-2198"></span>caller (i.e. it <em>yields</em>), but it arranges to be called back to resume <span class="anchor" id="line-2199"></span>execution when data becomes ready.  External slow tasks that async <span class="anchor" id="line-2200"></span>methods might wait for include: waiting for data from a remote server, <span class="anchor" id="line-2201"></span>or waiting for calculations in another thread to complete, or waiting <span class="anchor" id="line-2202"></span>for data to load from a disk drive. <span class="anchor" id="line-2203"></span><span class="anchor" id="line-2204"></span></p><p class="line874">Asynchronous methods are normally used with a GLib main loop running, <span class="anchor" id="line-2205"></span>because idle callbacks are used to handle some of the internal <span class="anchor" id="line-2206"></span>callbacks.  However under certain conditions <tt class="backtick">async</tt> may be used <span class="anchor" id="line-2207"></span>without the GLib main loop, for example if the async methods always <span class="anchor" id="line-2208"></span>yield and <tt class="backtick">Idle.add()</tt> is never used.  (FIXME: Check what are the exact <span class="anchor" id="line-2209"></span>conditions.) <span class="anchor" id="line-2210"></span><span class="anchor" id="line-2211"></span></p><p class="line874">Asynchronous methods are designed for interleaving the processing of  <span class="anchor" id="line-2212"></span>many different long-lived operations within a single thread.  They do  <span class="anchor" id="line-2213"></span>not by themselves spread the load out over different threads.  However, <span class="anchor" id="line-2214"></span>an async method may be used to control a background thread and to wait  <span class="anchor" id="line-2215"></span>for it to complete, or to queue operations for a background thread to  <span class="anchor" id="line-2216"></span>process. <span class="anchor" id="line-2217"></span><span class="anchor" id="line-2218"></span></p><p class="line874">Async methods in Vala use the GIO library to handle the callbacks, so  <span class="anchor" id="line-2219"></span>must be built with the <tt class="backtick">--pkg=gio-2.0</tt> option. <span class="anchor" id="line-2220"></span><span class="anchor" id="line-2221"></span></p><p class="line862">An asynchronous method is defined with the <tt class="backtick">async</tt> keyword.  For <span class="anchor" id="line-2222"></span>example: <span class="anchor" id="line-2223"></span><span class="anchor" id="line-2224"></span></p><p class="line867"><span class="anchor" id="line-2225"></span><span class="anchor" id="line-2226"></span><span class="anchor" id="line-2227"></span><span class="anchor" id="line-2228"></span><span class="anchor" id="line-2229"></span><span class="anchor" id="line-1-256"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-80da061f6fce6fefb516dccf6555e9d39b090f71" lang="en"><span class="line"><span class="anchor" id="line-1-257"></span>  <span class="ID">async</span> <span class="ResWord">void</span> <span class="ID">display_jpeg</span>(<span class="ID">string</span> <span class="ID">fnam</span>) {</span>
<span class="line"><span class="anchor" id="line-2-108"></span>     <span class="Comment">// Load JPEG in a background thread and display it when loaded</span></span>
<span class="line"><span class="anchor" id="line-3-89"></span><span class="Comment"></span>     [...]</span>
<span class="line"><span class="anchor" id="line-4-71"></span>  }</span>
</pre></div></div><span class="anchor" id="line-2230"></span><span class="anchor" id="line-2231"></span><p class="line874">or: <span class="anchor" id="line-2232"></span><span class="anchor" id="line-2233"></span></p><p class="line867"><span class="anchor" id="line-2234"></span><span class="anchor" id="line-2235"></span><span class="anchor" id="line-2236"></span><span class="anchor" id="line-2237"></span><span class="anchor" id="line-2238"></span><span class="anchor" id="line-2239"></span><span class="anchor" id="line-2240"></span><span class="anchor" id="line-2241"></span><span class="anchor" id="line-1-258"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-8c0acdbdd0f6f6622be2c8acdb07860159c82254" lang="en"><span class="line"><span class="anchor" id="line-1-259"></span>  <span class="ID">async</span> <span class="ResWord">int</span> <span class="ID">fetch_webpage</span>(<span class="ID">string</span> <span class="ID">url</span>, <span class="ID">out</span> <span class="ID">string</span> <span class="ID">text</span>) <span class="ResWord">throws</span> <span class="ID">IOError</span> {</span>
<span class="line"><span class="anchor" id="line-2-109"></span>     <span class="Comment">// Fetch a webpage asynchronously and when ready return the </span></span>
<span class="line"><span class="anchor" id="line-3-90"></span><span class="Comment"></span>     <span class="Comment">// HTTP status code and put the page contents in 'text'</span></span>
<span class="line"><span class="anchor" id="line-4-72"></span><span class="Comment"></span>     [...]</span>
<span class="line"><span class="anchor" id="line-5-60"></span>     <span class="ID">text</span> = <span class="ID">result</span>;</span>
<span class="line"><span class="anchor" id="line-6-51"></span>     <span class="ResWord">return</span> <span class="ID">status</span>;</span>
<span class="line"><span class="anchor" id="line-7-46"></span>  }</span>
</pre></div></div><span class="anchor" id="line-2242"></span><span class="anchor" id="line-2243"></span><p class="line874">The method may take arguments and return a value like any other <span class="anchor" id="line-2244"></span>method.  It may use a <tt class="backtick">yield</tt> statement at any time to give control of <span class="anchor" id="line-2245"></span>the CPU back to its caller. <span class="anchor" id="line-2246"></span><span class="anchor" id="line-2247"></span></p><p class="line874">An async method may be called with any of these three forms: <span class="anchor" id="line-2248"></span><span class="anchor" id="line-2249"></span></p><p class="line867"><span class="anchor" id="line-2250"></span><span class="anchor" id="line-2251"></span><span class="anchor" id="line-2252"></span><span class="anchor" id="line-2253"></span><span class="anchor" id="line-2254"></span><span class="anchor" id="line-2255"></span><span class="anchor" id="line-1-260"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c4d665dda027bff215ec711f77a78af2b421c6b1" lang="en"><span class="line"><span class="anchor" id="line-1-261"></span>  <span class="ID">display_jpeg</span>(<span class="String">"</span><span class="String">test.jpg</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-2-110"></span>  <span class="ID">display_jpeg</span>.<span class="ID">begin</span>(<span class="String">"</span><span class="String">test.jpg</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-91"></span>  <span class="ID">display_jpeg</span>.<span class="ID">begin</span>(<span class="String">"</span><span class="String">test.jpg</span><span class="String">"</span>, (<span class="ID">obj</span>, <span class="ID">res</span>) =&gt; {</span>
<span class="line"><span class="anchor" id="line-4-73"></span>      <span class="ID">display_jpeg</span>.<span class="ID">end</span>(<span class="ID">res</span>);</span>
<span class="line"><span class="anchor" id="line-5-61"></span>  });</span>
</pre></div></div><span class="anchor" id="line-2256"></span><span class="anchor" id="line-2257"></span><p class="line874">The first two forms are equivalent, and start the async method running <span class="anchor" id="line-2258"></span>with the given arguments.  The third form in addition registers an <span class="anchor" id="line-2259"></span>AsyncReadyCallback which is executed when the method finishes.  In <span class="anchor" id="line-2260"></span>the callback the <tt class="backtick">.end()</tt> method should be called to receive the <span class="anchor" id="line-2261"></span>return value of the asynchronous method if it has one.  If the async <span class="anchor" id="line-2262"></span>method can throw an exception, the <tt class="backtick">.end()</tt> call is where the <span class="anchor" id="line-2263"></span>exception arrives and must be caught.  If the method has <tt class="backtick">out</tt> <span class="anchor" id="line-2264"></span>arguments, then these should be omitted from the <tt class="backtick">.begin()</tt> call and <span class="anchor" id="line-2265"></span>added to the <tt class="backtick">.end()</tt> call instead. <span class="anchor" id="line-2266"></span><span class="anchor" id="line-2267"></span></p><p class="line874">For example: <span class="anchor" id="line-2268"></span><span class="anchor" id="line-2269"></span></p><p class="line867"><span class="anchor" id="line-2270"></span><span class="anchor" id="line-2271"></span><span class="anchor" id="line-2272"></span><span class="anchor" id="line-2273"></span><span class="anchor" id="line-2274"></span><span class="anchor" id="line-2275"></span><span class="anchor" id="line-2276"></span><span class="anchor" id="line-2277"></span><span class="anchor" id="line-2278"></span><span class="anchor" id="line-2279"></span><span class="anchor" id="line-1-262"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-92c0767e86b7f5dc6deb6d6fd62fca8f30bc1da9" lang="en"><span class="line"><span class="anchor" id="line-1-263"></span>  <span class="ID">fetch_webpage</span>.<span class="ID">begin</span>(<span class="String">"</span><span class="String">http://www.example.com/</span><span class="String">"</span>, (<span class="ID">obj</span>, <span class="ID">res</span>) =&gt; {</span>
<span class="line"><span class="anchor" id="line-2-111"></span>      <span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-3-92"></span>          <span class="ID">string</span> <span class="ID">text</span>;</span>
<span class="line"><span class="anchor" id="line-4-74"></span>          <span class="ID">var</span> <span class="ID">status</span> = <span class="ID">fetch_webpage</span>.<span class="ID">end</span>(<span class="ID">res</span>, <span class="ID">out</span> <span class="ID">text</span>);</span>
<span class="line"><span class="anchor" id="line-5-62"></span>          <span class="Comment">// Result of call is in 'text' and 'status' ...</span></span>
<span class="line"><span class="anchor" id="line-6-52"></span><span class="Comment"></span>      } <span class="ResWord">catch</span> (<span class="ID">IOError</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-7-47"></span>          <span class="Comment">// Problem ...</span></span>
<span class="line"><span class="anchor" id="line-8-41"></span><span class="Comment"></span>      }</span>
<span class="line"><span class="anchor" id="line-9-40"></span>  });</span>
</pre></div></div><span class="anchor" id="line-2280"></span><span class="anchor" id="line-2281"></span><p class="line874">When an asynchronous method starts running, it takes control of the <span class="anchor" id="line-2282"></span>CPU until it reaches its first <tt class="backtick">yield</tt> statement, at which point it <span class="anchor" id="line-2283"></span>returns to the caller.  When the method is resumed, it continues <span class="anchor" id="line-2284"></span>execution immediately after that <tt class="backtick">yield</tt> statement.  There are several <span class="anchor" id="line-2285"></span>common ways to use <tt class="backtick">yield</tt>: <span class="anchor" id="line-2286"></span><span class="anchor" id="line-2287"></span></p><p class="line874">This form gives up control, but arranges for the GLib main loop to <span class="anchor" id="line-2288"></span>resume the method when there are no more events to process: <span class="anchor" id="line-2289"></span><span class="anchor" id="line-2290"></span></p><p class="line867"><span class="anchor" id="line-2291"></span><span class="anchor" id="line-2292"></span><span class="anchor" id="line-2293"></span><span class="anchor" id="line-1-264"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-03dd12028b3e94b14aa59b30d947904e5b721f85" lang="en"><span class="line"><span class="anchor" id="line-1-265"></span>  <span class="ID">Idle</span>.<span class="ID">add</span>(<span class="ID">fetch_webpage</span>.<span class="ID">callback</span>);</span>
<span class="line"><span class="anchor" id="line-2-112"></span>  <span class="ID">yield</span>;</span>
</pre></div></div><span class="anchor" id="line-2294"></span><span class="anchor" id="line-2295"></span><p class="line874">This form gives up control, and stores the callback details for some <span class="anchor" id="line-2296"></span>other code to use to resume the method's execution: <span class="anchor" id="line-2297"></span><span class="anchor" id="line-2298"></span></p><p class="line867"><span class="anchor" id="line-2299"></span><span class="anchor" id="line-2300"></span><span class="anchor" id="line-2301"></span><span class="anchor" id="line-2302"></span><span class="anchor" id="line-1-266"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-80adf41c411696b8585c9149a535e9db94a06509" lang="en"><span class="line"><span class="anchor" id="line-1-267"></span>  <span class="ID">SourceFunc</span> <span class="ID">callback</span> = <span class="ID">fetch_webpage</span>.<span class="ID">callback</span>;</span>
<span class="line"><span class="anchor" id="line-2-113"></span>  [... <span class="ID">store</span> '<span class="ID">callback</span>' <span class="ID">somewhere</span> ...]</span>
<span class="line"><span class="anchor" id="line-3-93"></span>  <span class="ID">yield</span>;</span>
</pre></div></div><span class="anchor" id="line-2303"></span><span class="anchor" id="line-2304"></span><p class="line862">Some code elsewhere must now call the stored SourceFunc in order for <span class="anchor" id="line-2305"></span>the method to be resumed.  This could be done by scheduling the GLib <span class="anchor" id="line-2306"></span>main loop to run it: <span class="anchor" id="line-2307"></span><span class="anchor" id="line-2308"></span></p><p class="line867"><span class="anchor" id="line-2309"></span><span class="anchor" id="line-2310"></span><span class="anchor" id="line-1-268"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1709901878bbf3f2a4a24c6bc82da5bf83403527" lang="en"><span class="line"><span class="anchor" id="line-1-269"></span>  <span class="ID">Idle</span>.<span class="ID">add</span>((<span class="ID">owned</span>) <span class="ID">callback</span>);</span>
</pre></div></div><span class="anchor" id="line-2311"></span><span class="anchor" id="line-2312"></span><p class="line874">or alternatively a direct call may be made if the caller is running in <span class="anchor" id="line-2313"></span>the main thread: <span class="anchor" id="line-2314"></span><span class="anchor" id="line-2315"></span></p><p class="line867"><span class="anchor" id="line-2316"></span><span class="anchor" id="line-2317"></span><span class="anchor" id="line-1-270"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-f88de8fc2aff7e1b2b28e526c5cafaf7cbc543da" lang="en"><span class="line"><span class="anchor" id="line-1-271"></span>  <span class="ID">callback</span>();</span>
</pre></div></div><span class="anchor" id="line-2318"></span><span class="anchor" id="line-2319"></span><p class="line874">If the direct call above is used, then the resumed asynchronous method <span class="anchor" id="line-2320"></span>takes control of the CPU immediately and runs until its next <tt class="backtick">yield</tt> <span class="anchor" id="line-2321"></span>before returning to the code that executed <tt class="backtick">callback()</tt>.  The <span class="anchor" id="line-2322"></span><tt class="backtick">Idle.add()</tt> method is useful if the callback must be made from a <span class="anchor" id="line-2323"></span>background thread, e.g. to resume the async method after completion of <span class="anchor" id="line-2324"></span>some background processing.  (The <tt class="backtick">(owned)</tt> cast is necessary to avoid <span class="anchor" id="line-2325"></span>a warning about copying delegates.) <span class="anchor" id="line-2326"></span><span class="anchor" id="line-2327"></span></p><p class="line862">The third common way of using <tt class="backtick">yield</tt> is when calling another <span class="anchor" id="line-2328"></span>asynchronous method, for example: <span class="anchor" id="line-2329"></span><span class="anchor" id="line-2330"></span></p><p class="line867"><span class="anchor" id="line-2331"></span><span class="anchor" id="line-2332"></span><span class="anchor" id="line-1-272"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-28cbe578b50ba9bd57323a458ac085b3cf19f48a" lang="en"><span class="line"><span class="anchor" id="line-1-273"></span>  <span class="ID">yield</span> <span class="ID">display_jpeg</span>(<span class="ID">fnam</span>);</span>
</pre></div></div><span class="anchor" id="line-2333"></span><span class="anchor" id="line-2334"></span><p class="line874">or <span class="anchor" id="line-2335"></span><span class="anchor" id="line-2336"></span></p><p class="line867"><span class="anchor" id="line-2337"></span><span class="anchor" id="line-2338"></span><span class="anchor" id="line-1-274"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1f607a196207c8b1c2bbd7fb5ac16f0c0dfd30ef" lang="en"><span class="line"><span class="anchor" id="line-1-275"></span>  <span class="ID">var</span> <span class="ID">status</span> = <span class="ID">yield</span> <span class="ID">fetch_webpage</span>(<span class="ID">url</span>, <span class="ID">out</span> <span class="ID">text</span>);</span>
</pre></div></div><span class="anchor" id="line-2339"></span><span class="anchor" id="line-2340"></span><p class="line874">In both cases, the calling method gives up control of the CPU and does <span class="anchor" id="line-2341"></span>not resume until the called method completes.  The <tt class="backtick">yield</tt> statement <span class="anchor" id="line-2342"></span>automatically registers a callback with the called method to make sure <span class="anchor" id="line-2343"></span>that the caller resumes correctly.  The automatic callback also <span class="anchor" id="line-2344"></span>collects the return value from the called method. <span class="anchor" id="line-2345"></span><span class="anchor" id="line-2346"></span></p><p class="line862">When this <tt class="backtick">yield</tt> statement executes, control of the CPU first passes <span class="anchor" id="line-2347"></span>to the called method which runs until its first <tt class="backtick">yield</tt> and then drops <span class="anchor" id="line-2348"></span>back to the calling method, which completes the <tt class="backtick">yield</tt> statement <span class="anchor" id="line-2349"></span>itself, and then gives back control to its own caller. <span class="anchor" id="line-2350"></span><span class="anchor" id="line-2351"></span></p><p class="line867">
</p><h4 id="Examples">Examples</h4>
<span class="anchor" id="line-2352"></span><span class="anchor" id="line-2353"></span><p class="line862">See <a href="https://wiki.gnome.org/Projects/Vala/AsyncSamples">Async Method Samples</a> for examples of different  <span class="anchor" id="line-2354"></span>ways that async may be used. <span class="anchor" id="line-2355"></span><span class="anchor" id="line-2356"></span></p><p class="line867">
</p><h3 id="Weak_References">Weak References</h3>
<span class="anchor" id="line-2357"></span><span class="anchor" id="line-2358"></span><p class="line874">Vala's
 memory management is based on automatic reference counting.  Each time 
an object is assigned to a variable its internal reference count is 
increased by 1, each time a variable referencing an object goes out of 
scope its internal reference count is decreased by 1.  If the reference 
count reaches 0 the object will be freed. <span class="anchor" id="line-2359"></span><span class="anchor" id="line-2360"></span></p><p class="line874">However,
 it is possible to form a reference cycle with your data structures.  
For example, with a tree data structure where a child node holds a 
reference to its parent and vice versa, or a doubly-linked list where 
each element holds a reference to its predecessor and the predecessor 
holds a reference to its successor. <span class="anchor" id="line-2361"></span><span class="anchor" id="line-2362"></span></p><p class="line862">In
 these cases objects could keep themselves alive simply by referencing 
to each other, even though they should be freed.  To break such a 
reference cycle you can use the <tt class="backtick">weak</tt> modifier for one of the references: <span class="anchor" id="line-2363"></span><span class="anchor" id="line-2364"></span></p><p class="line867"><span class="anchor" id="line-2365"></span><span class="anchor" id="line-2366"></span><span class="anchor" id="line-2367"></span><span class="anchor" id="line-2368"></span><span class="anchor" id="line-2369"></span><span class="anchor" id="line-1-276"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-4e180c194c407a282e793a21ff95be96f650b821" lang="en"><span class="line"><span class="anchor" id="line-1-277"></span><span class="ResWord">class</span> <span class="ID">Node</span> {</span>
<span class="line"><span class="anchor" id="line-2-114"></span>    <span class="ResWord">public</span> <span class="ID">weak</span> <span class="ID">Node</span> <span class="ID">prev</span>;</span>
<span class="line"><span class="anchor" id="line-3-94"></span>    <span class="ResWord">public</span> <span class="ID">Node</span> <span class="ID">next</span>;</span>
<span class="line"><span class="anchor" id="line-4-75"></span>}</span>
</pre></div></div><span class="anchor" id="line-2370"></span><span class="anchor" id="line-2371"></span><p class="line862">This topic is explained in detail on this page: <a href="https://wiki.gnome.org/Projects/Vala/ReferenceHandling">Vala's Memory Management Explained</a>. <span class="anchor" id="line-2372"></span><span class="anchor" id="line-2373"></span></p><p class="line867">
</p><h3 id="Ownership">Ownership</h3>
<span class="anchor" id="line-2374"></span><span class="anchor" id="line-2375"></span><p class="line867">
</p><h4 id="Unowned_References">Unowned References</h4>
<span class="anchor" id="line-2376"></span><span class="anchor" id="line-2377"></span><p class="line874">Normally
 when creating an object in Vala you are returned a reference to it.  
Specifically this means that as well as being passed a pointer to the 
object in memory, it is also recorded in the object itself that this 
pointer exists.  Similarly, whenever another reference to the object is 
created, this is also recorded.  As an object knows how many references 
there are to it, it can automatically be removed when needed.  This is 
the basis of Vala's memory management. <span class="anchor" id="line-2378"></span><span class="anchor" id="line-2379"></span></p><p class="line867"><em>Unowned references</em>
 conversely are not recorded in the object they reference.  This allows 
the object to be removed when it logically should be, regardless of the 
fact that there might be still references to it. The usual way to 
achieve this is with a method defined to return an unowned reference, 
e.g.: <span class="anchor" id="line-2380"></span><span class="anchor" id="line-2381"></span></p><p class="line867"><span class="anchor" id="line-2382"></span><span class="anchor" id="line-2383"></span><span class="anchor" id="line-2384"></span><span class="anchor" id="line-2385"></span><span class="anchor" id="line-2386"></span><span class="anchor" id="line-2387"></span><span class="anchor" id="line-2388"></span><span class="anchor" id="line-2389"></span><span class="anchor" id="line-2390"></span><span class="anchor" id="line-1-278"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-4d61e2fa53a277e4fed4e52fb958cef6efdfcf04" lang="en"><span class="line"><span class="anchor" id="line-1-279"></span><span class="ResWord">class</span> <span class="ID">Test</span> {</span>
<span class="line"><span class="anchor" id="line-2-115"></span>    <span class="ResWord">private</span> <span class="ID">Object</span> <span class="ID">o</span>;</span>
<span class="line"><span class="anchor" id="line-3-95"></span></span>
<span class="line"><span class="anchor" id="line-4-76"></span>    <span class="ResWord">public</span> <span class="ID">unowned</span> <span class="ID">Object</span> <span class="ID">get_unowned_ref</span>() {</span>
<span class="line"><span class="anchor" id="line-5-63"></span>        <span class="ResWord">this</span>.<span class="ID">o</span> = <span class="ResWord">new</span> <span class="ID">Object</span>();</span>
<span class="line"><span class="anchor" id="line-6-53"></span>        <span class="ResWord">return</span> <span class="ResWord">this</span>.<span class="ID">o</span>;</span>
<span class="line"><span class="anchor" id="line-7-48"></span>    }</span>
<span class="line"><span class="anchor" id="line-8-42"></span>}</span>
</pre></div></div><span class="anchor" id="line-2391"></span><span class="anchor" id="line-2392"></span><p class="line874">When calling this method, in order to collect a reference to the returned object, you must expect to receive a weak reference: <span class="anchor" id="line-2393"></span><span class="anchor" id="line-2394"></span></p><p class="line867"><span class="anchor" id="line-2395"></span><span class="anchor" id="line-2396"></span><span class="anchor" id="line-1-280"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1c12113117e62c945339cb644ebb4bcdfac9adfc" lang="en"><span class="line"><span class="anchor" id="line-1-281"></span><span class="ID">unowned</span> <span class="ID">Object</span> <span class="ID">o</span> = <span class="ID">get_unowned_ref</span>();</span>
</pre></div></div><span class="anchor" id="line-2397"></span><span class="anchor" id="line-2398"></span><p class="line874">The reason for this seemingly over complicated example because of the concept of ownership. <span class="anchor" id="line-2399"></span></p><ul><li>If
 the Object "o" was not stored in the class, then when the method 
"get_unowned_ref" returned, "o" would become unowned (i.e. there would 
be no references to it).  If this were the case, the object would be 
deleted and the method would never return a valid reference. <span class="anchor" id="line-2400"></span></li><li>If
 the return value was not defined as unowned, the ownership would pass 
to the calling code.  The calling code is, however, expecting an unowned
 reference, which cannot receive the ownership. <span class="anchor" id="line-2401"></span><span class="anchor" id="line-2402"></span></li></ul><p class="line874">If the calling code is written as <span class="anchor" id="line-2403"></span><span class="anchor" id="line-2404"></span><span class="anchor" id="line-2405"></span><span class="anchor" id="line-1-282"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-7881ea792fcba98225d5ce542aa662d19b79295d" lang="en"><span class="line"><span class="anchor" id="line-1-283"></span><span class="ID">Object</span> <span class="ID">o</span> = <span class="ID">get_unowned_ref</span>();</span>
</pre></div></div><span class="anchor" id="line-2406"></span><p class="line874">Vala will try to either obtain a reference of or a duplicate of the instance the unowned reference pointing to. <span class="anchor" id="line-2407"></span><span class="anchor" id="line-2408"></span></p><p class="line874">In
 contrast to normal methods, properties always have unowned return 
value. That means you can't return a new object created within the get 
method. That also means, you can't use an owned return value from a 
method call. The somewhat irritating fact is because of that a property 
value is owned by the object that HAS this property. A call to obtain 
this property value should not steal or reproduce (by duplicating, or 
increasing the reference count of) the value from the object side. <span class="anchor" id="line-2409"></span><span class="anchor" id="line-2410"></span></p><p class="line874">As such, the following example will result in a compilation error <span class="anchor" id="line-2411"></span><span class="anchor" id="line-2412"></span></p><p class="line867"><span class="anchor" id="line-2413"></span><span class="anchor" id="line-2414"></span><span class="anchor" id="line-2415"></span><span class="anchor" id="line-2416"></span><span class="anchor" id="line-2417"></span><span class="anchor" id="line-2418"></span><span class="anchor" id="line-2419"></span><span class="anchor" id="line-2420"></span><span class="anchor" id="line-2421"></span><span class="anchor" id="line-2422"></span><span class="anchor" id="line-1-284"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-734b877e2bc371f2c9afc2388a554227307e4b89" lang="en"><span class="line"><span class="anchor" id="line-1-285"></span><span class="ResWord">public</span> <span class="ID">Object</span> <span class="ID">property</span> {</span>
<span class="line"><span class="anchor" id="line-2-116"></span>    <span class="ID">get</span> {</span>
<span class="line"><span class="anchor" id="line-3-96"></span>        <span class="ResWord">return</span> <span class="ResWord">new</span> <span class="ID">Object</span>();   <span class="Comment">// WRONG: property returns an unowned reference,</span></span>
<span class="line"><span class="anchor" id="line-4-77"></span><span class="Comment"></span>                               <span class="Comment">// the newly created object will be deleted when</span></span>
<span class="line"><span class="anchor" id="line-5-64"></span><span class="Comment"></span>                               <span class="Comment">// the getter scope ends the caller of the</span></span>
<span class="line"><span class="anchor" id="line-6-54"></span><span class="Comment"></span>                               <span class="Comment">// getter ends up receiving an invalid reference</span></span>
<span class="line"><span class="anchor" id="line-7-49"></span><span class="Comment"></span>                               <span class="Comment">// to a deleted object.</span></span>
<span class="line"><span class="anchor" id="line-8-43"></span><span class="Comment"></span>    }</span>
<span class="line"><span class="anchor" id="line-9-41"></span>}</span>
</pre></div></div><span class="anchor" id="line-2423"></span><span class="anchor" id="line-2424"></span><p class="line874">nor can you do this <span class="anchor" id="line-2425"></span><span class="anchor" id="line-2426"></span></p><p class="line867"><span class="anchor" id="line-2427"></span><span class="anchor" id="line-2428"></span><span class="anchor" id="line-2429"></span><span class="anchor" id="line-2430"></span><span class="anchor" id="line-2431"></span><span class="anchor" id="line-2432"></span><span class="anchor" id="line-2433"></span><span class="anchor" id="line-2434"></span><span class="anchor" id="line-2435"></span><span class="anchor" id="line-2436"></span><span class="anchor" id="line-1-286"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-4a7312bb56d7e80ac74bb72ce41f2cef9e6df146" lang="en"><span class="line"><span class="anchor" id="line-1-287"></span><span class="ResWord">public</span> <span class="ID">string</span> <span class="ID">property</span> {</span>
<span class="line"><span class="anchor" id="line-2-117"></span>    <span class="ID">get</span> {</span>
<span class="line"><span class="anchor" id="line-3-97"></span>        <span class="ResWord">return</span> <span class="ID">getter_method</span>();   <span class="Comment">// WRONG: for the same reason above.</span></span>
<span class="line"><span class="anchor" id="line-4-78"></span><span class="Comment"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-65"></span>}</span>
<span class="line"><span class="anchor" id="line-6-55"></span></span>
<span class="line"><span class="anchor" id="line-7-50"></span><span class="ResWord">public</span> <span class="ID">string</span> <span class="ID">getter_method</span>() {</span>
<span class="line"><span class="anchor" id="line-8-44"></span>    <span class="ResWord">return</span> <span class="String">"</span><span class="String">some text</span><span class="String">"</span>; <span class="Comment">// "some text" is duplicated and returned at this point.</span></span>
<span class="line"><span class="anchor" id="line-9-42"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-2437"></span><span class="anchor" id="line-2438"></span><p class="line874">on the other hand, this is perfectly fine <span class="anchor" id="line-2439"></span><span class="anchor" id="line-2440"></span></p><p class="line867"><span class="anchor" id="line-2441"></span><span class="anchor" id="line-2442"></span><span class="anchor" id="line-2443"></span><span class="anchor" id="line-2444"></span><span class="anchor" id="line-2445"></span><span class="anchor" id="line-2446"></span><span class="anchor" id="line-2447"></span><span class="anchor" id="line-2448"></span><span class="anchor" id="line-2449"></span><span class="anchor" id="line-2450"></span><span class="anchor" id="line-2451"></span><span class="anchor" id="line-2452"></span><span class="anchor" id="line-2453"></span><span class="anchor" id="line-1-288"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-32e00b1d5ef79d2c205a4cbc0d3701bda8f27998" lang="en"><span class="line"><span class="anchor" id="line-1-289"></span><span class="ResWord">public</span> <span class="ID">string</span> <span class="ID">property</span> {</span>
<span class="line"><span class="anchor" id="line-2-118"></span>    <span class="ID">get</span> {</span>
<span class="line"><span class="anchor" id="line-3-98"></span>        <span class="ResWord">return</span> <span class="ID">getter_method</span>();   <span class="Comment">// GOOD: getter_method returns an unowned value</span></span>
<span class="line"><span class="anchor" id="line-4-79"></span><span class="Comment"></span>    }</span>
<span class="line"><span class="anchor" id="line-5-66"></span>}</span>
<span class="line"><span class="anchor" id="line-6-56"></span></span>
<span class="line"><span class="anchor" id="line-7-51"></span><span class="ResWord">public</span> <span class="ID">unowned</span> <span class="ID">string</span> <span class="ID">getter_method</span>() {</span>
<span class="line"><span class="anchor" id="line-8-45"></span>    <span class="ResWord">return</span> <span class="String">"</span><span class="String">some text</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-9-43"></span>    <span class="Comment">// Don't be alarmed that the text is not assigned to any strong variable.</span></span>
<span class="line"><span class="anchor" id="line-10-33"></span><span class="Comment"></span>    <span class="Comment">// Literal strings in Vala are always owned by the program module itself,</span></span>
<span class="line"><span class="anchor" id="line-11-30"></span><span class="Comment"></span>    <span class="Comment">// and exist as long as the module is in memory</span></span>
<span class="line"><span class="anchor" id="line-12-25"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-2454"></span><span class="anchor" id="line-2455"></span><p class="line862">The <tt class="backtick">unowned</tt> modifier can be used to make automatic property's storage unowned. <span class="anchor" id="line-2456"></span>That means <span class="anchor" id="line-2457"></span><span class="anchor" id="line-2458"></span></p><p class="line867"><span class="anchor" id="line-2459"></span><span class="anchor" id="line-2460"></span><span class="anchor" id="line-1-290"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-9e170bab3d14ae1fc68c235c097b1bb8b706890d" lang="en"><span class="line"><span class="anchor" id="line-1-291"></span><span class="ResWord">public</span> <span class="ID">unowned</span> <span class="ID">Object</span> <span class="ID">property</span> { <span class="ID">get</span>; <span class="ResWord">private</span> <span class="ID">set</span>; }</span>
</pre></div></div><span class="anchor" id="line-2461"></span><span class="anchor" id="line-2462"></span><p class="line874">is identical to <span class="anchor" id="line-2463"></span><span class="anchor" id="line-2464"></span></p><p class="line867"><span class="anchor" id="line-2465"></span><span class="anchor" id="line-2466"></span><span class="anchor" id="line-2467"></span><span class="anchor" id="line-2468"></span><span class="anchor" id="line-2469"></span><span class="anchor" id="line-2470"></span><span class="anchor" id="line-1-292"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a7805d42145212145e242514da6ee85388cd566c" lang="en"><span class="line"><span class="anchor" id="line-1-293"></span><span class="ResWord">private</span> <span class="ID">unowned</span> <span class="ID">Object</span> <span class="ID">_property</span>;</span>
<span class="line"><span class="anchor" id="line-2-119"></span></span>
<span class="line"><span class="anchor" id="line-3-99"></span><span class="ResWord">public</span> <span class="ID">Object</span> <span class="ID">property</span> {</span>
<span class="line"><span class="anchor" id="line-4-80"></span>    <span class="ID">get</span> { <span class="ResWord">return</span> <span class="ID">_property</span>; }</span>
<span class="line"><span class="anchor" id="line-5-67"></span>}</span>
</pre></div></div><span class="anchor" id="line-2471"></span><span class="anchor" id="line-2472"></span><p class="line862">The keyword <tt class="backtick">owned</tt>
 can be used to specifically ask a property to return a owned reference 
of the value, therefore causing the property value be reproduced in the 
object side. Think twice before adding the <tt class="backtick">owned</tt> keyword. Is it a property or simply a <tt class="backtick">get_xxx</tt> method? There may also be problems in your design. Anyways, the following code is a correct segment, <span class="anchor" id="line-2473"></span><span class="anchor" id="line-2474"></span></p><p class="line867"><span class="anchor" id="line-2475"></span><span class="anchor" id="line-2476"></span><span class="anchor" id="line-1-294"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-13868005e853c5cbebf867a6a53af7cfe2b0931b" lang="en"><span class="line"><span class="anchor" id="line-1-295"></span><span class="ResWord">public</span> <span class="ID">owned</span> <span class="ID">Object</span> <span class="ID">property</span> { <span class="ID">owned</span> <span class="ID">get</span> { <span class="ResWord">return</span> <span class="ResWord">new</span> <span class="ID">Object</span>(); } }</span>
</pre></div></div><span class="anchor" id="line-2477"></span><span class="anchor" id="line-2478"></span><p class="line874">Unowned
 references play a similar role to pointers which are described later.  
They are however much simpler to use than pointers, as they can be 
easily converted to normal references.  However, in general they should 
not be widely used in the programs unless you know what you are doing. <span class="anchor" id="line-2479"></span><span class="anchor" id="line-2480"></span></p><p class="line867">
</p><h4 id="Ownership_Transfer">Ownership Transfer</h4>
<span class="anchor" id="line-2481"></span><span class="anchor" id="line-2482"></span><p class="line862">The keyword <tt class="backtick">owned</tt> is used to transfer ownership. <span class="anchor" id="line-2483"></span><span class="anchor" id="line-2484"></span></p><ul><li>As a prefix of a parameter type, it means that ownership of the object is transferred into this code context. <span class="anchor" id="line-2485"></span></li><li>As
 an type conversion operator, it can be used to avoid duplicating 
non-reference counting classes, which is usually impossible in Vala. For
 example, <span class="anchor" id="line-2486"></span><span class="anchor" id="line-2487"></span></li></ul><p class="line867"><span class="anchor" id="line-2488"></span><span class="anchor" id="line-2489"></span><span class="anchor" id="line-1-296"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-8976aad5365673a51db892a2f8f8edbcd8cc3b50" lang="en"><span class="line"><span class="anchor" id="line-1-297"></span><span class="ID">Foo</span> <span class="ID">foo</span> = (<span class="ID">owned</span>) <span class="ID">bar</span>;</span>
</pre></div></div><span class="anchor" id="line-2490"></span><span class="anchor" id="line-2491"></span><p class="line862">This means that <em>bar</em> will be set to <em>null</em> and <em>foo</em> inherits the reference/ownership of the object <em>bar</em> references. <span class="anchor" id="line-2492"></span><span class="anchor" id="line-2493"></span></p><p class="line867">
</p><h3 id="Variable-Length_Argument_Lists">Variable-Length Argument Lists</h3>
<span class="anchor" id="line-2494"></span><span class="anchor" id="line-2495"></span><p class="line874">Vala
 supports C-style variable-length argument lists ("varargs") for 
methods.  They are declared with an ellipsis ("...") in the method 
signature.  A method with varargs requires at least one fixed argument: <span class="anchor" id="line-2496"></span><span class="anchor" id="line-2497"></span></p><p class="line867"><span class="anchor" id="line-2498"></span><span class="anchor" id="line-2499"></span><span class="anchor" id="line-2500"></span><span class="anchor" id="line-2501"></span><span class="anchor" id="line-2502"></span><span class="anchor" id="line-2503"></span><span class="anchor" id="line-2504"></span><span class="anchor" id="line-1-298"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-acb6d67fd4e294065ab4fa211c675f03d14b3522" lang="en"><span class="line"><span class="anchor" id="line-1-299"></span><span class="ResWord">void</span> <span class="ID">method_with_varargs</span>(<span class="ResWord">int</span> <span class="ID">x</span>, ...) {</span>
<span class="line"><span class="anchor" id="line-2-120"></span>    <span class="ID">var</span> <span class="ID">l</span> = <span class="ID">va_list</span>();</span>
<span class="line"><span class="anchor" id="line-3-100"></span>    <span class="ID">string</span> <span class="ID">s</span> = <span class="ID">l</span>.<span class="ID">arg</span>();</span>
<span class="line"><span class="anchor" id="line-4-81"></span>    <span class="ResWord">int</span> <span class="ID">i</span> = <span class="ID">l</span>.<span class="ID">arg</span>();</span>
<span class="line"><span class="anchor" id="line-5-68"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%s: %d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">s</span>, <span class="ID">i</span>);</span>
<span class="line"><span class="anchor" id="line-6-57"></span>}</span>
</pre></div></div><span class="anchor" id="line-2505"></span><span class="anchor" id="line-2506"></span><p class="line862">In this example <tt class="backtick">x</tt> is a fixed argument to meet the requirements.  You obtain the varargs list with <tt class="backtick">va_list()</tt>.  Then you can retrieve the arguments one after another by calling the generic method <tt class="backtick">arg&lt;T&gt;()</tt>
 sequently on this list, with T being the type that the argument should 
be interpreted as.  If the type is evident from the context (as in our 
example) the type is inferred automatically and you can just call <tt class="backtick">arg()</tt> without the generic type argument. <span class="anchor" id="line-2507"></span><span class="anchor" id="line-2508"></span></p><p class="line862">This example parses an arbitrary number of <em>string - double</em> argument pairs: <span class="anchor" id="line-2509"></span><span class="anchor" id="line-2510"></span></p><p class="line867"><span class="anchor" id="line-2511"></span><span class="anchor" id="line-2512"></span><span class="anchor" id="line-2513"></span><span class="anchor" id="line-2514"></span><span class="anchor" id="line-2515"></span><span class="anchor" id="line-2516"></span><span class="anchor" id="line-2517"></span><span class="anchor" id="line-2518"></span><span class="anchor" id="line-2519"></span><span class="anchor" id="line-2520"></span><span class="anchor" id="line-2521"></span><span class="anchor" id="line-2522"></span><span class="anchor" id="line-2523"></span><span class="anchor" id="line-2524"></span><span class="anchor" id="line-2525"></span><span class="anchor" id="line-2526"></span><span class="anchor" id="line-1-300"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-aba1c2f6cb23257f5faa24d1d90079112d7fc99e" lang="en"><span class="line"><span class="anchor" id="line-1-301"></span><span class="ResWord">void</span> <span class="ID">method_with_varargs</span>(<span class="ResWord">int</span> <span class="ID">fixed</span>, ...) {</span>
<span class="line"><span class="anchor" id="line-2-121"></span>    <span class="ID">var</span> <span class="ID">l</span> = <span class="ID">va_list</span>();</span>
<span class="line"><span class="anchor" id="line-3-101"></span>    <span class="ResWord">while</span> (<span class="ConsWord">true</span>) {</span>
<span class="line"><span class="anchor" id="line-4-82"></span>        <span class="ID">string</span>? <span class="ID">key</span> = <span class="ID">l</span>.<span class="ID">arg</span>();</span>
<span class="line"><span class="anchor" id="line-5-69"></span>        <span class="ResWord">if</span> (<span class="ID">key</span> == <span class="ID">null</span>) {</span>
<span class="line"><span class="anchor" id="line-6-58"></span>            <span class="ResWord">break</span>;  <span class="Comment">// end of the list</span></span>
<span class="line"><span class="anchor" id="line-7-52"></span><span class="Comment"></span>        }</span>
<span class="line"><span class="anchor" id="line-8-46"></span>        <span class="ResWord">double</span> <span class="ID">val</span> = <span class="ID">l</span>.<span class="ID">arg</span>();</span>
<span class="line"><span class="anchor" id="line-9-44"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%s: %g</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">key</span>, <span class="ID">val</span>);</span>
<span class="line"><span class="anchor" id="line-10-34"></span>    }</span>
<span class="line"><span class="anchor" id="line-11-31"></span>}</span>
<span class="line"><span class="anchor" id="line-12-26"></span></span>
<span class="line"><span class="anchor" id="line-13-24"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-14-23"></span>    <span class="ID">method_with_varargs</span>(<span class="Number">42</span>, <span class="String">"</span><span class="String">foo</span><span class="String">"</span>, <span class="Number">0.75</span>, <span class="String">"</span><span class="String">bar</span><span class="String">"</span>, <span class="Number">0.25</span>, <span class="String">"</span><span class="String">baz</span><span class="String">"</span>, <span class="Number">0.32</span>);</span>
<span class="line"><span class="anchor" id="line-15-21"></span>}</span>
</pre></div></div><span class="anchor" id="line-2527"></span><span class="anchor" id="line-2528"></span><p class="line862">It checks for <em>null</em> as a sentinel to recognize the end of the varargs list.  Vala always implicitly passes <em>null</em> as the last argument of a varargs method call. <span class="anchor" id="line-2529"></span><span class="anchor" id="line-2530"></span></p><p class="line874">Varargs
 have a serious drawback that you should be aware of: they are not 
type-safe.  The compiler can't tell you whether you are passing 
arguments of the right type to the method or not.  That's why you should
 consider using varargs only if you have a good reason, for example: 
providing a convenience function for C programmers using your Vala 
library, binding a C function.  Often an array argument is a better 
choice. <span class="anchor" id="line-2531"></span><span class="anchor" id="line-2532"></span></p><p class="line862">A common pattern with varargs is to expect alternating <em>string - value</em> pairs as arguments, usually meaning <em>gobject property - value</em>. In this case you can write <em>property: value</em> instead, e.g.: <span class="anchor" id="line-2533"></span><span class="anchor" id="line-2534"></span></p><p class="line867"><span class="anchor" id="line-2535"></span><span class="anchor" id="line-2536"></span><span class="anchor" id="line-1-302"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-4dc72353c458fa3513b9c733c00900472a2f29f3" lang="en"><span class="line"><span class="anchor" id="line-1-303"></span><span class="ID">actor</span>.<span class="ID">animate</span> (<span class="ID">AnimationMode</span>.<span class="ID">EASE_OUT_BOUNCE</span>, <span class="Number">3000</span>, <span class="ID">x:</span> <span class="Number">100.0</span>, <span class="ID">y:</span> <span class="Number">200.0</span>, <span class="ID">rotation_angle_z:</span> <span class="Number">500.0</span>, <span class="ID">opacity:</span> <span class="Number">0</span>);</span>
</pre></div></div><span class="anchor" id="line-2537"></span><span class="anchor" id="line-2538"></span><p class="line874">is equivalent to: <span class="anchor" id="line-2539"></span><span class="anchor" id="line-2540"></span></p><p class="line867"><span class="anchor" id="line-2541"></span><span class="anchor" id="line-2542"></span><span class="anchor" id="line-1-304"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-24163dd0ab2f3dc7fb57d90bff104b819369772e" lang="en"><span class="line"><span class="anchor" id="line-1-305"></span><span class="ID">actor</span>.<span class="ID">animate</span> (<span class="ID">AnimationMode</span>.<span class="ID">EASE_OUT_BOUNCE</span>, <span class="Number">3000</span>, <span class="String">"</span><span class="String">x</span><span class="String">"</span>, <span class="Number">100.0</span>, <span class="String">"</span><span class="String">y</span><span class="String">"</span>, <span class="Number">200.0</span>, <span class="String">"</span><span class="String">rotation-angle-z</span><span class="String">"</span>, <span class="Number">500.0</span>, <span class="String">"</span><span class="String">opacity</span><span class="String">"</span>, <span class="Number">0</span>);</span>
</pre></div></div><span class="anchor" id="line-2543"></span><span class="anchor" id="line-2544"></span><p class="line867">
</p><h3 id="Pointers">Pointers</h3>
<span class="anchor" id="line-2545"></span><span class="anchor" id="line-2546"></span><p class="line874">Pointers
 are Vala's way of allowing manual memory management.  Normally when you
 create an instance of a type you receive a reference to it, and Vala 
will take care of destroying the instance when there are no more 
references left to it.  By requesting instead a pointer to an instance, 
you take responsibility for destroying the instance when it is no longer
 wanted, and therefore get greater control over how much memory is used.
 <span class="anchor" id="line-2547"></span><span class="anchor" id="line-2548"></span></p><p class="line874">This
 functionality is not necessarily needed most of the time, as modern 
computers are usually fast enough to handle reference counting and have 
enough memory that small inefficiencies are not important.  The times 
when you might resort to manual memory management are: <span class="anchor" id="line-2549"></span><span class="anchor" id="line-2550"></span></p><ul><li><p class="line862">When you specifically want to optimise part of a program and <a href="https://wiki.gnome.org/Projects/Vala/Tutorial#Unowned_References">unowned references</a> are insufficient. <span class="anchor" id="line-2551"></span></p></li><li>When
 you are dealing with an external library that does not implement 
reference counting for memory management (probably meaning one not based
 on gobject.) <span class="anchor" id="line-2552"></span><span class="anchor" id="line-2553"></span></li></ul><p class="line874">In order to create an instance of a type, and receive a pointer to it: <span class="anchor" id="line-2554"></span><span class="anchor" id="line-2555"></span></p><p class="line867"><span class="anchor" id="line-2556"></span><span class="anchor" id="line-2557"></span><span class="anchor" id="line-1-306"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-9f491362515e8e48c679e3d7ad2e99c48553ffa5" lang="en"><span class="line"><span class="anchor" id="line-1-307"></span><span class="ID">Object</span>* <span class="ID">o</span> = <span class="ResWord">new</span> <span class="ID">Object</span>();</span>
</pre></div></div><span class="anchor" id="line-2558"></span><span class="anchor" id="line-2559"></span><p class="line874">In order to access members of that instance: <span class="anchor" id="line-2560"></span><span class="anchor" id="line-2561"></span></p><p class="line867"><span class="anchor" id="line-2562"></span><span class="anchor" id="line-2563"></span><span class="anchor" id="line-2564"></span><span class="anchor" id="line-1-308"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-cff33d6ac23a3a252777c94449e49cd9edfbead2" lang="en"><span class="line"><span class="anchor" id="line-1-309"></span><span class="ID">o</span>-&gt;<span class="ID">method_1</span>();</span>
<span class="line"><span class="anchor" id="line-2-122"></span><span class="ID">o</span>-&gt;<span class="ID">data_1</span>;</span>
</pre></div></div><span class="anchor" id="line-2565"></span><span class="anchor" id="line-2566"></span><p class="line874">In order to free the memory pointed to: <span class="anchor" id="line-2567"></span><span class="anchor" id="line-2568"></span></p><p class="line867"><span class="anchor" id="line-2569"></span><span class="anchor" id="line-2570"></span><span class="anchor" id="line-1-310"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a9d6464a78b425fd9d8eb2e2f9e24f0047f53977" lang="en"><span class="line"><span class="anchor" id="line-1-311"></span><span class="ResWord">delete</span> <span class="ID">o</span>;</span>
</pre></div></div><span class="anchor" id="line-2571"></span><span class="anchor" id="line-2572"></span><p class="line862">Vala also supports the <em>address-of</em> (<tt class="backtick">&amp;</tt>) and <em>indirection</em> (<tt class="backtick">*</tt>) operators known from C: <span class="anchor" id="line-2573"></span><span class="anchor" id="line-2574"></span></p><p class="line867"><span class="anchor" id="line-2575"></span><span class="anchor" id="line-2576"></span><span class="anchor" id="line-2577"></span><span class="anchor" id="line-2578"></span><span class="anchor" id="line-1-312"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-8f622c080ee934da9b12769b7f5ed94b32f88aee" lang="en"><span class="line"><span class="anchor" id="line-1-313"></span><span class="ResWord">int</span> <span class="ID">i</span> = <span class="Number">42</span>;</span>
<span class="line"><span class="anchor" id="line-2-123"></span><span class="ResWord">int</span>* <span class="ID">i_ptr</span> = &amp;<span class="ID">i</span>;    <span class="Comment">// address-of</span></span>
<span class="line"><span class="anchor" id="line-3-102"></span><span class="Comment"></span><span class="ResWord">int</span> <span class="ID">j</span> = *<span class="ID">i_ptr</span>;     <span class="Comment">// indirection</span></span>
<span class="line"><span class="anchor" id="line-4-83"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-2579"></span><span class="anchor" id="line-2580"></span><p class="line874">The behavior is a bit different with reference types, you can omit the address-of and indirection operator on assignment: <span class="anchor" id="line-2581"></span><span class="anchor" id="line-2582"></span></p><p class="line867"><span class="anchor" id="line-2583"></span><span class="anchor" id="line-2584"></span><span class="anchor" id="line-2585"></span><span class="anchor" id="line-2586"></span><span class="anchor" id="line-2587"></span><span class="anchor" id="line-2588"></span><span class="anchor" id="line-1-314"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-fd87de3aa3d14cb0c574a38bdefb5fd50460554a" lang="en"><span class="line"><span class="anchor" id="line-1-315"></span><span class="ID">Foo</span> <span class="ID">f</span> = <span class="ResWord">new</span> <span class="ID">Foo</span>();</span>
<span class="line"><span class="anchor" id="line-2-124"></span><span class="ID">Foo</span>* <span class="ID">f_ptr</span> = <span class="ID">f</span>;    <span class="Comment">// address-of</span></span>
<span class="line"><span class="anchor" id="line-3-103"></span><span class="Comment"></span><span class="ID">Foo</span> <span class="ID">g</span> = <span class="ID">f_ptr</span>;     <span class="Comment">// indirection</span></span>
<span class="line"><span class="anchor" id="line-4-84"></span><span class="Comment"></span></span>
<span class="line"><span class="anchor" id="line-5-70"></span><span class="ID">unowned</span> <span class="ID">Foo</span> <span class="ID">f_weak</span> = <span class="ID">f</span>;  <span class="Comment">// equivalent to the second line</span></span>
<span class="line"><span class="anchor" id="line-6-59"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-2589"></span><span class="anchor" id="line-2590"></span><p class="line874">The usage of reference-type pointers is equivalent to the use of unowned references. <span class="anchor" id="line-2591"></span><span class="anchor" id="line-2592"></span></p><p class="line867">
</p><h3 id="Non-Object_classes">Non-Object classes</h3>
<span class="anchor" id="line-2593"></span><span class="anchor" id="line-2594"></span><p class="line862">Classes defined as not being descended from <em>GLib.Object</em>
 are treated as a special case.  They are derived directly from GLib's 
type system and therefore much lighter in weight.  In a more recent Vala
 compiler, one can also implement interfaces, signals and properties 
with these classes. <span class="anchor" id="line-2595"></span><span class="anchor" id="line-2596"></span></p><p class="line862">One obvious case of using these non-<em>Object</em>
 classes stays in the GLib bindings.  Because GLib is at a lower level 
than GObject, most classes defined in the binding are of this kind.  
Also, as mentioned before, the lighter weight of non-object classes make
 them useful in many practical situations (e.g. the Vala compiler 
itself).  However the detailed usage of non-<em>Object</em> classes are outside the scope of this tutorial.  Be aware that these classes are fundamentally different from structs. <span class="anchor" id="line-2597"></span><span class="anchor" id="line-2598"></span></p><p class="line867">
</p><h3 id="D-Bus_Integration">D-Bus Integration</h3>
<span class="anchor" id="line-2599"></span><span class="anchor" id="line-2600"></span><p class="line867"><a class="http" href="http://freedesktop.org/wiki/Software/dbus">D-Bus</a> is tightly integrated into the language and has never been easier than with Vala. <span class="anchor" id="line-2601"></span><span class="anchor" id="line-2602"></span></p><p class="line862">To export a custom class as a D-Bus service you just need to annotate it with the <em>DBus</em> code attribute and register an instance of this class with your local D-Bus session. <span class="anchor" id="line-2603"></span><span class="anchor" id="line-2604"></span></p><p class="line867"><span class="anchor" id="line-2605"></span><span class="anchor" id="line-2606"></span><span class="anchor" id="line-2607"></span><span class="anchor" id="line-2608"></span><span class="anchor" id="line-2609"></span><span class="anchor" id="line-2610"></span><span class="anchor" id="line-2611"></span><span class="anchor" id="line-2612"></span><span class="anchor" id="line-2613"></span><span class="anchor" id="line-2614"></span><span class="anchor" id="line-2615"></span><span class="anchor" id="line-2616"></span><span class="anchor" id="line-2617"></span><span class="anchor" id="line-2618"></span><span class="anchor" id="line-2619"></span><span class="anchor" id="line-2620"></span><span class="anchor" id="line-2621"></span><span class="anchor" id="line-2622"></span><span class="anchor" id="line-2623"></span><span class="anchor" id="line-2624"></span><span class="anchor" id="line-2625"></span><span class="anchor" id="line-2626"></span><span class="anchor" id="line-2627"></span><span class="anchor" id="line-2628"></span><span class="anchor" id="line-2629"></span><span class="anchor" id="line-2630"></span><span class="anchor" id="line-2631"></span><span class="anchor" id="line-2632"></span><span class="anchor" id="line-2633"></span><span class="anchor" id="line-2634"></span><span class="anchor" id="line-2635"></span><span class="anchor" id="line-2636"></span><span class="anchor" id="line-1-316"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-672e1c785cd1a65b66f1e6e055880edd8b9d8d8c" lang="en"><span class="line"><span class="anchor" id="line-1-317"></span>[<span class="ID">DBus</span>(<span class="ID">name</span> = <span class="String">"</span><span class="String">org.example.DemoService</span><span class="String">"</span>)]</span>
<span class="line"><span class="anchor" id="line-2-125"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">DemoService</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-3-104"></span>    <span class="Comment">/* Private field, not exported via D-Bus */</span></span>
<span class="line"><span class="anchor" id="line-4-85"></span>    <span class="ResWord">int</span> <span class="ID">counter</span>;</span>
<span class="line"><span class="anchor" id="line-5-71"></span></span>
<span class="line"><span class="anchor" id="line-6-60"></span>    <span class="Comment">/* Public field, not exported via D-Bus */</span></span>
<span class="line"><span class="anchor" id="line-7-53"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">status</span>;</span>
<span class="line"><span class="anchor" id="line-8-47"></span></span>
<span class="line"><span class="anchor" id="line-9-45"></span>    <span class="Comment">/* Public property, exported via D-Bus */</span></span>
<span class="line"><span class="anchor" id="line-10-35"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">something</span> { <span class="ID">get</span>; <span class="ID">set</span>; }</span>
<span class="line"><span class="anchor" id="line-11-32"></span></span>
<span class="line"><span class="anchor" id="line-12-27"></span>    <span class="Comment">/* Public signal, exported via D-Bus</span></span>
<span class="line"><span class="anchor" id="line-13-25"></span><span class="Comment">     * Can be emitted on the server side and can be connected to on the client side.</span></span>
<span class="line"><span class="anchor" id="line-14-24"></span><span class="Comment">     */</span></span>
<span class="line"><span class="anchor" id="line-15-22"></span>    <span class="ResWord">public</span> <span class="ID">signal</span> <span class="ResWord">void</span> <span class="ID">sig1</span>();</span>
<span class="line"><span class="anchor" id="line-16-17"></span></span>
<span class="line"><span class="anchor" id="line-17-15"></span>    <span class="Comment">/* Public method, exported via D-Bus */</span></span>
<span class="line"><span class="anchor" id="line-18-13"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">some_method</span>() {</span>
<span class="line"><span class="anchor" id="line-19-11"></span>        <span class="ID">counter</span>++;</span>
<span class="line"><span class="anchor" id="line-20-9"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">heureka! counter = %d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">counter</span>);</span>
<span class="line"><span class="anchor" id="line-21-8"></span>        <span class="ID">sig1</span>();  <span class="Comment">// emit signal</span></span>
<span class="line"><span class="anchor" id="line-22-7"></span><span class="Comment"></span>    }</span>
<span class="line"><span class="anchor" id="line-23-5"></span></span>
<span class="line"><span class="anchor" id="line-24-5"></span>    <span class="Comment">/* Public method, exported via D-Bus and showing the sender who is</span></span>
<span class="line"><span class="anchor" id="line-25-5"></span><span class="Comment">       is calling the method (not exported in the D-Bus interface) */</span></span>
<span class="line"><span class="anchor" id="line-26-5"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">some_method_sender</span>(<span class="ID">string</span> <span class="ID">message</span>, <span class="ID">GLib</span>.<span class="ID">BusName</span> <span class="ID">sender</span>) {</span>
<span class="line"><span class="anchor" id="line-27-5"></span>        <span class="ID">counter</span>++;</span>
<span class="line"><span class="anchor" id="line-28-5"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">heureka! counter = %d, '%s' message from sender %s</span><span class="SPChar">\n</span><span class="String">"</span>,</span>
<span class="line"><span class="anchor" id="line-29-5"></span>                      <span class="ID">counter</span>, <span class="ID">message</span>, <span class="ID">sender</span>);</span>
<span class="line"><span class="anchor" id="line-30-5"></span>    }</span>
<span class="line"><span class="anchor" id="line-31-5"></span>}</span>
</pre></div></div><span class="anchor" id="line-2637"></span><span class="anchor" id="line-2638"></span><p class="line874">Register an instance of the service and start a main loop: <span class="anchor" id="line-2639"></span><span class="anchor" id="line-2640"></span></p><p class="line867"><span class="anchor" id="line-2641"></span><span class="anchor" id="line-2642"></span><span class="anchor" id="line-2643"></span><span class="anchor" id="line-2644"></span><span class="anchor" id="line-2645"></span><span class="anchor" id="line-2646"></span><span class="anchor" id="line-2647"></span><span class="anchor" id="line-2648"></span><span class="anchor" id="line-2649"></span><span class="anchor" id="line-2650"></span><span class="anchor" id="line-2651"></span><span class="anchor" id="line-2652"></span><span class="anchor" id="line-2653"></span><span class="anchor" id="line-2654"></span><span class="anchor" id="line-2655"></span><span class="anchor" id="line-2656"></span><span class="anchor" id="line-2657"></span><span class="anchor" id="line-2658"></span><span class="anchor" id="line-2659"></span><span class="anchor" id="line-2660"></span><span class="anchor" id="line-2661"></span><span class="anchor" id="line-2662"></span><span class="anchor" id="line-2663"></span><span class="anchor" id="line-1-318"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-2913de8e356087a002d9b50d7fb6128afe142a2d" lang="en"><span class="line"><span class="anchor" id="line-1-319"></span><span class="ResWord">void</span> <span class="ID">on_bus_aquired</span> (<span class="ID">DBusConnection</span> <span class="ID">conn</span>) {</span>
<span class="line"><span class="anchor" id="line-2-126"></span>    <span class="ResWord">try</span> {</span>
<span class="line"><span class="anchor" id="line-3-105"></span>        <span class="Comment">// start service and register it as dbus object</span></span>
<span class="line"><span class="anchor" id="line-4-86"></span><span class="Comment"></span>        <span class="ID">var</span> <span class="ID">service</span> = <span class="ResWord">new</span> <span class="ID">DemoService</span>();</span>
<span class="line"><span class="anchor" id="line-5-72"></span>        <span class="ID">conn</span>.<span class="ID">register_object</span> (<span class="String">"</span><span class="String">/org/example/demo</span><span class="String">"</span>, <span class="ID">service</span>);</span>
<span class="line"><span class="anchor" id="line-6-61"></span>    } <span class="ResWord">catch</span> (<span class="ID">IOError</span> <span class="ID">e</span>) {</span>
<span class="line"><span class="anchor" id="line-7-54"></span>        <span class="ID">stderr</span>.<span class="ID">printf</span> (<span class="String">"</span><span class="String">Could not register service: %s</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">e</span>.<span class="ID">message</span>);</span>
<span class="line"><span class="anchor" id="line-8-48"></span>    }</span>
<span class="line"><span class="anchor" id="line-9-46"></span>}</span>
<span class="line"><span class="anchor" id="line-10-36"></span></span>
<span class="line"><span class="anchor" id="line-11-33"></span><span class="ResWord">void</span> <span class="ID">main</span> () {</span>
<span class="line"><span class="anchor" id="line-12-28"></span>    <span class="Comment">// try to register service name in session bus</span></span>
<span class="line"><span class="anchor" id="line-13-26"></span><span class="Comment"></span>    <span class="ID">Bus</span>.<span class="ID">own_name</span> (<span class="ID">BusType</span>.<span class="ID">SESSION</span>, <span class="String">"</span><span class="String">org.example.DemoService</span><span class="String">"</span>, <span class="Comment">/* name to register */</span></span>
<span class="line"><span class="anchor" id="line-14-25"></span>                  <span class="ID">BusNameOwnerFlags</span>.<span class="ID">NONE</span>, <span class="Comment">/* flags */</span></span>
<span class="line"><span class="anchor" id="line-15-23"></span>                  <span class="ID">on_bus_aquired</span>, <span class="Comment">/* callback function on registration succeeded */</span></span>
<span class="line"><span class="anchor" id="line-16-18"></span>                  () =&gt; {}, <span class="Comment">/* callback on name register succeeded */</span></span>
<span class="line"><span class="anchor" id="line-17-16"></span>                  () =&gt; <span class="ID">stderr</span>.<span class="ID">printf</span> (<span class="String">"</span><span class="String">Could not acquire name</span><span class="SPChar">\n</span><span class="String">"</span>));</span>
<span class="line"><span class="anchor" id="line-18-14"></span>                                                     <span class="Comment">/* callback on name lost */</span></span>
<span class="line"><span class="anchor" id="line-19-12"></span></span>
<span class="line"><span class="anchor" id="line-20-10"></span>    <span class="Comment">// start main loop</span></span>
<span class="line"><span class="anchor" id="line-21-9"></span><span class="Comment"></span>    <span class="ResWord">new</span> <span class="ID">MainLoop</span> ().<span class="ID">run</span> ();</span>
<span class="line"><span class="anchor" id="line-22-8"></span>}</span>
</pre></div></div><span class="anchor" id="line-2664"></span><span class="anchor" id="line-2665"></span><p class="line862">You must compile this example with the <em>gio-2.0</em> package: <span class="anchor" id="line-2666"></span><span class="anchor" id="line-2667"></span></p><p class="line867"><span class="anchor" id="line-2668"></span><span class="anchor" id="line-2669"></span><span class="anchor" id="line-2670"></span></p><pre><span class="anchor" id="line-1-19"></span>$ valac --pkg gio-2.0 dbus-demo-service.vala
<span class="anchor" id="line-2-3"></span>$ ./dbus-demo-service</pre><span class="anchor" id="line-2671"></span><span class="anchor" id="line-2672"></span><p class="line862">All member names are automatically mangled from Vala's <em>lower_case_with_underscores</em> naming convention to D-Bus <em>CamelCase</em> names.  The exported D-Bus interface of this example will have a property <em>Something</em>, a signal <em>Sig1</em> and a method <em>SomeMethod</em>.  You can open a new terminal window and call the method from command line with: <span class="anchor" id="line-2673"></span><span class="anchor" id="line-2674"></span></p><p class="line867"><span class="anchor" id="line-2675"></span><span class="anchor" id="line-2676"></span><span class="anchor" id="line-2677"></span><span class="anchor" id="line-2678"></span><span class="anchor" id="line-2679"></span></p><pre><span class="anchor" id="line-1-20"></span>$ dbus-send --type=method_call                   \
<span class="anchor" id="line-2-4"></span>            --dest=org.example.DemoService       \
<span class="anchor" id="line-3-1"></span>            /org/example/demo                    \
<span class="anchor" id="line-4"></span>            org.example.DemoService.SomeMethod</pre><span class="anchor" id="line-2680"></span><span class="anchor" id="line-2681"></span><p class="line874">or <span class="anchor" id="line-2682"></span><span class="anchor" id="line-2683"></span></p><p class="line867"><span class="anchor" id="line-2684"></span><span class="anchor" id="line-2685"></span><span class="anchor" id="line-2686"></span><span class="anchor" id="line-2687"></span><span class="anchor" id="line-2688"></span><span class="anchor" id="line-2689"></span></p><pre><span class="anchor" id="line-1-21"></span>$ dbus-send --type=method_call                   \
<span class="anchor" id="line-2-5"></span>            --dest=org.example.DemoService       \
<span class="anchor" id="line-3-2"></span>            /org/example/demo                    \
<span class="anchor" id="line-4-1"></span>            org.example.DemoService.SomeMethodSender \
<span class="anchor" id="line-5"></span>            string:'hello world'</pre><span class="anchor" id="line-2690"></span><span class="anchor" id="line-2691"></span><p class="line862">You can also use a graphical D-Bus debugger like <a href="https://wiki.gnome.org/Apps/DFeet">D-Feet</a> to browse your D-Bus interfaces and call methods. <span class="anchor" id="line-2692"></span><span class="anchor" id="line-2693"></span></p><p class="line862">Some comprehensive examples: <a href="https://wiki.gnome.org/Projects/Vala/DBusClientSamples">DBus Client Samples</a> and <a href="https://wiki.gnome.org/Projects/Vala/DBusServerSample">DBus Server Sample</a> <span class="anchor" id="line-2694"></span><span class="anchor" id="line-2695"></span></p><p class="line867">
</p><h3 id="Profiles">Profiles</h3>
<span class="anchor" id="line-2696"></span><span class="anchor" id="line-2697"></span><p class="line874">Vala supports a couple of different profiles: <span class="anchor" id="line-2698"></span><span class="anchor" id="line-2699"></span></p><ul><li>gobject (default) <span class="anchor" id="line-2700"></span></li><li>posix <span class="anchor" id="line-2701"></span></li><li>dova <span class="anchor" id="line-2702"></span><span class="anchor" id="line-2703"></span></li></ul><p class="line874">A profile determines what language features are available and on which libraries the resulting C-Code will depend. <span class="anchor" id="line-2704"></span><span class="anchor" id="line-2705"></span></p><p class="line862">To select a different profile use valac's <em>--profile</em> switch, e.g.: <span class="anchor" id="line-2706"></span><span class="anchor" id="line-2707"></span><span class="anchor" id="line-2708"></span></p><pre><span class="anchor" id="line-1-22"></span>valac --profile=posix somecode.vala</pre><span class="anchor" id="line-2709"></span><span class="anchor" id="line-2710"></span><span class="anchor" id="line-2711"></span><p class="line867">
</p><h2 id="Experimental_Features">Experimental Features</h2>
<span class="anchor" id="line-2712"></span><span class="anchor" id="line-2713"></span><p class="line874">Some
 features of Vala are experimental.  This means they are not fully 
tested and might be subject to changes in future versions. <span class="anchor" id="line-2714"></span><span class="anchor" id="line-2715"></span></p><p class="line867">
</p><h3 id="Chained_Relational_Expressions">Chained Relational Expressions</h3>
<span class="anchor" id="line-2716"></span><span class="anchor" id="line-2717"></span><p class="line874">This feature allows you to write complex relational expressions like <span class="anchor" id="line-2718"></span><span class="anchor" id="line-2719"></span></p><p class="line867"><span class="anchor" id="line-2720"></span><span class="anchor" id="line-2721"></span><span class="anchor" id="line-2722"></span><span class="anchor" id="line-2723"></span><span class="anchor" id="line-2724"></span><span class="anchor" id="line-2725"></span><span class="anchor" id="line-1-320"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-3bac380ba88cf462114bd491ccc63d5b7231dee8" lang="en"><span class="line"><span class="anchor" id="line-1-321"></span><span class="ResWord">if</span> (<span class="Number">1</span> &lt; <span class="ID">a</span> &amp;&amp; <span class="ID">a</span> &lt; <span class="Number">5</span>) {}</span>
<span class="line"><span class="anchor" id="line-2-127"></span></span>
<span class="line"><span class="anchor" id="line-3-106"></span><span class="ResWord">if</span> (<span class="Number">0</span> &lt; <span class="ID">a</span> &amp;&amp; <span class="ID">a</span> &lt; <span class="ID">b</span> &amp;&amp; <span class="ID">b</span> &lt; <span class="ID">c</span> &amp;&amp; <span class="ID">c</span> &lt; <span class="ID">d</span> &amp;&amp; <span class="ID">d</span> &lt; <span class="Number">255</span>) {</span>
<span class="line"><span class="anchor" id="line-4-87"></span>    <span class="Comment">// do something</span></span>
<span class="line"><span class="anchor" id="line-5-73"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-2726"></span><span class="anchor" id="line-2727"></span><p class="line874">in a more natural way: <span class="anchor" id="line-2728"></span><span class="anchor" id="line-2729"></span></p><p class="line867"><span class="anchor" id="line-2730"></span><span class="anchor" id="line-2731"></span><span class="anchor" id="line-2732"></span><span class="anchor" id="line-2733"></span><span class="anchor" id="line-2734"></span><span class="anchor" id="line-2735"></span><span class="anchor" id="line-1-322"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a2781eeaf0d4846a394646638a5f0520f41a3085" lang="en"><span class="line"><span class="anchor" id="line-1-323"></span><span class="ResWord">if</span> (<span class="Number">1</span> &lt; <span class="ID">a</span> &lt; <span class="Number">5</span>) {}</span>
<span class="line"><span class="anchor" id="line-2-128"></span></span>
<span class="line"><span class="anchor" id="line-3-107"></span><span class="ResWord">if</span> (<span class="Number">0</span> &lt; <span class="ID">a</span> &lt; <span class="ID">b</span> &lt; <span class="ID">c</span> &lt; <span class="ID">d</span> &lt; <span class="Number">255</span>) {</span>
<span class="line"><span class="anchor" id="line-4-88"></span>    <span class="Comment">// do something</span></span>
<span class="line"><span class="anchor" id="line-5-74"></span><span class="Comment"></span>}</span>
</pre></div></div><span class="anchor" id="line-2736"></span><span class="anchor" id="line-2737"></span><p class="line867">
</p><h3 id="Regular_Expression_Literals">Regular Expression Literals</h3>
<span class="anchor" id="line-2738"></span><span class="anchor" id="line-2739"></span><p class="line867"><a class="http" href="http://www.regular-expressions.info/">Regular expressions</a> are a powerful technique for pattern matching in strings.  Vala has experimental support for regular expression literals (<tt class="backtick">/regex/</tt>). Example: <span class="anchor" id="line-2740"></span><span class="anchor" id="line-2741"></span></p><p class="line867"><span class="anchor" id="line-2742"></span><span class="anchor" id="line-2743"></span><span class="anchor" id="line-2744"></span><span class="anchor" id="line-2745"></span><span class="anchor" id="line-2746"></span><span class="anchor" id="line-1-324"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b7e049f00f3aefb5940971c31e7a902456ec4020" lang="en"><span class="line"><span class="anchor" id="line-1-325"></span><span class="ID">string</span> <span class="ID">email</span> = <span class="String">"</span><span class="String">tux@kernel.org</span><span class="String">"</span>;</span>
<span class="line"><span class="anchor" id="line-2-129"></span><span class="ResWord">if</span> (/^[<span class="ID">A</span>-<span class="ID">Z0</span>-<span class="Number">9.</span><span class="ID">_</span>%+-]+@[<span class="ID">A</span>-<span class="ID">Z0</span>-<span class="Number">9.</span>-]+\.[<span class="ID">A</span>-<span class="ID">Z</span>]{<span class="Number">2</span>,<span class="Number">4</span>}$/<span class="ID">i</span>.<span class="ID">match</span>(<span class="ID">email</span>)) {</span>
<span class="line"><span class="anchor" id="line-3-108"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Valid email address</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-4-89"></span>}</span>
</pre></div></div><span class="anchor" id="line-2747"></span><span class="anchor" id="line-2748"></span><p class="line862">The trailing <em>i</em> makes the expression case insensitive.  You can store a regular expression in a variable of type <em>Regex</em>: <span class="anchor" id="line-2749"></span><span class="anchor" id="line-2750"></span></p><p class="line867"><span class="anchor" id="line-2751"></span><span class="anchor" id="line-2752"></span><span class="anchor" id="line-1-326"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b31875fad2a20feca2139b747da03539b494639d" lang="en"><span class="line"><span class="anchor" id="line-1-327"></span><span class="ID">Regex</span> <span class="ID">regex</span> = /<span class="ID">foo</span>/;</span>
</pre></div></div><span class="anchor" id="line-2753"></span><span class="anchor" id="line-2754"></span><p class="line874">A example of regular expression replacement: <span class="anchor" id="line-2755"></span><span class="anchor" id="line-2756"></span></p><p class="line867"><span class="anchor" id="line-2757"></span><span class="anchor" id="line-2758"></span><span class="anchor" id="line-2759"></span><span class="anchor" id="line-2760"></span><span class="anchor" id="line-1-328"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-223fa426314550af94e1b3a394e16120c2551864" lang="en"><span class="line"><span class="anchor" id="line-1-329"></span><span class="ID">var</span> <span class="ID">r</span> = /(<span class="ID">foo</span>|<span class="ID">bar</span>|<span class="ID">cow</span>)/;</span>
<span class="line"><span class="anchor" id="line-2-130"></span><span class="ID">var</span> <span class="ID">o</span> = <span class="ID">r</span>.<span class="ID">replace</span> (<span class="String">"</span><span class="String">this foo is great</span><span class="String">"</span>, -<span class="Number">1</span>, <span class="Number">0</span>, <span class="String">"</span><span class="String">thing</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-3-109"></span><span class="ID">print</span> (<span class="String">"</span><span class="String">%s</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">o</span>);</span>
</pre></div></div><span class="anchor" id="line-2761"></span><span class="anchor" id="line-2762"></span><p class="line874">The following trailing characters can be used: <span class="anchor" id="line-2763"></span><span class="anchor" id="line-2764"></span></p><ul><li><p class="line891"><em>i</em>, letters in the pattern match both upper- and lowercase letters <span class="anchor" id="line-2765"></span></p></li><li><p class="line891"><em>m</em>,
 the "start of line" and "end of line" constructs match immediately 
following or immediately before any newline in the string, respectively,
 as well as at the very start and end. <span class="anchor" id="line-2766"></span></p></li><li><p class="line891"><em>s</em>, a dot metacharater <em>.</em> in the pattern matches all characters, including newlines. Without it, newlines are excluded. <span class="anchor" id="line-2767"></span></p></li><li><p class="line891"><em>x</em>, whitespace data characters in the pattern are totally ignored except when escaped or inside a character class. <span class="anchor" id="line-2768"></span><span class="anchor" id="line-2769"></span></p></li></ul><p class="line867">
</p><h3 id="Strict_Non-Null_Mode">Strict Non-Null Mode</h3>
<span class="anchor" id="line-2770"></span><span class="anchor" id="line-2771"></span><p class="line862">If you compile your code with <tt class="backtick">--enable-experimental-non-null</tt> the Vala compiler will run in strict non-null type checking mode and consider <em>every</em> type to be not nullable by default unless it is explicitly declared nullable by marking it with a question mark: <span class="anchor" id="line-2772"></span><span class="anchor" id="line-2773"></span></p><p class="line867"><span class="anchor" id="line-2774"></span><span class="anchor" id="line-2775"></span><span class="anchor" id="line-2776"></span><span class="anchor" id="line-1-330"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c6263092799b02c2a983fc65ac1e42deef97c08b" lang="en"><span class="line"><span class="anchor" id="line-1-331"></span><span class="ID">Object</span> <span class="ID">o1</span> = <span class="ResWord">new</span> <span class="ID">Object</span>();     <span class="Comment">// not nullable</span></span>
<span class="line"><span class="anchor" id="line-2-131"></span><span class="Comment"></span><span class="ID">Object</span>? <span class="ID">o2</span> = <span class="ResWord">new</span> <span class="ID">Object</span>();    <span class="Comment">// nullable</span></span>
<span class="line"><span class="anchor" id="line-3-110"></span><span class="Comment"></span></span>
</pre></div></div><span class="anchor" id="line-2777"></span><span class="anchor" id="line-2778"></span><p class="line874">The
 compiler will perform a static compile-time analysis to ensure that no 
nullable reference is assigned to a non-nullable reference, e.g. this 
won't be possible: <span class="anchor" id="line-2779"></span><span class="anchor" id="line-2780"></span></p><p class="line867"><span class="anchor" id="line-2781"></span><span class="anchor" id="line-2782"></span><span class="anchor" id="line-1-332"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-0dbef5d2ebf1838856b0cf492a5e271d3b810e4e" lang="en"><span class="line"><span class="anchor" id="line-1-333"></span><span class="ID">o1</span> = <span class="ID">o2</span>;</span>
</pre></div></div><span class="anchor" id="line-2783"></span><span class="anchor" id="line-2784"></span><p class="line867"><em>o2</em> could be <em>null</em> and <em>o1</em>
 was declared non-nullable, so this assignment is forbidden.  However, 
you can override this behaviour with an explicit non-null cast if you're
 sure that <em>o2</em> is not <em>null</em>: <span class="anchor" id="line-2785"></span><span class="anchor" id="line-2786"></span></p><p class="line867"><span class="anchor" id="line-2787"></span><span class="anchor" id="line-2788"></span><span class="anchor" id="line-1-334"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-85385231ff7c973f38ca2bff169a57c0951024a0" lang="en"><span class="line"><span class="anchor" id="line-1-335"></span><span class="ID">o1</span> = (!) <span class="ID">o2</span>;</span>
</pre></div></div><span class="anchor" id="line-2789"></span><span class="anchor" id="line-2790"></span><p class="line862">The strict non-null mode helps in avoiding unwanted <em>null</em>
 dereferencing errors.  This feature would come to full potential if the
 nullability of all return types in bindings was marked correctly, which
 is currently not always the case. <span class="anchor" id="line-2791"></span><span class="anchor" id="line-2792"></span></p><p class="line867">
</p><h2 id="Libraries">Libraries</h2>
<span class="anchor" id="line-2793"></span><span class="anchor" id="line-2794"></span><p class="line874">At
 the system level, a Vala library is exactly a C library, and so the 
same tools are used.  In order to make the process simpler, and so that 
the Vala compiler can understand the process there is then an extra 
level of Vala specific information. <span class="anchor" id="line-2795"></span><span class="anchor" id="line-2796"></span></p><p class="line874">A "Vala library" is therefore, the system part: <span class="anchor" id="line-2797"></span></p><ul><li><p class="line862">A system library (e.g. <em>libgee.so</em>) <span class="anchor" id="line-2798"></span></p></li><li><p class="line862">A <em>pkg-config</em> entry (e.g. <em>gee-1.0.pc</em>) <span class="anchor" id="line-2799"></span></p></li></ul><p class="line874">Both of which are installed in the standard locations.  And the Vala specific files: <span class="anchor" id="line-2800"></span></p><ul><li><p class="line862">A VAPI file (e.g. <em>gee-1.0.vapi</em>) <span class="anchor" id="line-2801"></span></p></li><li><p class="line862">An optional dependency file (e.g. <em>gee-1.0.deps</em>) <span class="anchor" id="line-2802"></span><span class="anchor" id="line-2803"></span></p></li></ul><p class="line862">These
 files are explained later in this section.  It should be noted that the
 library names are the same in the Vala specific files as in the <em>pkg-config</em> files. <span class="anchor" id="line-2804"></span><span class="anchor" id="line-2805"></span></p><p class="line867">
</p><h3 id="Using_Libraries">Using Libraries</h3>
<span class="anchor" id="line-2806"></span><span class="anchor" id="line-2807"></span><p class="line862">Using a library in Vala is largely automated if you use the <em>valac</em>
 compiler.  The Vala specific library files make up what is known as a 
package.  You tell the compiler that a package is needed by your program
 as follows: <span class="anchor" id="line-2808"></span><span class="anchor" id="line-2809"></span></p><p class="line867"><span class="anchor" id="line-2810"></span><span class="anchor" id="line-2811"></span></p><pre><span class="anchor" id="line-1-23"></span>$ valac --pkg gee-1.0 test.vala</pre><span class="anchor" id="line-2812"></span><span class="anchor" id="line-2813"></span><p class="line862">This command means your program can use any of the definitions in the <em>gee-1.0.vapi</em> file, and also any in any of the packages that <em>gee-1.0</em> depends on.  These dependencies would be be listed in <em>gee-1.0.deps</em> if there were any.  In this example <em>valac</em> is set to build all the way to binary, and will therefore incorporate information from <em>pkg-config</em> to link the correct libraries.  This is why the <em>pkg-config</em> names are also used for Vala package names. <span class="anchor" id="line-2814"></span><span class="anchor" id="line-2815"></span></p><p class="line862">Packages
 are generally used with namespaces, but they are not technically 
related.  This means that even though your application is built with 
reference to the package, you must still include the required <tt class="backtick">using</tt> statements in each file as appropriate, or else use the fully qualified names of all symbols. <span class="anchor" id="line-2816"></span><span class="anchor" id="line-2817"></span></p><p class="line862">It
 is also possible to treat a local library (one that is not installed) 
as a package.  For comparison, Vala itself uses an internal version of 
Gee.  When <em>valac</em> is built it creates a VAPI file of this internal library and uses it roughly as follows: <span class="anchor" id="line-2818"></span><span class="anchor" id="line-2819"></span></p><p class="line867"><span class="anchor" id="line-2820"></span><span class="anchor" id="line-2821"></span></p><pre><span class="anchor" id="line-1-24"></span>$ valac --vapidir ../gee --pkg gee ...</pre><span class="anchor" id="line-2822"></span><span class="anchor" id="line-2823"></span><p class="line874">For details on how to generate this library, see the next section or the example. <span class="anchor" id="line-2824"></span><span class="anchor" id="line-2825"></span></p><p class="line867">
</p><h3 id="Creating_a_Library">Creating a Library</h3>
<span class="anchor" id="line-2826"></span><span class="anchor" id="line-2827"></span><p class="line867">
</p><h4 id="Using_Autotools">Using Autotools</h4>
<span class="anchor" id="line-2828"></span><span class="anchor" id="line-2829"></span><p class="line862">It
 is possible to use Autotools to create a library written in Vala. A 
library is created by using C code generated by Vala compiler, linked 
and installed as any other library. Then you need tell which C files 
must be used to create the library and which of them must be 
distributable, allowing others to compile a tarball without Vala using 
standard Autotools commands: <strong>configure</strong>, <strong>make</strong> and <strong>make install</strong>. <span class="anchor" id="line-2830"></span><span class="anchor" id="line-2831"></span></p><p class="line867">
</p><h5 id="Example">Example</h5>
<span class="anchor" id="line-2832"></span><p class="line874">This 
example was taken from GXml recent additions. GXmlDom is a library aimed
 to have a GObject based libxml2 replacement; is written in Vala and 
originally used to use WAF to build. <span class="anchor" id="line-2833"></span><span class="anchor" id="line-2834"></span></p><p class="line867"><strong>valac</strong>
 can be used to generate C code and headers from Vala sources. At this 
time is possible to generate a GObjectIntrospection and the VAPI file 
from the vala sources too. <span class="anchor" id="line-2835"></span><span class="anchor" id="line-2836"></span></p><p class="line867"><strong>gxml.vala.stamp</strong> is used as the code sources for our library. <span class="anchor" id="line-2837"></span><span class="anchor" id="line-2838"></span></p><p class="line874">Is
 important to add --pkg switches in order to valac to success and set 
all CFLAGS and LIBS required by the C library to compile and link 
against. <span class="anchor" id="line-2839"></span><span class="anchor" id="line-2840"></span></p><p class="line867"><span class="anchor" id="line-2841"></span><span class="anchor" id="line-2842"></span><span class="anchor" id="line-2843"></span><span class="anchor" id="line-2844"></span><span class="anchor" id="line-2845"></span><span class="anchor" id="line-2846"></span><span class="anchor" id="line-2847"></span><span class="anchor" id="line-2848"></span><span class="anchor" id="line-2849"></span><span class="anchor" id="line-2850"></span><span class="anchor" id="line-2851"></span><span class="anchor" id="line-2852"></span><span class="anchor" id="line-2853"></span><span class="anchor" id="line-2854"></span><span class="anchor" id="line-2855"></span><span class="anchor" id="line-2856"></span><span class="anchor" id="line-2857"></span><span class="anchor" id="line-2858"></span><span class="anchor" id="line-2859"></span><span class="anchor" id="line-2860"></span><span class="anchor" id="line-2861"></span><span class="anchor" id="line-2862"></span><span class="anchor" id="line-2863"></span><span class="anchor" id="line-2864"></span><span class="anchor" id="line-2865"></span><span class="anchor" id="line-2866"></span><span class="anchor" id="line-2867"></span><span class="anchor" id="line-2868"></span><span class="anchor" id="line-2869"></span><span class="anchor" id="line-2870"></span><span class="anchor" id="line-2871"></span><span class="anchor" id="line-2872"></span><span class="anchor" id="line-2873"></span><span class="anchor" id="line-2874"></span><span class="anchor" id="line-2875"></span><span class="anchor" id="line-2876"></span><span class="anchor" id="line-2877"></span><span class="anchor" id="line-2878"></span><span class="anchor" id="line-2879"></span><span class="anchor" id="line-2880"></span><span class="anchor" id="line-2881"></span><span class="anchor" id="line-2882"></span><span class="anchor" id="line-2883"></span><span class="anchor" id="line-2884"></span><span class="anchor" id="line-2885"></span><span class="anchor" id="line-2886"></span><span class="anchor" id="line-2887"></span><span class="anchor" id="line-2888"></span><span class="anchor" id="line-2889"></span><span class="anchor" id="line-2890"></span><span class="anchor" id="line-2891"></span><span class="anchor" id="line-2892"></span><span class="anchor" id="line-2893"></span><span class="anchor" id="line-2894"></span><span class="anchor" id="line-2895"></span><span class="anchor" id="line-2896"></span><span class="anchor" id="line-2897"></span><span class="anchor" id="line-2898"></span><span class="anchor" id="line-2899"></span><span class="anchor" id="line-2900"></span><span class="anchor" id="line-2901"></span><span class="anchor" id="line-2902"></span><span class="anchor" id="line-2903"></span><span class="anchor" id="line-2904"></span><span class="anchor" id="line-2905"></span><span class="anchor" id="line-2906"></span><span class="anchor" id="line-2907"></span><span class="anchor" id="line-2908"></span><span class="anchor" id="line-2909"></span><span class="anchor" id="line-2910"></span><span class="anchor" id="line-2911"></span><span class="anchor" id="line-2912"></span><span class="anchor" id="line-2913"></span><span class="anchor" id="line-2914"></span><span class="anchor" id="line-2915"></span><span class="anchor" id="line-2916"></span><span class="anchor" id="line-2917"></span><span class="anchor" id="line-2918"></span><span class="anchor" id="line-2919"></span><span class="anchor" id="line-2920"></span><span class="anchor" id="line-2921"></span><span class="anchor" id="line-2922"></span><span class="anchor" id="line-2923"></span><span class="anchor" id="line-2924"></span><span class="anchor" id="line-2925"></span><span class="anchor" id="line-2926"></span><span class="anchor" id="line-2927"></span><span class="anchor" id="line-2928"></span><span class="anchor" id="line-2929"></span><span class="anchor" id="line-2930"></span><span class="anchor" id="line-2931"></span><span class="anchor" id="line-2932"></span><span class="anchor" id="line-2933"></span><span class="anchor" id="line-2934"></span><span class="anchor" id="line-2935"></span><span class="anchor" id="line-2936"></span><span class="anchor" id="line-2937"></span><span class="anchor" id="line-2938"></span><span class="anchor" id="line-2939"></span><span class="anchor" id="line-2940"></span><span class="anchor" id="line-2941"></span><span class="anchor" id="line-2942"></span><span class="anchor" id="line-2943"></span><span class="anchor" id="line-2944"></span><span class="anchor" id="line-2945"></span><span class="anchor" id="line-2946"></span><span class="anchor" id="line-2947"></span><span class="anchor" id="line-2948"></span><span class="anchor" id="line-2949"></span><span class="anchor" id="line-2950"></span><span class="anchor" id="line-2951"></span><span class="anchor" id="line-2952"></span><span class="anchor" id="line-2953"></span><span class="anchor" id="line-2954"></span><span class="anchor" id="line-2955"></span><span class="anchor" id="line-2956"></span><span class="anchor" id="line-2957"></span><span class="anchor" id="line-2958"></span><span class="anchor" id="line-2959"></span><span class="anchor" id="line-2960"></span><span class="anchor" id="line-2961"></span><span class="anchor" id="line-2962"></span><span class="anchor" id="line-2963"></span><span class="anchor" id="line-1-336"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-77fcf7178098290c034201be974b9c6e26f1b6d5\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script><a href="#" onclick="return togglenumber('CA-77fcf7178098290c034201be974b9c6e26f1b6d5', 1, 1);" class="codenumbers">Toggle line numbers</a>
<pre dir="ltr" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_1">   1</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_1"></span><span class="anchor" id="line-1-337"></span><span class="ResWord">NULL</span> =</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_2">   2</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_2"></span><span class="anchor" id="line-2-132"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_3">   3</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_3"></span><span class="anchor" id="line-3-111"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_4">   4</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_4"></span><span class="anchor" id="line-4-90"></span><span class="ID">AM_CPPFLAGS</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_5">   5</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_5"></span><span class="anchor" id="line-5-75"></span>        -<span class="ID">DPACKAGE_LOCALE_DIR</span>=\<span class="String">"</span><span class="String">"</span>$(<span class="ID">prefix</span>)/$(<span class="ID">DATADIRNAME</span>)/<span class="ID">locale</span><span class="String">"</span><span class="SPChar">\"</span><span class="String"> </span><span class="String">\</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_6">   6</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_6"></span><span class="anchor" id="line-6-62"></span><span class="String"></span><span class="String">        -DPACKAGE_SRC_DIR=</span><span class="SPChar">\"</span><span class="String">"</span>$(<span class="ID">srcdir</span>)<span class="String">"</span><span class="SPChar">\"</span><span class="String"> </span><span class="String">\</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_7">   7</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_7"></span><span class="anchor" id="line-7-55"></span><span class="String"></span><span class="String">        -DPACKAGE_DATA_DIR=</span><span class="SPChar">\"</span><span class="String">"</span>$(<span class="ID">datadir</span>)<span class="String">"</span><span class="SPChar">\"</span><span class="String"> </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_8">   8</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_8"></span><span class="anchor" id="line-8-49"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_9">   9</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_9"></span><span class="anchor" id="line-9-47"></span><span class="ID">BUILT_SOURCES</span> = <span class="ID">gxml</span>.<span class="ID">vala</span>.<span class="ID">stamp</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_10">  10</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_10"></span><span class="anchor" id="line-10-37"></span><span class="ID">CLEANFILES</span> = <span class="ID">gxml</span>.<span class="ID">vala</span>.<span class="ID">stamp</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_11">  11</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_11"></span><span class="anchor" id="line-11-34"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_12">  12</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_12"></span><span class="anchor" id="line-12-29"></span><span class="ID">AM_CFLAGS</span> =\</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_13">  13</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_13"></span><span class="anchor" id="line-13-27"></span>         -<span class="ID">Wall</span>\</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_14">  14</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_14"></span><span class="anchor" id="line-14-26"></span>         -<span class="ID">g</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_15">  15</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_15"></span><span class="anchor" id="line-15-24"></span>        $(<span class="ID">GLIB_CFLAGS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_16">  16</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_16"></span><span class="anchor" id="line-16-19"></span>        $(<span class="ID">LIBXML_CFLAGS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_17">  17</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_17"></span><span class="anchor" id="line-17-17"></span>        $(<span class="ID">GIO_CFLAGS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_18">  18</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_18"></span><span class="anchor" id="line-18-15"></span>        $(<span class="ID">GEE_CFLAGS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_19">  19</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_19"></span><span class="anchor" id="line-19-13"></span>        $(<span class="ID">VALA_CFLAGS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_20">  20</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_20"></span><span class="anchor" id="line-20-11"></span>        $(<span class="ResWord">NULL</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_21">  21</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_21"></span><span class="anchor" id="line-21-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_22">  22</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_22"></span><span class="anchor" id="line-22-9"></span><span class="ID">lib_LTLIBRARIES</span> = <span class="ID">libgxml</span>.<span class="ID">la</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_23">  23</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_23"></span><span class="anchor" id="line-23-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_24">  24</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_24"></span><span class="anchor" id="line-24-6"></span><span class="ID">VALAFLAGS</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_25">  25</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_25"></span><span class="anchor" id="line-25-6"></span>    $(<span class="ID">top_srcdir</span>)/<span class="ID">vapi</span>/<span class="ID">config</span>.<span class="ID">vapi</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_26">  26</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_26"></span><span class="anchor" id="line-26-6"></span>    --<span class="ID">vapidir</span>=$(<span class="ID">top_srcdir</span>)/<span class="ID">vapi</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_27">  27</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_27"></span><span class="anchor" id="line-27-6"></span>    --<span class="ID">pkg</span> <span class="ID">libxml</span>-<span class="Number">2.0</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_28">  28</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_28"></span><span class="anchor" id="line-28-6"></span>    --<span class="ID">pkg</span> <span class="ID">gee</span>-<span class="Number">1.0</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_29">  29</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_29"></span><span class="anchor" id="line-29-6"></span>    --<span class="ID">pkg</span> <span class="ID">gobject</span>-<span class="Number">2.0</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_30">  30</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_30"></span><span class="anchor" id="line-30-6"></span>    --<span class="ID">pkg</span> <span class="ID">gio</span>-<span class="Number">2.0</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_31">  31</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_31"></span><span class="anchor" id="line-31-6"></span>    $(<span class="ResWord">NULL</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_32">  32</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_32"></span><span class="anchor" id="line-32-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_33">  33</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_33"></span><span class="anchor" id="line-33-5"></span><span class="ID">libgxml_la_VALASOURCES</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_34">  34</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_34"></span><span class="anchor" id="line-34-5"></span>        <span class="ID">Attr</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_35">  35</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_35"></span><span class="anchor" id="line-35-5"></span>        <span class="ID">BackedNode</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_36">  36</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_36"></span><span class="anchor" id="line-36-5"></span>        <span class="ID">CDATASection</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_37">  37</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_37"></span><span class="anchor" id="line-37-4"></span>        <span class="ID">CharacterData</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_38">  38</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_38"></span><span class="anchor" id="line-38-4"></span>        <span class="ID">Comment</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_39">  39</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_39"></span><span class="anchor" id="line-39-4"></span>        <span class="ID">Document</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_40">  40</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_40"></span><span class="anchor" id="line-40-4"></span>        <span class="ID">DocumentFragment</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_41">  41</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_41"></span><span class="anchor" id="line-41-4"></span>        <span class="ID">DocumentType</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_42">  42</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_42"></span><span class="anchor" id="line-42-4"></span>        <span class="ID">DomError</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_43">  43</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_43"></span><span class="anchor" id="line-43-4"></span>        <span class="ID">Element</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_44">  44</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_44"></span><span class="anchor" id="line-44-4"></span>        <span class="ID">Entity</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_45">  45</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_45"></span><span class="anchor" id="line-45-4"></span>        <span class="ID">EntityReference</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_46">  46</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_46"></span><span class="anchor" id="line-46-4"></span>        <span class="ID">Implementation</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_47">  47</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_47"></span><span class="anchor" id="line-47-4"></span>        <span class="ID">NamespaceAttr</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_48">  48</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_48"></span><span class="anchor" id="line-48-3"></span>        <span class="ID">NodeList</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_49">  49</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_49"></span><span class="anchor" id="line-49-2"></span>        <span class="ID">NodeType</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_50">  50</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_50"></span><span class="anchor" id="line-50-2"></span>        <span class="ID">Notation</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_51">  51</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_51"></span><span class="anchor" id="line-51-2"></span>        <span class="ID">ProcessingInstruction</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_52">  52</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_52"></span><span class="anchor" id="line-52-2"></span>        <span class="ID">Text</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_53">  53</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_53"></span><span class="anchor" id="line-53-1"></span>        <span class="ID">XNode</span>.<span class="ID">vala</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_54">  54</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_54"></span><span class="anchor" id="line-54-1"></span>        $(<span class="ResWord">NULL</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_55">  55</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_55"></span><span class="anchor" id="line-55-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_56">  56</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_56"></span><span class="anchor" id="line-56-1"></span><span class="ID">libgxml_la_SOURCES</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_57">  57</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_57"></span><span class="anchor" id="line-57-1"></span>        <span class="ID">gxml</span>.<span class="ID">vala</span>.<span class="ID">stamp</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_58">  58</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_58"></span><span class="anchor" id="line-58-1"></span>        $(<span class="ID">libgxml_la_VALASOURCES:</span>.<span class="ID">vala</span>=.<span class="ID">c</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_59">  59</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_59"></span><span class="anchor" id="line-59-1"></span>        $(<span class="ResWord">NULL</span>) </span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_60">  60</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_60"></span><span class="anchor" id="line-60-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_61">  61</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_61"></span><span class="anchor" id="line-61-1"></span><span class="Preprc">#</span><span class="Preprc"> Generate C code and headers, including GObject Introspection GIR files and VAPI file</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_62">  62</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_62"></span><span class="anchor" id="line-62-1"></span><span class="Preprc"></span><span class="ID">gxml</span>-<span class="Number">1.0</span>.<span class="ID">vapi</span> <span class="ID">gxml</span>.<span class="ID">vala</span>.<span class="ID">stamp</span> <span class="ID">GXml</span>-<span class="Number">1.0</span>.<span class="ID">gir:</span> $(<span class="ID">libgxml_la_VALASOURCES</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_63">  63</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_63"></span><span class="anchor" id="line-63-1"></span>        $(<span class="ID">VALA_COMPILER</span>) $(<span class="ID">VALAFLAGS</span>) -<span class="ID">C</span> -<span class="ID">H</span> $(<span class="ID">top_builddir</span>)/<span class="ID">gxml</span>/<span class="ID">gxml</span>-<span class="ID">dom</span>.<span class="ID">h</span> --<span class="ID">gir</span>=<span class="ID">GXmlDom</span>-<span class="Number">1.0</span>.<span class="ID">gir</span>  --<span class="ID">library</span> <span class="ID">gxmldom</span>-<span class="Number">1.0</span> $^</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_64">  64</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_64"></span><span class="anchor" id="line-64-1"></span>        @<span class="ID">touch</span> $@</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_65">  65</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_65"></span><span class="anchor" id="line-65-1"></span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_66">  66</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_66"></span><span class="anchor" id="line-66-1"></span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_67">  67</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_67"></span><span class="anchor" id="line-67-1"></span><span class="Preprc">#</span><span class="Preprc"> Library configuration</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_68">  68</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_68"></span><span class="anchor" id="line-68-1"></span><span class="Preprc"></span><span class="ID">libgxml_la_LDFLAGS</span> = </span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_69">  69</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_69"></span><span class="anchor" id="line-69-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_70">  70</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_70"></span><span class="anchor" id="line-70-1"></span><span class="ID">libgxml_la_LIBADD</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_71">  71</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_71"></span><span class="anchor" id="line-71-1"></span>        $(<span class="ID">GLIB_LIBS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_72">  72</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_72"></span><span class="anchor" id="line-72-1"></span>        $(<span class="ID">LIBXML_LIBS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_73">  73</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_73"></span><span class="anchor" id="line-73-1"></span>        $(<span class="ID">GIO_LIBS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_74">  74</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_74"></span><span class="anchor" id="line-74-1"></span>        $(<span class="ID">GEE_LIBS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_75">  75</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_75"></span><span class="anchor" id="line-75-1"></span>        $(<span class="ID">VALA_LIBS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_76">  76</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_76"></span><span class="anchor" id="line-76-1"></span>        $(<span class="ResWord">NULL</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_77">  77</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_77"></span><span class="anchor" id="line-77-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_78">  78</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_78"></span><span class="anchor" id="line-78-1"></span><span class="ID">include_HEADERS</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_79">  79</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_79"></span><span class="anchor" id="line-79-1"></span>        <span class="ID">gxml</span>.<span class="ID">h</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_80">  80</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_80"></span><span class="anchor" id="line-80-1"></span>        $(<span class="ResWord">NULL</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_81">  81</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_81"></span><span class="anchor" id="line-81-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_82">  82</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_82"></span><span class="anchor" id="line-82-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_83">  83</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_83"></span><span class="anchor" id="line-83-1"></span><span class="ID">pkgconfigdir</span> = $(<span class="ID">libdir</span>)/<span class="ID">pkgconfig</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_84">  84</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_84"></span><span class="anchor" id="line-84-1"></span><span class="ID">pkgconfig_DATA</span> = <span class="ID">libgxml</span>-<span class="Number">1.0</span>.<span class="ID">pc</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_85">  85</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_85"></span><span class="anchor" id="line-85-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_86">  86</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_86"></span><span class="anchor" id="line-86-1"></span><span class="ID">gxmlincludedir</span>=$(<span class="ID">includedir</span>)/<span class="ID">libgxml</span>-<span class="Number">1.0</span>/<span class="ID">gxml</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_87">  87</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_87"></span><span class="anchor" id="line-87-1"></span><span class="ID">gxmlinclude_HEADERS</span>= <span class="ID">gxml</span>-<span class="ID">dom</span>.<span class="ID">h</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_88">  88</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_88"></span><span class="anchor" id="line-88-1"></span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_89">  89</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_89"></span><span class="anchor" id="line-89-1"></span><span class="Preprc">#</span><span class="Preprc"> GObject Introspection</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_90">  90</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_90"></span><span class="anchor" id="line-90-1"></span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_91">  91</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_91"></span><span class="anchor" id="line-91-1"></span><span class="ResWord">if</span> <span class="ID">ENABLE_GI_SYSTEM_INSTALL</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_92">  92</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_92"></span><span class="anchor" id="line-92-1"></span><span class="ID">girdir</span> = $(<span class="ID">INTROSPECTION_GIRDIR</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_93">  93</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_93"></span><span class="anchor" id="line-93-1"></span><span class="ID">typelibsdir</span> = $(<span class="ID">INTROSPECTION_TYPELIBDIR</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_94">  94</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_94"></span><span class="anchor" id="line-94-1"></span><span class="ResWord">else</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_95">  95</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_95"></span><span class="anchor" id="line-95-1"></span><span class="ID">girdir</span> = $(<span class="ID">datadir</span>)/<span class="ID">gir</span>-<span class="Number">1.0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_96">  96</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_96"></span><span class="anchor" id="line-96-1"></span><span class="ID">typelibsdir</span> = $(<span class="ID">libdir</span>)/<span class="ID">girepository</span>-<span class="Number">1.0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_97">  97</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_97"></span><span class="anchor" id="line-97-1"></span><span class="ID">endif</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_98">  98</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_98"></span><span class="anchor" id="line-98-1"></span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_99">  99</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_99"></span><span class="anchor" id="line-99-1"></span><span class="Preprc">#</span><span class="Preprc"> GIR files are generated automatically by Valac so is not necessary to scan source code to generate it</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_100"> 100</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_100"></span><span class="anchor" id="line-100-1"></span><span class="Preprc"></span><span class="ID">INTROSPECTION_GIRS</span> =</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_101"> 101</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_101"></span><span class="anchor" id="line-101-1"></span><span class="ID">INTROSPECTION_GIRS</span> += <span class="ID">GXmlDom</span>-<span class="Number">1.0</span>.<span class="ID">gir</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_102"> 102</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_102"></span><span class="anchor" id="line-102-1"></span><span class="ID">INTROSPECTION_COMPILER_ARGS</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_103"> 103</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_103"></span><span class="anchor" id="line-103-1"></span>    --<span class="ID">includedir</span>=. \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_104"> 104</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_104"></span><span class="anchor" id="line-104-1"></span>    --<span class="ID">includedir</span>=$(<span class="ID">top_builddir</span>)/<span class="ID">gxml</span> </span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_105"> 105</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_105"></span><span class="anchor" id="line-105-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_106"> 106</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_106"></span><span class="anchor" id="line-106-1"></span><span class="ID">GXmlDom</span>-<span class="Number">1.0</span>.<span class="ID">typelib:</span> $(<span class="ID">INTROSPECTION_GIRS</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_107"> 107</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_107"></span><span class="anchor" id="line-107-1"></span>        $(<span class="ID">INTROSPECTION_COMPILER</span>) $(<span class="ID">INTROSPECTION_COMPILER_ARGS</span>)  $&lt; -<span class="ID">o</span> $@</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_108"> 108</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_108"></span><span class="anchor" id="line-108-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_109"> 109</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_109"></span><span class="anchor" id="line-109-1"></span><span class="ID">gir_DATA</span> = $(<span class="ID">INTROSPECTION_GIRS</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_110"> 110</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_110"></span><span class="anchor" id="line-110-1"></span><span class="ID">typelibs_DATA</span> = <span class="ID">GXmlDom</span>-<span class="Number">1.0</span>.<span class="ID">typelib</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_111"> 111</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_111"></span><span class="anchor" id="line-111-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_112"> 112</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_112"></span><span class="anchor" id="line-112-1"></span><span class="ID">vapidir</span> = $(<span class="ID">VALA_VAPIDIR</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_113"> 113</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_113"></span><span class="anchor" id="line-113-1"></span><span class="ID">vapi_DATA</span>=<span class="ID">gxmldom</span>-<span class="Number">1.0</span>.<span class="ID">vapi</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_114"> 114</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_114"></span><span class="anchor" id="line-114-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_115"> 115</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_115"></span><span class="anchor" id="line-115-1"></span><span class="ID">CLEANFILES</span> += $(<span class="ID">INTROSPECTION_GIRS</span>) $(<span class="ID">typelibs_DATA</span>) <span class="ID">gxml</span>-<span class="Number">1.0</span>.<span class="ID">vapi</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_116"> 116</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_116"></span><span class="anchor" id="line-116-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_117"> 117</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_117"></span><span class="anchor" id="line-117-1"></span><span class="ID">EXTRA_DIST</span> = \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_118"> 118</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_118"></span><span class="anchor" id="line-118-1"></span>        <span class="ID">libgxml</span>-<span class="Number">1.0</span>.<span class="ID">pc</span>.<span class="ID">in</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_119"> 119</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_119"></span><span class="anchor" id="line-119-1"></span>        $(<span class="ID">libgxml_la_VALASOURCES</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_120"> 120</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_120"></span><span class="anchor" id="line-120-1"></span>        $(<span class="ID">typelibs_DATA</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_121"> 121</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_121"></span><span class="anchor" id="line-121-1"></span>        $(<span class="ID">INTROSPECTION_GIRS</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-77fcf7178098290c034201be974b9c6e26f1b6d5_122"> 122</a> </span><span class="LineAnchor" id="CA-77fcf7178098290c034201be974b9c6e26f1b6d5_122"></span><span class="anchor" id="line-122-1"></span>        <span class="ID">gxml</span>.<span class="ID">vala</span>.<span class="ID">stamp</span></span>
</pre></div></div><span class="anchor" id="line-2964"></span><span class="anchor" id="line-2965"></span><p class="line867">
</p><h4 id="Compilation_and_linking_using_Command_Line">Compilation and linking using Command Line</h4>
<span class="anchor" id="line-2966"></span><span class="anchor" id="line-2967"></span><p class="line862">Vala is not yet capable of directly creating dynamic or static libraries.  To create a library, proceed with the <tt class="backtick">-c</tt> (compile only) switch and link the object files with your favourite linker, i.e. <tt class="backtick">libtool</tt> or <tt class="backtick">ar</tt>. <span class="anchor" id="line-2968"></span><span class="anchor" id="line-2969"></span></p><p class="line867"><span class="anchor" id="line-2970"></span><span class="anchor" id="line-2971"></span><span class="anchor" id="line-2972"></span></p><pre><span class="anchor" id="line-1-25"></span>$ valac -c ...(source files)
<span class="anchor" id="line-2-6"></span>$ ar cx ...(object files)</pre><span class="anchor" id="line-2973"></span><span class="anchor" id="line-2974"></span><p class="line862">or by compiling the intermediate C code with <em>gcc</em> <span class="anchor" id="line-2975"></span><span class="anchor" id="line-2976"></span></p><p class="line867"><span class="anchor" id="line-2977"></span><span class="anchor" id="line-2978"></span><span class="anchor" id="line-2979"></span></p><pre><span class="anchor" id="line-1-26"></span>$ valac -C ...(source files)
<span class="anchor" id="line-2-7"></span>$ gcc -o my-best-library.so --shared -fPIC ...(compiled C code files)...</pre><span class="anchor" id="line-2980"></span><span class="anchor" id="line-2981"></span><p class="line867">
</p><h5 id="Example-1">Example</h5>
<span class="anchor" id="line-2982"></span><span class="anchor" id="line-2983"></span><p class="line874">The
 following is an example of how to write a simple library in Vala, and 
also to compile and test it locally without having to install it first. <span class="anchor" id="line-2984"></span><span class="anchor" id="line-2985"></span></p><p class="line862">Save the following code to a file <em>test.vala</em>.  This is the actual library code, containing the functions we want to call from our main program. <span class="anchor" id="line-2986"></span><span class="anchor" id="line-2987"></span></p><p class="line867"><span class="anchor" id="line-2988"></span><span class="anchor" id="line-2989"></span><span class="anchor" id="line-2990"></span><span class="anchor" id="line-2991"></span><span class="anchor" id="line-2992"></span><span class="anchor" id="line-2993"></span><span class="anchor" id="line-2994"></span><span class="anchor" id="line-2995"></span><span class="anchor" id="line-2996"></span><span class="anchor" id="line-2997"></span><span class="anchor" id="line-2998"></span><span class="anchor" id="line-1-338"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b4ffcc9c2f879f99f551b440df7ae77f460620b5" lang="en"><span class="line"><span class="anchor" id="line-1-339"></span><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">MyLib</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-133"></span></span>
<span class="line"><span class="anchor" id="line-3-112"></span>    <span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">hello</span>() {</span>
<span class="line"><span class="anchor" id="line-4-91"></span>        <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">Hello World, MyLib</span><span class="SPChar">\n</span><span class="String">"</span>);</span>
<span class="line"><span class="anchor" id="line-5-76"></span>    }</span>
<span class="line"><span class="anchor" id="line-6-63"></span></span>
<span class="line"><span class="anchor" id="line-7-56"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">sum</span>(<span class="ResWord">int</span> <span class="ID">x</span>, <span class="ResWord">int</span> <span class="ID">y</span>) {</span>
<span class="line"><span class="anchor" id="line-8-50"></span>        <span class="ResWord">return</span> <span class="ID">x</span> + <span class="ID">y</span>;</span>
<span class="line"><span class="anchor" id="line-9-48"></span>    }</span>
<span class="line"><span class="anchor" id="line-10-38"></span>}</span>
</pre></div></div><span class="anchor" id="line-2999"></span><span class="anchor" id="line-3000"></span><p class="line862">Use the next command to generate <em>test.c</em>, <em>test.h</em> and <em>test.vapi</em> files.  These are the C versions of the library to be compiled, and the VAPI file representing the library's public interface. <span class="anchor" id="line-3001"></span><span class="anchor" id="line-3002"></span></p><p class="line867"><span class="anchor" id="line-3003"></span><span class="anchor" id="line-3004"></span></p><pre><span class="anchor" id="line-1-27"></span>$ valac -C -H test.h --library test test.vala --basedir ./</pre><span class="anchor" id="line-3005"></span><span class="anchor" id="line-3006"></span><p class="line874">Now compile the library: <span class="anchor" id="line-3007"></span><span class="anchor" id="line-3008"></span></p><p class="line867"><span class="anchor" id="line-3009"></span><span class="anchor" id="line-3010"></span></p><pre><span class="anchor" id="line-1-28"></span>$ gcc --shared -fPIC -o libtest.so $(pkg-config --cflags --libs gobject-2.0) test.c</pre><span class="anchor" id="line-3011"></span><span class="anchor" id="line-3012"></span><p class="line862">Save the following code to a file called <em>hello.vala</em>.  This is the code that will use the library we have created. <span class="anchor" id="line-3013"></span><span class="anchor" id="line-3014"></span></p><p class="line867"><span class="anchor" id="line-3015"></span><span class="anchor" id="line-3016"></span><span class="anchor" id="line-3017"></span><span class="anchor" id="line-3018"></span><span class="anchor" id="line-3019"></span><span class="anchor" id="line-3020"></span><span class="anchor" id="line-3021"></span><span class="anchor" id="line-1-340"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b70a07dddd86e0f92dda3d036b814ec2b0970cb0" lang="en"><span class="line"><span class="anchor" id="line-1-341"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-2-134"></span>    <span class="ID">var</span> <span class="ID">test</span> = <span class="ResWord">new</span> <span class="ID">MyLib</span>();</span>
<span class="line"><span class="anchor" id="line-3-113"></span>    <span class="ID">test</span>.<span class="ID">hello</span>();</span>
<span class="line"><span class="anchor" id="line-4-92"></span>    <span class="ResWord">int</span> <span class="ID">x</span> = <span class="Number">4</span>, <span class="ID">y</span> = <span class="Number">5</span>;</span>
<span class="line"><span class="anchor" id="line-5-77"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">The sum of %d and %d is %d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">x</span>, <span class="ID">y</span>, <span class="ID">test</span>.<span class="ID">sum</span>(<span class="ID">x</span>, <span class="ID">y</span>));</span>
<span class="line"><span class="anchor" id="line-6-64"></span>}</span>
</pre></div></div><span class="anchor" id="line-3022"></span><span class="anchor" id="line-3023"></span><p class="line874">Now compile the application code, telling the compiler that we want to link against the library we just created. <span class="anchor" id="line-3024"></span><span class="anchor" id="line-3025"></span></p><p class="line867"><span class="anchor" id="line-3026"></span><span class="anchor" id="line-3027"></span></p><pre><span class="anchor" id="line-1-29"></span>$ valac -X -I. -X -L. -X -ltest -o hello hello.vala test.vapi --basedir ./</pre><span class="anchor" id="line-3028"></span><span class="anchor" id="line-3029"></span><p class="line874">We can now run the program.  This command states that any required libraries will be found in the current directory. <span class="anchor" id="line-3030"></span><span class="anchor" id="line-3031"></span></p><p class="line867"><span class="anchor" id="line-3032"></span><span class="anchor" id="line-3033"></span></p><pre><span class="anchor" id="line-1-30"></span>$ LD_LIBRARY_PATH=$PWD ./hello</pre><span class="anchor" id="line-3034"></span><span class="anchor" id="line-3035"></span><p class="line874">The output of the program should be: <span class="anchor" id="line-3036"></span><span class="anchor" id="line-3037"></span></p><p class="line867"><span class="anchor" id="line-3038"></span><span class="anchor" id="line-3039"></span><span class="anchor" id="line-3040"></span></p><pre><span class="anchor" id="line-1-31"></span>Hello World, MyLib
<span class="anchor" id="line-2-8"></span>The sum of 4 and 5 is 9</pre><span class="anchor" id="line-3041"></span><span class="anchor" id="line-3042"></span><p class="line862">You can also create a GObjectIntrospection GIR file for your library with the <tt class="backtick">--gir</tt> option: <span class="anchor" id="line-3043"></span><span class="anchor" id="line-3044"></span></p><p class="line867"><span class="anchor" id="line-3045"></span><span class="anchor" id="line-3046"></span></p><pre><span class="anchor" id="line-1-32"></span>valac -C test.vala --library test --gir Test-1.0.gir</pre><span class="anchor" id="line-3047"></span><span class="anchor" id="line-3048"></span><p class="line874">GIR files are XML descriptions of the API. <span class="anchor" id="line-3049"></span><span class="anchor" id="line-3050"></span></p><p class="line867">
</p><h3 id="Binding_Libraries_with_VAPI_Files">Binding Libraries with VAPI Files</h3>
<span class="anchor" id="line-3051"></span><span class="anchor" id="line-3052"></span><p class="line874">VAPI
 files are descriptions of the public interface of external Vala 
libraries.  When a library is written in Vala, this file is created by 
the Vala compiler, and basically an amalgamation of all public 
definitions from all Vala source files.  For a library written in C, the
 VAPI file gets more complicated, particular if the naming conventions 
of the library do not follow the GLib convention.  The VAPI file will in
 this case contain many annotations describing how the standardised Vala
 interface mangles onto the C version. <span class="anchor" id="line-3053"></span><span class="anchor" id="line-3054"></span></p><p class="line874">This process of creating this generally amounts to three steps, <span class="anchor" id="line-3055"></span><span class="anchor" id="line-3056"></span></p><ul><li><p class="line862">Running <em>vala-gen-introspect</em> to extract metadata from the C library. <span class="anchor" id="line-3057"></span></p></li><li>Adding extra metadata to standardise the interface or make various other changes. <span class="anchor" id="line-3058"></span></li><li><p class="line862">Generating a VAPI file from the above sources using <em>vapigen</em>. <span class="anchor" id="line-3059"></span><span class="anchor" id="line-3060"></span></p></li></ul><p class="line862">Specific instructions on how to generate bindings are in the <a href="https://wiki.gnome.org/Projects/Vala/Bindings">Vala Bindings Tutorial</a> <span class="anchor" id="line-3061"></span><span class="anchor" id="line-3062"></span></p><p class="line867">
</p><h2 id="Tools">Tools</h2>
<span class="anchor" id="line-3063"></span><span class="anchor" id="line-3064"></span><p class="line874">The
 Vala distribution includes several programs to help you build and work 
with Vala applications.  For more details of each tool, see the man 
pages. <span class="anchor" id="line-3065"></span><span class="anchor" id="line-3066"></span></p><p class="line867">
</p><h3 id="valac">valac</h3>
<span class="anchor" id="line-3067"></span><span class="anchor" id="line-3068"></span><p class="line867"><em>valac</em>
 is the Vala compiler.  It's primary function is to transform Vala code 
into compilable C code, though it can also automate the entire build and
 link project in simple cases. <span class="anchor" id="line-3069"></span><span class="anchor" id="line-3070"></span></p><p class="line874">The simple case for use is: <span class="anchor" id="line-3071"></span><span class="anchor" id="line-3072"></span></p><p class="line867"><span class="anchor" id="line-3073"></span><span class="anchor" id="line-3074"></span></p><pre><span class="anchor" id="line-1-33"></span>$ valac -o appname --pkg gee-1.0 file_name_1.vala file_name_2.vala</pre><span class="anchor" id="line-3075"></span><span class="anchor" id="line-3076"></span><p class="line862">The <tt class="backtick">-o</tt> switch requests that an object file is created, rather than just outputting C source files.  The <tt class="backtick">--pkg</tt> option says that this build needs information from the <em>gee-1.0</em>
 package.  You do not need to specify details about what libraries to 
link in, the package has this information internally.  Finally, a list 
of source files is given.  If you need a more complicated build process,
 use the <tt class="backtick">-C</tt> switch to generate C files instead of a binary, and continue the process manually, or through a script. <span class="anchor" id="line-3077"></span><span class="anchor" id="line-3078"></span></p><p class="line867">
</p><h3 id="vapigen">vapigen</h3>
<span class="anchor" id="line-3079"></span><span class="anchor" id="line-3080"></span><p class="line867"><em>vapigen</em> is a tool to make bindings. It creates a VAPI files from a library's metadata and any extra information required. See also <a href="https://wiki.gnome.org/Projects/Vala/Bindings">Vala Bindings Tutorial</a>. <span class="anchor" id="line-3081"></span><span class="anchor" id="line-3082"></span></p><p class="line867">
</p><h3 id="vala-gen-introspect">vala-gen-introspect</h3>
<span class="anchor" id="line-3083"></span><span class="anchor" id="line-3084"></span><p class="line867"><em>vala-gen-introspect</em>
 is a tool for extracting metainformation about GObject based libraries.
  Nowadays, the preferred method is to use GObjectIntrospection instead,
 as vapigen can use GIR files directly. See also <a href="https://wiki.gnome.org/Projects/Vala/Bindings">Vala Bindings Tutorial</a>. <span class="anchor" id="line-3085"></span><span class="anchor" id="line-3086"></span></p><p class="line867">
</p><h2 id="Techniques">Techniques</h2>
<span class="anchor" id="line-3087"></span><span class="anchor" id="line-3088"></span><p class="line867">
</p><h3 id="Debugging">Debugging</h3>
<span class="anchor" id="line-3089"></span><span class="anchor" id="line-3090"></span><p class="line862">For demonstration purposes we will create a buggy program by intentionally dereferencing a <tt class="backtick">null</tt> reference, which will result in a segmentation fault: <span class="anchor" id="line-3091"></span><span class="anchor" id="line-3092"></span></p><p class="line867"><span class="anchor" id="line-3093"></span><span class="anchor" id="line-3094"></span><span class="anchor" id="line-3095"></span><span class="anchor" id="line-3096"></span><span class="anchor" id="line-3097"></span><span class="anchor" id="line-3098"></span><span class="anchor" id="line-3099"></span><span class="anchor" id="line-3100"></span><span class="anchor" id="line-3101"></span><span class="anchor" id="line-1-342"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-2bee61146b617521e0129fe4ade5c1c3544731f5" lang="en"><span class="line"><span class="anchor" id="line-1-343"></span><span class="ResWord">class</span> <span class="ID">Foo</span> : <span class="ID">Object</span> {</span>
<span class="line"><span class="anchor" id="line-2-135"></span>    <span class="ResWord">public</span> <span class="ResWord">int</span> <span class="ID">field</span>;</span>
<span class="line"><span class="anchor" id="line-3-114"></span>}</span>
<span class="line"><span class="anchor" id="line-4-93"></span></span>
<span class="line"><span class="anchor" id="line-5-78"></span><span class="ResWord">void</span> <span class="ID">main</span>() {</span>
<span class="line"><span class="anchor" id="line-6-65"></span>    <span class="ID">Foo</span>? <span class="ID">foo</span> = <span class="ID">null</span>;</span>
<span class="line"><span class="anchor" id="line-7-57"></span>    <span class="ID">stdout</span>.<span class="ID">printf</span>(<span class="String">"</span><span class="String">%d</span><span class="SPChar">\n</span><span class="String">"</span>, <span class="ID">foo</span>.<span class="ID">field</span>);</span>
<span class="line"><span class="anchor" id="line-8-51"></span>}</span>
</pre></div></div><span class="anchor" id="line-3102"></span><span class="anchor" id="line-3103"></span><p class="line867"><span class="anchor" id="line-3104"></span><span class="anchor" id="line-3105"></span><span class="anchor" id="line-3106"></span><span class="anchor" id="line-3107"></span></p><pre><span class="anchor" id="line-1-34"></span>$ valac debug-demo.vala
<span class="anchor" id="line-2-9"></span>$ ./debug-demo
<span class="anchor" id="line-3-3"></span>Segmentation fault</pre><span class="anchor" id="line-3108"></span><span class="anchor" id="line-3109"></span><p class="line862">So how do we debug this program?  The <tt class="backtick">-g</tt> command line option tells the Vala compiler to include Vala source code line information in the compiled binary, <tt class="backtick">--save-temps</tt> keeps the temporary C source files: <span class="anchor" id="line-3110"></span><span class="anchor" id="line-3111"></span></p><p class="line867"><span class="anchor" id="line-3112"></span><span class="anchor" id="line-3113"></span></p><pre><span class="anchor" id="line-1-35"></span>$ valac -g --save-temps debug-demo.vala</pre><span class="anchor" id="line-3114"></span><span class="anchor" id="line-3115"></span><p class="line862">Vala programs can be debugged with the GNU Debugger <tt class="backtick">gdb</tt> or one of its graphical front-ends, e.g. <a class="http" href="http://projects.gnome.org/nemiver/">Nemiver</a>. <span class="anchor" id="line-3116"></span><span class="anchor" id="line-3117"></span></p><p class="line867"><span class="anchor" id="line-3118"></span><span class="anchor" id="line-3119"></span></p><pre><span class="anchor" id="line-1-36"></span>$ nemiver debug-demo</pre><span class="anchor" id="line-3120"></span><span class="anchor" id="line-3121"></span><p class="line862">A sample <tt class="backtick">gdb</tt> session: <span class="anchor" id="line-3122"></span><span class="anchor" id="line-3123"></span></p><p class="line867"><span class="anchor" id="line-3124"></span><span class="anchor" id="line-3125"></span><span class="anchor" id="line-3126"></span><span class="anchor" id="line-3127"></span><span class="anchor" id="line-3128"></span><span class="anchor" id="line-3129"></span><span class="anchor" id="line-3130"></span><span class="anchor" id="line-3131"></span><span class="anchor" id="line-3132"></span></p><pre><span class="anchor" id="line-1-37"></span>$ gdb debug-demo
<span class="anchor" id="line-2-10"></span>(gdb) run
<span class="anchor" id="line-3-4"></span>Starting program: /home/valacoder/debug-demo
<span class="anchor" id="line-4-2"></span>
<span class="anchor" id="line-5-1"></span>Program received signal SIGSEGV, Segmentation fault.
<span class="anchor" id="line-6"></span>0x0804881f in _main () at debug-demo.vala:7
<span class="anchor" id="line-7"></span>7           stdout.printf("%d\n", foo.field);
<span class="anchor" id="line-8"></span>(gdb)</pre><span class="anchor" id="line-3133"></span><span class="anchor" id="line-3134"></span><p class="line867">
</p><h3 id="Using_GLib">Using GLib</h3>
<span class="anchor" id="line-3135"></span><span class="anchor" id="line-3136"></span><p class="line862">GLib
 includes a large set of utilities, including wrappers for most of the 
standard libc functions and more.  These tools are available on all Vala
 platforms, even those which are not POSIX compliant.  For a complete 
description of all that GLib provides, see the <a class="https" href="https://developer.gnome.org/glib/">GLib Reference Manual</a>.  That reference is related to the C API for GLib, but it is mainly very simple to work out how to translate into Vala. <span class="anchor" id="line-3137"></span><span class="anchor" id="line-3138"></span></p><p class="line874">The GLib functions are available in Vala through the following naming convention: <span class="anchor" id="line-3139"></span><span class="anchor" id="line-3140"></span></p><div><table><tbody><tr>  <td><p class="line862"> C API </p></td>
  <td><p class="line862"> Vala </p></td>
  <td><p class="line862"> Example </p></td>
</tr>
<tr>  <td><span class="anchor" id="line-3141"></span><p class="line862"> g_topic_foobar() </p></td>
  <td><p class="line862"> GLib.Topic.foobar() </p></td>
  <td><p class="line862"> GLib.Path.get_basename() </p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-3142"></span><span class="anchor" id="line-3143"></span><p class="line874">The GLib types can be used similarly: <span class="anchor" id="line-3144"></span></p><div><table><tbody><tr>  <td><p class="line862"> Instantiate with </p></td>
  <td><p class="line862"> Call an object member with </p></td>
</tr>
<tr>  <td><span class="anchor" id="line-3145"></span><p class="line862"> GLib.Foo foo = new GLib.Foo(); </p></td>
  <td><p class="line862"> foo.bar(); </p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-3146"></span><span class="anchor" id="line-3147"></span><p class="line874">The
 APIs are not identical between C and Vala, but these naming rules 
should mean you can find the functions you need in the GLib VAPI files 
shipped with Vala, and from there find the parameters.  This will 
hopefully suffice until more Vala documentation can be generated. <span class="anchor" id="line-3148"></span><span class="anchor" id="line-3149"></span></p><p class="line867">
</p><h4 id="File_Handling">File Handling</h4>
<span class="anchor" id="line-3150"></span><span class="anchor" id="line-3151"></span><p class="line862">For flexible file I/O and file handling see <a href="https://wiki.gnome.org/Projects/Vala/GIOSamples">GIO Samples</a>. <span class="anchor" id="line-3152"></span><span class="anchor" id="line-3153"></span></p><p class="line862">You can also use FileUtils.get_contents to load a file into a string. <span class="anchor" id="line-3154"></span><span class="anchor" id="line-3155"></span></p><p class="line867"><span class="anchor" id="line-3156"></span><span class="anchor" id="line-3157"></span><span class="anchor" id="line-3158"></span><span class="anchor" id="line-1-344"></span></p><div class="highlight cpp"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-fd3294b846d01c98c73d1d89c75bd4fdf63eb3e3" lang="en"><span class="line"><span class="anchor" id="line-1-345"></span><span class="ID">string</span> <span class="ID">content</span>;</span>
<span class="line"><span class="anchor" id="line-2-136"></span><span class="ID">FileUtils</span>.<span class="ID">get_contents</span>(<span class="String">"</span><span class="String">file.vala</span><span class="String">"</span>, <span class="ID">out</span> <span class="ID">content</span>);</span>
</pre></div></div><span class="anchor" id="line-3159"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" dir="ltr" lang="en">Projects/Vala/Tutorial  (last edited 2014-10-28 21:32:23 by <span title="FlorianBrosch @ chello084113194171.8.14.vie.surfer.at[84.113.194.171]"><a class="nonexistent" href="https://wiki.gnome.org/FlorianBrosch" title="FlorianBrosch @ chello084113194171.8.14.vie.surfer.at[84.113.194.171]">FlorianBrosch</a></span>)</p>

<div id="pagebottom"></div>
</div>



  <!-- end of main content -->
  </div>
  <!-- site footer -->
  <div id="footer">
    <!-- footer image -->
    <div id="footer_image">
      &nbsp;
    </div>
    <!-- footer grass -->
    <div id="footer_grass">
      &nbsp;
    </div>
    <div id="footer_container">
      <div id="footer_content">


        <div id="search">

<form id="searchform" method="get" action="/Projects/Vala/Tutorial">
<div>
<input name="action" value="fullsearch" type="hidden">
<input name="context" value="180" type="hidden">
<label style="display: none;" for="searchinput">Search:</label>
<input class="disabled" id="searchinput" name="value" value="Search" size="20" onfocus="searchFocus(this)" onblur="searchBlur(this)" onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search" type="text">
<input disabled="disabled" id="titlesearch" name="titlesearch" value="Titles" alt="Search Titles" type="submit">
<input disabled="disabled" id="fullsearch" name="fullsearch" value="Text" alt="Search Full Text" type="submit">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>


        </div>
        <div id="copyright">
        Copyright  2005 - 2013 <a href="https://www.gnome.org/">The GNOME Project</a>.
        Hosted by <a href="http://www.redhat.com/">Red Hat</a>.
        </div>
      </div>
    </div>
  </div>
  <!-- End of footer -->
  </div>
  <!-- End of container -->


</body></html>